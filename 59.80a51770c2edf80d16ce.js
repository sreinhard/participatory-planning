(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/layers/features/Pipeline":1453,"esri/views/2d/tiling/TileSpan":1469,"esri/views/2d/tiling/LODInfo":1476,"esri/views/2d/tiling/TileCoverage":1477,"esri/views/2d/tiling/TileInfoView":1480,"esri/core/libs/quickselect/quickselect":1487,"esri/core/libs/rbush/rbush":1494,"esri/views/2d/layers/features/support/Tile":1589,"esri/views/2d/layers/features/support/TileStore":1677,"esri/views/2d/layers/features/controllers":2328,"esri/views/2d/layers/features/processors":2329})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{1453:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(2),i(1),i(12),i(10),i(7),i(6),i(52),i(15),i(22),i(11),i(8),i(0),i(152),i(620),i(2328),i(2329),i(1677),i(1480)],void 0===(r=function(t,e,i,n,r,o,s,l,a,u,h,c,f,p,d,m,v,g,y,w){Object.defineProperty(e,"__esModule",{value:!0});var x=c.getLogger("esri.views.2d.layers.features.Pipeline"),M=new Set;e.getInstances=function(){return M};var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.controller=null,e.processor=null,e.remoteClient=null,e.tileStore=null,e.service=null,e.viewState=null,e}return i(e,t),e.prototype.initialize=function(){var t=this;this.watch("updating",function(e){t.remoteClient.invoke("setUpdating",e)}),h("esri-performance-tests")&&!h("esri-workers")&&M.add(this)},e.prototype.destroy=function(){h("esri-performance-tests")&&!h("esri-workers")&&M.delete(this),this.controller&&this.controller.destroy(),this.processor&&this.processor.destroy()},Object.defineProperty(e.prototype,"updating",{get:function(){var t=this.controller,e=this.processor;return!t||!e||t.updating||e.updating||!1},enumerable:!0,configurable:!0}),e.prototype.startup=function(t){var e=t.service,i=t.config,n=t.tileInfo;return r(this,void 0,void 0,function(){var t;return o(this,function(r){return t=new w(d.fromJSON(n)),this.service=e,this.tileStore=new y.default(t),[2,this._configure(i)]})})},e.prototype.update=function(t){var e=t.config,i=t.options;return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.processor&&this.controller?i.layerFilterChanged||i.invalidateFeatureData||i.invalidateMesh?[4,this.controller.update(e,i.layerFilterChanged)]:[3,2]:(x.error(new u("mapview-pipeline","Tried to update an unconfigured pipeline.")),[2]);case 1:t.sent(),t.label=2;case 2:return i.invalidateMesh?[4,this.processor.update(e)]:[3,4];case 3:t.sent(),this.controller.invalidate(),t.label=4;case 4:return[4,this.remoteClient.invoke("setUpdating",this.updating)];case 5:return t.sent(),[2]}})})},e.prototype.setViewState=function(t){var e=m.fromJSON(t);this._set("viewState",e),this.tileStore&&this.tileStore.setViewState(e),this.controller&&this.controller.setViewState(e)},e.prototype._configure=function(t){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,f.all([a.safeCast(this._handleControllerConfig(t)),a.safeCast(this._handleProcessorConfig(t))])];case 1:return e.sent(),this.controller.processor=this.processor,this.viewState&&this.controller.setViewState(this.viewState),[2]}})})},e.prototype._handleControllerConfig=function(t){return r(this,void 0,void 0,function(){var e;return o(this,function(i){switch(i.label){case 0:return[4,this._createController(this.service,t)];case 1:return[4,(e=i.sent()).startup()];case 2:return i.sent(),[2,e]}})})},e.prototype._handleProcessorConfig=function(t){return r(this,void 0,void 0,function(){return o(this,function(e){return[2,this._createProcessor(this.service,t)]})})},e.prototype._createController=function(t,e){return r(this,void 0,void 0,function(){var i,n,r,s,l;return o(this,function(o){switch(o.label){case 0:return[4,v.loadControllerModule(t.type)];case 1:return i=o.sent().default,r=(n=this).tileStore,s=n.remoteClient,l=new i({service:t,config:e,tileStore:r,remoteClient:s}),this.controller&&this.controller.destroy(),this.controller=l,[2,l]}})})},e.prototype._createProcessor=function(t,e){return r(this,void 0,void 0,function(){var i,n,r,s,l;return o(this,function(o){switch(o.label){case 0:return[4,g.loadProcessorModule(e.renderer.type)];case 1:return i=o.sent().default,r=(n=this).remoteClient,s=n.tileStore,l=new i({service:t,config:e,tileStore:s,remoteClient:r}),this.processor&&this.processor.destroy(),this.processor=l,[2,l]}})})},n([p.property()],e.prototype,"controller",void 0),n([p.property()],e.prototype,"processor",void 0),n([p.property({dependsOn:["controller.updating","processor.updating"]})],e.prototype,"updating",null),n([p.property()],e.prototype,"viewState",void 0),n([p.subclass("esri.views.2d.layers.features.Pipeline")],e)}(p.declared(l));e.default=_}.apply(null,n))||(t.exports=r)},1469:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(85)],void 0===(r=function(t,e,i){return function(){function t(t,e,i){this.row=t,this.colFrom=e,this.colTo=i}return t.pool=new i(t,!0),t}()}.apply(null,n))||(t.exports=r)},1476:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(94),i(346)],void 0===(r=function(t,e,i,n){function r(t,e){return[t,e]}function o(t,e,i){return t[0]=e,t[1]=i,t}var s=new n("0/0/0/0");return function(){function t(t,e,i,n,r,o,s,l,a,u,h,c){this.level=t,this.resolution=e,this.scale=i,this.origin=n,this.first=r,this.last=o,this.size=s,this.norm=l,this.worldStart=a,this.worldEnd=u,this.worldSize=h,this.wrap=c}return t.create=function(e,n,s){var l,a,u,h,c=i.getInfo(e.spatialReference),f=r(e.origin.x,e.origin.y),p=r(e.size[0]*n.resolution,e.size[1]*n.resolution),d=r(-1/0,-1/0),m=r(1/0,1/0),v=r(1/0,1/0);return s&&(o(d,Math.max(0,Math.floor((s.xmin-f[0])/p[0])),Math.max(0,Math.floor((f[1]-s.ymax)/p[1]))),o(m,Math.max(0,Math.floor((s.xmax-f[0])/p[0])),Math.max(0,Math.floor((f[1]-s.ymin)/p[1]))),o(v,m[0]-d[0]+1,m[1]-d[1]+1)),e.isWrappable?(l=r(Math.ceil(Math.round(2*c.origin[1]/n.resolution)/e.size[0]),v[1]),a=r(Math.floor((c.origin[0]-f[0])/p[0]),d[1]),u=r(l[0]+a[0]-1,m[1]),h=!0):(a=d,u=m,l=v,h=!1),new t(n.level,n.resolution,n.scale,f,d,m,v,p,a,u,l,h)},t.prototype.normalizeCol=function(t){if(!this.wrap)return t;var e=this.worldSize[0];return t<0?e-1-Math.abs((t+1)%e):t%e},t.prototype.denormalizeCol=function(t,e){return this.wrap?this.worldSize[0]*e+t:t},t.prototype.getWorldForColumn=function(t){return this.wrap?Math.floor(t/this.worldSize[0]):0},t.prototype.getFirstColumnForWorld=function(t){return t*this.worldSize[0]+this.first[0]},t.prototype.getLastColumnForWorld=function(t){return t*this.worldSize[0]+this.first[0]+this.size[0]-1},t.prototype.getColumnForX=function(t){return(t-this.origin[0])/this.norm[0]},t.prototype.getXForColumn=function(t){return this.origin[0]+t*this.norm[0]},t.prototype.getRowForY=function(t){return(this.origin[1]-t)/this.norm[1]},t.prototype.getYForRow=function(t){return this.origin[1]-t*this.norm[1]},t.prototype.getTileBounds=function(t,e,i){void 0===i&&(i=!1),s.set(e);var n=i?s.col:this.denormalizeCol(s.col,s.world),r=s.row;return function(t,e,i,n,r){t[0]=e,t[1]=i,t[2]=n,t[3]=r}(t,this.getXForColumn(n),this.getYForRow(r+1),this.getXForColumn(n+1),this.getYForRow(r)),t},t.prototype.getTileCoords=function(t,e,i){void 0===i&&(i=!1),s.set(e);var n=i?s.col:this.denormalizeCol(s.col,s.world);return Array.isArray(t)?o(t,this.getXForColumn(n),this.getYForRow(s.row)):(t.x=this.getXForColumn(n),t.y=this.getYForRow(s.row)),t},t}()}.apply(null,n))||(t.exports=r)},1477:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(204),i(85),i(1469)],void 0===(r=function(t,e,i,n,r){return function(){function t(t){this.lodInfo=t,this.spans=i.acquire()}return t.prototype.release=function(){for(var t=0,e=this.spans;t<e.length;t++){var n=e[t];r.pool.release(n)}i.release(this.spans)},t.prototype.forEach=function(t,e){var i=this.spans,n=this.lodInfo,r=n.level;if(0!==i.length)for(var o=0,s=i;o<s.length;o++)for(var l=s[o],a=l.row,u=l.colFrom,h=l.colTo,c=u;c<=h;c++)t.call(e,r,a,n.normalizeCol(c),n.getWorldForColumn(c))},t.pool=new n(t,!0),t}()}.apply(null,n))||(t.exports=r)},1480:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(94),i(1476),i(1477),i(346),i(1469)],void 0===(r=function(t,e,i,n,r,o,s){var l=new o("0/0/0/0"),a=function(){function t(t,e,i,n,r,o,s,l){this.x=t,this.ymin=e,this.ymax=i,this.invM=n,this.leftAdjust=r,this.rightAdjust=o,this.leftBound=s,this.rightBound=l}return t.create=function(e,i){var n;e[1]>i[1]&&(e=(n=[i,e])[0],i=n[1]);var r=e[0],o=e[1],s=i[0],l=i[1],a=s-r,u=l-o,h=0!==u?a/u:0,c=(Math.ceil(o)-o)*h,f=(Math.floor(o)-o)*h;return new t(r,Math.floor(o),Math.ceil(l),h,a<0?c:f,a<0?f:c,a<0?s:r,a<0?r:s)},t.prototype.incrRow=function(){this.x+=this.invM},t.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)},t.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)},t}(),u=[[0,0],[0,0],[0,0],[0,0]];return function(){function t(t,e){var i=this;this.tileInfo=t,this.fullExtent=e,this.scales=[],this._lodInfos=null,this._infoByScale={},this._infoByLevel={};var r=t.lods.slice();r.sort(function(t,e){return e.scale-t.scale});var o=this._lodInfos=r.map(function(i){return n.create(t,i,e)});r.forEach(function(t,e){i._infoByLevel[t.level]=o[e],i._infoByScale[t.scale]=o[e],i.scales[e]=t.scale},this),this._wrap=t.isWrappable}return Object.defineProperty(t.prototype,"spatialReference",{get:function(){return this.tileInfo.spatialReference},enumerable:!0,configurable:!0}),t.prototype.getLODInfoAt=function(t){return this._infoByLevel["number"==typeof t?t:t.level]},t.prototype.getTileBounds=function(t,e,i){void 0===i&&(i=!1),l.set(e);var n=this._infoByLevel[l.level];return n?n.getTileBounds(t,l,i):t},t.prototype.getTileCoords=function(t,e,i){void 0===i&&(i=!1),l.set(e);var n=this._infoByLevel[l.level];return n?n.getTileCoords(t,l,i):t},t.prototype.getTileCoverage=function(t,e,i){void 0===e&&(e=192),void 0===i&&(i="closest");var n,o,l,h="closest"===i?this.getClosestInfoForScale(t.scale):this.getSmallestInfoForScale(t.scale),c=r.pool.acquire(h),f=this._wrap,p=1/0,d=-1/0,m=c.spans;u[0][0]=u[0][1]=u[1][1]=u[3][0]=-e,u[1][0]=u[2][0]=t.size[0]+e,u[2][1]=u[3][1]=t.size[1]+e;for(var v=0,g=u;v<g.length;v++){var y=g[v];t.toMap(y,y),y[0]=h.getColumnForX(y[0]),y[1]=h.getRowForY(y[1])}for(var w=[],x=3,M=0;M<4;M++)if(u[M][1]!==u[x][1]){var _=a.create(u[M],u[x]);p=Math.min(_.ymin,p),d=Math.max(_.ymax,d),void 0===w[_.ymin]&&(w[_.ymin]=[]),w[_.ymin].push(_),x=M}else x=M;if(null==p||null==d||d-p>100)return null;var b=[];for(n=p;n<d;){null!=w[n]&&(b=b.concat(w[n])),o=1/0,l=-1/0;for(M=b.length-1;M>=0;M--){_=b[M];o=Math.min(o,_.getLeftCol()),l=Math.max(l,_.getRightCol())}if(o=Math.floor(o),l=Math.floor(l),n>=h.first[1]&&n<=h.last[1])if(f)if(h.size[0]<h.worldSize[0]){var B=Math.floor(l/h.worldSize[0]);for(M=Math.floor(o/h.worldSize[0]);M<=B;M++)m.push(new s(n,Math.max(h.getFirstColumnForWorld(M),o),Math.min(h.getLastColumnForWorld(M),l)))}else m.push(new s(n,o,l));else o>h.last[0]||l<h.first[0]||(o=Math.max(o,h.first[0]),l=Math.min(l,h.last[0]),m.push(new s(n,o,l)));n+=1;for(M=b.length-1;M>=0;M--){(_=b[M]).ymax>=n?_.incrRow():b.splice(M,1)}}return c},t.prototype.getTileParentId=function(t){l.set(t);var e=this._infoByLevel[l.level],i=this._lodInfos.indexOf(e)-1;return i<0?null:(this._getTileIdAtLOD(l,this._lodInfos[i],l),l.id)},t.prototype.getTileResolution=function(t){var e=this._infoByLevel["object"==typeof t?t.level:t];return e?e.resolution:-1},t.prototype.getTileScale=function(t){var e=this._infoByLevel[t.level];return e?e.scale:-1},t.prototype.intersects=function(t,e){l.set(e);var i=this._infoByLevel[l.level],n=t.lodInfo;if(n.resolution>i.resolution){this._getTileIdAtLOD(l,n,l);for(var r=n.denormalizeCol(l.col,l.world),o=0,s=t.spans;o<s.length;o++){var a=s[o];if(a.row===l.row&&a.colFrom<=r&&a.colTo>=r)return!0}}if(n.resolution<i.resolution){var u=t.spans.reduce(function(t,e){return t[0]=Math.min(t[0],e.row),t[1]=Math.max(t[1],e.row),t[2]=Math.min(t[2],e.colFrom),t[3]=Math.max(t[3],e.colTo),t},[1/0,-1/0,1/0,-1/0]),h=u[0],c=u[1],f=u[2],p=u[3],d=i.denormalizeCol(l.col,l.world),m=n.getColumnForX(i.getXForColumn(d)),v=n.getRowForY(i.getYForRow(l.row)),g=n.getColumnForX(i.getXForColumn(d+1))-1,y=n.getRowForY(i.getYForRow(l.row+1))-1;return!(m>p||g<f||v>c||y<h)}var w=n.denormalizeCol(l.col,l.world);return t.spans.some(function(t){return t.row===l.row&&t.colFrom<=w&&t.colTo>=w})},t.prototype.normalizeBounds=function(t,e,n){if(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],this._wrap){var r=i.getInfo(this.tileInfo.spatialReference),o=-n*(r.valid[1]-r.valid[0]);t[0]+=o,t[2]+=o}return t},t.prototype.getSmallestInfoForScale=function(t){var e=this.scales;if(this._infoByScale[t])return this._infoByScale[t];if(t>e[0])return this._infoByScale[e[0]];for(var i=1;i<e.length-1;i++)if(t>e[i]+1e-6)return this._infoByScale[e[i-1]];return this._infoByScale[e[e.length-1]]},t.prototype.getClosestInfoForScale=function(t){var e=this.scales;return this._infoByScale[t]?this._infoByScale[t]:(t=e.reduce(function(e,i,n,r){return Math.abs(i-t)<Math.abs(e-t)?i:e},e[0]),this._infoByScale[t])},t.prototype.scaleToLevel=function(t){var e=this.scales;if(this._infoByScale[t])return this._infoByScale[t].level;for(var i=e.length-1;i>=0;i--)if(t<e[i]){return i===e.length-1?this._infoByScale[e[e.length-1]].level:this._infoByScale[e[i]].level+(e[i]-t)/(e[i]-e[i+1])}return this._infoByScale[e[0]].level},t.prototype.scaleToZoom=function(t){return this.tileInfo.scaleToZoom(t)},t.prototype._getTileIdAtLOD=function(t,e,i){var n=this._infoByLevel[i.level];return t.set(i),e.resolution<n.resolution?null:e.resolution===n.resolution?t:(t.level=e.level,t.col=Math.floor(i.col*n.resolution/e.resolution+.01),t.row=Math.floor(i.row*n.resolution/e.resolution+.01),t)},t}()}.apply(null,n))||(t.exports=r)},1487:function(t,e,i){var n;void 0===(n=function(){"use strict";function t(i,n,r,o,s){for(;o>r;){if(o-r>600){var l=o-r+1,a=n-r+1,u=Math.log(l),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(l-h)/l)*(a-l/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-a*h/l+c)),Math.min(o,Math.floor(n+(l-a)*h/l+c)),s)}var f=i[n],p=r,d=o;for(e(i,r,n),s(i[o],f)>0&&e(i,r,o);p<d;){for(e(i,p,d),p++,d--;s(i[p],f)<0;)p++;for(;s(i[d],f)>0;)d--}0===s(i[r],f)?e(i,r,d):e(i,++d,o),d<=n&&(r=d+1),n<=d&&(o=d-1)}}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}return function(e,n,r,o,s){t(e,n,r||0,o||e.length-1,s||i)}}.apply(null,[]))||(t.exports=n)},1494:function(t,e,i){var n,r;n=[i(1487)],void 0===(r=function(t){"use strict";function e(t,i){if(!(this instanceof e))return new e(t,i);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this.toBBox=i:this._initFormat(i)),this.clear()}function i(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function n(t,e){r(t,0,t.children.length,e,t)}function r(t,e,i,n,r){r||(r=d(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s,l=e;l<i;l++)s=t.children[l],o(r,t.leaf?n(s):s);return r}function o(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function s(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function a(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function c(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-i)*Math.max(0,o-n)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,i,n,r,o){for(var s,l=[i,n];l.length;)(n=l.pop())-(i=l.pop())<=r||(s=i+Math.ceil((n-i)/r/2)*r,t(e,s,i,n,o),l.push(i,s,s,n))}return e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!p(t,e))return i;for(var r,o,s,l,a=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],p(t,l=e.leaf?n(s):s)&&(e.leaf?i.push(s):f(t,l)?this._all(s,i):a.push(s));e=a.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!p(t,e))return!1;for(var n,r,o,s,l=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],p(t,s=e.leaf?i(o):o)){if(e.leaf||f(t,s))return!0;l.push(o)}e=l.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=d([]),this},remove:function(t,e){if(!t)return this;for(var n,r,o,s,l=this.data,a=this.toBBox(t),u=[],h=[];l||u.length;){if(l||(l=u.pop(),r=u[u.length-1],n=h.pop(),s=!0),l.leaf&&-1!==(o=i(t,l.children,e)))return l.children.splice(o,1),u.push(l),this._condense(u),this;s||l.leaf||!f(l,a)?r?(n++,l=r.children[n],s=!1):l=null:(u.push(l),h.push(n),n=0,r=l,l=l.children[0])}return this},toBBox:function(t){return t},compareMinX:s,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,r){var o,s=i-e+1,l=this._maxEntries;if(s<=l)return n(o=d(t.slice(e,i+1)),this.toBBox),o;r||(r=Math.ceil(Math.log(s)/Math.log(l)),l=Math.ceil(s/Math.pow(l,r-1))),(o=d([])).leaf=!1,o.height=r;var a,u,h,c,f=Math.ceil(s/l),p=f*Math.ceil(Math.sqrt(l));for(m(t,e,i,p,this.compareMinX),a=e;a<=i;a+=p)for(m(t,a,h=Math.min(a+p-1,i),f,this.compareMinY),u=a;u<=h;u+=f)c=Math.min(u+f-1,h),o.children.push(this._build(t,u,c,r-1));return n(o,this.toBBox),o},_chooseSubtree:function(t,e,i,n){for(var r,o,s,l,u,c,f,p;n.push(e),!e.leaf&&n.length-1!==i;){for(f=p=1/0,r=0,o=e.children.length;r<o;r++)u=a(s=e.children[r]),(c=h(t,s)-u)<p?(p=c,f=u<f?u:f,l=s):c===p&&u<f&&(f=u,l=s);e=l||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),s=[],l=this._chooseSubtree(r,this.data,e,s);for(l.children.push(t),o(l,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)},_split:function(t,e){var i=t[e],r=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,r);var s=this._chooseSplitIndex(i,o,r),l=d(i.children.splice(s,i.children.length-s));l.height=i.height,l.leaf=i.leaf,n(i,this.toBBox),n(l,this.toBBox),e?t[e-1].children.push(l):this._splitRoot(i,l)},_splitRoot:function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,n(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,o,s,l,u,h,f,p;for(h=f=1/0,n=e;n<=i-e;n++)l=c(o=r(t,0,n,this.toBBox),s=r(t,n,i,this.toBBox)),u=a(o)+a(s),l<h?(h=l,p=n,f=u<f?u:f):l===h&&u<f&&(f=u,p=n);return p},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:s,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var s,l,a=this.toBBox,h=r(t,0,e,a),c=r(t,i-e,i,a),f=u(h)+u(c);for(s=e;s<i-e;s++)l=t.children[s],o(h,t.leaf?a(l):l),f+=u(h);for(s=i-e-1;s>=e;s--)l=t.children[s],o(c,t.leaf?a(l):l),f+=u(c);return f},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)o(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():n(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}},e}.apply(null,n))||(t.exports=r)},1589:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(133),i(204),i(36),i(35),i(565),i(346)],void 0===(r=function(t,e,i,n,r,o,s,l){function a(t,e){var i=t.bounds,n=e.bounds;return t.key.id!==e.key.id&&t.key.world===e.key.world&&i[0]<=n[0]&&i[1]<=n[1]&&i[2]>=n[2]&&i[3]>=n[3]}Object.defineProperty(e,"__esModule",{value:!0}),e.isParentOf=a,e.isChildOf=function(t,e){return a(e,t)};var u=function(){function t(t,e){this.bounds=o.create(),this.key=new l(0,0,0,0),this.objectIds=new i.default,this.key.set(e);var n=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=n.resolution,this.scale=n.scale,this.level=n.level,this.needsClear=!0}return Object.defineProperty(t.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extent",{get:function(){return r.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.tileInfoView,this.id)},t.prototype.createChildTiles=function(){for(var e=this.key.getChildKeys(),i=n.acquire(),r=0;r<e.length;r++)i[r]=new t(this.tileInfoView,e[r]);return i},t.prototype.getQuantizationParameters=function(){return s.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},t}();e.Tile=u,e.default=u}.apply(null,n))||(t.exports=r)},1677:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(5),i(1),i(133),i(37),i(22),i(1494),i(1589),i(346)],void 0===(r=function(t,e,i,n,r,o,s,l,a,u){Object.defineProperty(e,"__esModule",{value:!0});var h={added:[],removed:[]},c=new r.default,f=new u(0,0,0,0),p=function(t){function e(e){var i=t.call(this)||this;return i._tiles=new Map,i._index=l(9,s("csp-restrictions")?function(t){return{minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),i.tiles=[],i.tileScheme=e,i}return i(e,t),e.prototype.destroy=function(){this._tiles.clear()},e.prototype.has=function(t){return this._tiles.has(t)},e.prototype.get=function(t){return this._tiles.get(t)},e.prototype.findByKey=function(t){return this._tiles.get(t.id)},e.prototype.intersections=function(t,e){var i="string"==typeof t?this.get(t):t;if(!i)return[];for(var n=e*i.resolution,r=i.bounds[0]-n,o=i.bounds[1]-n,s=i.bounds[2]+n,l=i.bounds[3]+n,a=[],u=0,h=this._index.search({minX:r,minY:o,maxX:s,maxY:l});u<h.length;u++){var c=h[u],f=c.bounds.slice();f[0]=Math.max(f[0],r),f[1]=Math.max(f[1],o),f[2]=Math.min(f[2],s),f[3]=Math.min(f[3],l),f[2]-f[0]>0&&f[3]-f[1]>0&&a.push({bounds:f,tile:c})}return a},e.prototype.boundsIntersections=function(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})},e.prototype.setViewState=function(t){var e=this.tileScheme.getTileCoverage(t,0);if(e){var i=e.spans,n=e.lodInfo,r=n.level;if(i.length>0)for(var o=0,s=i;o<s.length;o++)for(var l=s[o],u=l.row,p=l.colFrom,d=l.colTo,m=p;m<=d;m++){var v=f.set(r,u,n.normalizeCol(m),n.getWorldForColumn(m)).id;if(c.add(v),!this.has(v)){var g=new a.default(this.tileScheme,v);this._tiles.set(v,g),this._index.insert(g),this.tiles.push(g),h.added.push(g)}}for(var y=this.tiles.length-1;y>=0;y--){g=this.tiles[y];c.has(g.id)||(this._tiles.delete(g.id),this.tiles.splice(y,1),this._index.remove(g),h.removed.push(g))}(h.added.length||h.removed.length)&&this.emit("update",h),c.clear(),h.added.length=0,h.removed.length=0}},e}(o);e.default=p}.apply(null,n))||(t.exports=r)},2328:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(7),i(10),i(12),i(15),i(8)],void 0===(r=function(t,e,n,r,o,s,l){Object.defineProperty(e,"__esModule",{value:!0}),e.loadControllerModule=function(t){switch(t){case"on-demand":return l.create(function(t){return Promise.all([i.e(0),i.e(1),i.e(2),i.e(5),i.e(49)]).then(function(){var e=[i(2417)];t.apply(null,e)}.bind(this)).catch(i.oe)});case"memory":return l.create(function(t){return Promise.all([i.e(0),i.e(1),i.e(2),i.e(5),i.e(53)]).then(function(){var e=[i(2422)];t.apply(null,e)}.bind(this)).catch(i.oe)});case"stream":return l.create(function(t){return Promise.all([i.e(0),i.e(1),i.e(2),i.e(5),i.e(41)]).then(function(){var e=[i(2423)];t.apply(null,e)}.bind(this)).catch(i.oe)});default:return l.reject(new s("mapview-controller:bad-type","Unable to create controller for unknown type: "+t))}}}.apply(null,n))||(t.exports=r)},2329:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(7),i(8)],void 0===(r=function(t,e,n,r){Object.defineProperty(e,"__esModule",{value:!0}),e.loadProcessorModule=function(t){return"heatmap"===t?r.create(function(t){return i.e(90).then(function(){var e=[i(2429)];t.apply(null,e)}.bind(this)).catch(i.oe)}):r.create(function(t){return Promise.all([i.e(0),i.e(1),i.e(77)]).then(function(){var e=[i(2430)];t.apply(null,e)}.bind(this)).catch(i.oe)})}}.apply(null,n))||(t.exports=r)}}]);