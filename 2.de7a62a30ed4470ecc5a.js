(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/graphics/centroid":1663,"esri/layers/graphics/data/projectionSupport":1669,"esri/layers/graphics/data/QueryEngine":1679,"esri/layers/graphics/data/utils":1686,"esri/layers/support/PromiseQueue":1687,"esri/layers/graphics/data/attributeSupport":1704,"esri/geometry/projection":1713,"esri/layers/graphics/data/spatialQuerySupport":1739,"esri/layers/graphics/data/timeSupport":1770,"esri/geometry/pe":1789,"esri/geometry/support/GeographicTransformation":1790,"esri/geometry/support/GeographicTransformationStep":1791,"esri/core/sql/WhereClauseCache":1815,"esri/layers/graphics/contains":1816,"esri/layers/graphics/data/QueryEngineResult":2445,"esri/layers/graphics/data/AttributesBuilder":2446})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1663:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return e?t?4:3:t?3:2}function n(e,t,n,i,s,o){for(var a=r(s,o),u=n,l=n+a,c=0,p=0,f=0,h=0,_=0,d=0,y=i-1;d<y;d++,u+=a,l+=a){var g=t[u],m=t[u+1],v=t[u+2],P=t[l],E=t[l+1],S=t[l+2],T=g*E-P*m;h+=T,c+=(g+P)*T,p+=(m+E)*T,s&&(f+=(v+S)*(T=g*S-P*v),_+=T),g<e[0]&&(e[0]=g),g>e[1]&&(e[1]=g),m<e[2]&&(e[2]=m),m>e[3]&&(e[3]=m),s&&(v<e[4]&&(e[4]=v),v>e[5]&&(e[5]=v))}if(h>0&&(h*=-1),_>0&&(_*=-1),!h)return null;var I=[c,p,.5*h];return s&&(I[3]=f,I[4]=.5*_),I}function i(e,t,n,i,l){for(var c=r(i,l),p=t,f=t+c,h=0,_=0,d=0,y=0,g=0,m=n-1;g<m;g++,p+=c,f+=c){var v=e[p],P=e[p+1],E=e[p+2],S=e[f],T=e[f+1],I=e[f+2],R=i?o(v,P,E,S,T,I):s(v,P,S,T);if(R)if(h+=R,i){_+=R*(N=u(v,P,E,S,T,I))[0],d+=R*N[1],y+=R*N[2]}else{var N;_+=R*(N=a(v,P,S,T))[0],d+=R*N[1]}}return h>0?i?[_/h,d/h,y/h]:[_/h,d/h]:n>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function s(e,t,r,n){var i=r-e,s=n-t;return Math.sqrt(i*i+s*s)}function o(e,t,r,n,i,s){var o=n-e,a=i-t,u=s-r;return Math.sqrt(o*o+a*a+u*u)}function a(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function u(e,t,r,n,i,s){return[e+.5*(n-e),t+.5*(i-t),r+.5*(s-r)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCentroidOptimizedGeometry=function(e,t,s,o){if(!t||!t.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);for(var a=e.coords,u=[],l=s?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],c=t.lengths,p=t.coords,f=r(s,o),h=0,_=0,d=c;_<d.length;_++){var y=d[_],g=n(l,p,h,y,s,o);g&&u.push(g),h+=y*f}if(u.sort(function(e,t){var r=e[2]-t[2];return 0===r&&s&&(r=e[4]-t[4]),r}),u.length){var m=6*u[0][2];a[0]=u[0][0]/m,a[1]=u[0][1]/m,s&&(m=6*u[0][4],a[2]=0!==m?u[0][3]/m:0),(a[0]<l[0]||a[0]>l[1]||a[1]<l[2]||a[1]>l[3]||s&&(a[2]<l[4]||a[2]>l[5]))&&(a.length=0)}if(!a.length){var v=t.lengths[0]?i(p,0,c[0],s,o):null;if(!v)return null;a[0]=v[0],a[1]=v[1],s&&v.length>2&&(a[2]=v[2])}return e},t.lineCentroid=i}.apply(null,n))||(e.exports=i)},1669:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(11),r(14),r(7),r(1713),r(90),r(63)],void 0===(i=function(e,t,r,n,i,s,o,a,u){function l(e,t){var r,n,i;if(!t)return null;if("x"in t){var s={x:0,y:0};return r=e(t.x,t.y,_),s.x=r[0],s.y=r[1],null!=t.z&&(s.z=t.z),null!=t.m&&(s.m=t.m),s}if("xmin"in t){s={xmin:0,ymin:0,xmax:0,ymax:0};return n=e(t.xmin,t.ymin,_),s.xmin=n[0],s.ymin=n[1],i=e(t.xmax,t.ymax,_),s.xmax=i[0],s.ymax=i[1],t.hasZ&&(s.zmin=t.zmin,s.zmax=t.zmax,s.hasZ=!0),t.hasM&&(s.mmin=t.mmin,s.mmax=t.mmax,s.hasM=!0),s}return"rings"in t?{rings:c(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:c(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:p(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function c(e,t){for(var r=[],n=0,i=e;n<i.length;n++){var s=i[n];r.push(p(s,t))}return r}function p(e,t){for(var r=[],n=0,i=e;n<i.length;n++){var s=i[n],o=t(s[0],s[1],[0,0]);r.push(o),s.length>2&&o.push(s[2]),s.length>3&&o.push(s[3])}return r}function f(e,t){return!(!a.isValid(e)||!a.isValid(t)||a.equals(e,t)||u.canProject(e,t))}Object.defineProperty(t,"__esModule",{value:!0});var h="feature-store:unsupported-query",_=[0,0];t.checkProjectionSupport=function(e,t){return n(this,void 0,void 0,function(){var n,s,a;return r(this,function(r){if(!t)return[2];if(Array.isArray(e)){for(n=0,s=e;n<s.length;n++)if(f((a=s[n]).geometry&&a.geometry.spatialReference,t)){if(o.isSupported())return[2,o.load()];throw new i(h,"projection not supported",{inSpatialReference:e,outSpatialReference:t})}return[2]}if(!f(e,t))return[2];if(o.isSupported())return[2,o.load()];throw new i(h,"projection not supported",{inSpatialReference:e,outSpatialReference:t})})})};var d=l.bind(null,u.lngLatToXY),y=l.bind(null,u.xyToLngLat);t.project=function(e,t,r){return r||(r=t,t=e.spatialReference),a.isValid(t)&&a.isValid(r)&&!a.equals(t,r)?u.canProject(t,r)?a.isWebMercator(r)?d(e):y(e):o.projectMany([e],t,r,null,!0)[0]:e};var g=new(function(){function e(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return e.prototype.push=function(e,t,i){return n(this,void 0,void 0,function(){var n,o=this;return r(this,function(r){return e&&e.length&&t&&i&&!a.equals(t,i)||s.resolve(e),n={geometries:e,inSpatialReference:t,outSpatialReference:i,resolve:null},this._jobs.push(n),[2,s.create(function(e){n.resolve=e,null===o._timer&&(o._timer=setTimeout(o._process,10))},function(){var e=o._jobs.indexOf(n);e>-1&&o._jobs.splice(e,1)})]})})},e.prototype._process=function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,r=e.inSpatialReference,n=e.outSpatialReference;(0,e.resolve)(u.canProject(r,n)?a.isWebMercator(n)?t.map(d):t.map(y):o.projectMany(t,r,n,null,!0)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}},e}());t.projectMany=function(e,t,i){return n(this,void 0,void 0,function(){return r(this,function(r){return[2,g.push(e,t,i)]})})}}.apply(null,n))||(e.exports=i)},1679:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(4),r(10),r(11),r(14),r(79),r(15),r(6),r(305),r(7),r(71),r(45),r(33),r(645),r(57),r(90),r(1704),r(1669),r(1680),r(2445),r(1739),r(1770),r(1686),r(638),r(1687)],void 0===(i=function(e,t,r,n,i,s,o,a,u,l,c,p,f,h,_,d,y,g,m,v,P,E,S,T,I,R){Object.defineProperty(t,"__esModule",{value:!0});var N=u.getLogger("esri.layers.graphics.data.QueryEngine"),x=function(){return function(e,t,r,n,i){void 0===t&&(t=null),this.attributes=e,this.geometry=r,this.centroid=n,this.filterFlags=i,this.groupId=-1,this.localId=t}}();t.Feature=x;var O=new Set,b=new l.MemCacheStorage(2e6),M=0,F=function(){function e(e){var t=this;this.capabilities={query:v.queryCapabilities},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.cacheSpatialQueries=e.cacheSpatialQueries||!1,this.gdbVersion=e.gdbVersion,this.historicMoment=e.historicMoment,this.featureStore=e.featureStore,this._changeHandle=this.featureStore.events.on("changed",function(){return t.clearCache()}),this.timeInfo=e.timeInfo,this.cacheSpatialQueries&&(this._geometryQueryCache=new l.MemCache(M+++"$$",b)),this.fieldsIndex=new I(e.fields),e.scheduler&&e.task&&(this._frameQueue=new R.PromiseQueue,this._frameTask=e.scheduler.registerTask(e.task,function(e){return t._update(e)},function(){return t._frameQueue.length>0}))}return e.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()},Object.defineProperty(e.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullExtent",{get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:T.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:(this._timeExtent=S.getTimeExtent(this.timeInfo,this.featureStore),this._timeExtent):null},enumerable:!0,configurable:!0}),e.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null},e.prototype.executeQuery=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,function(){var t,r,i;return n(this,function(n){switch(n.label){case 0:t=a.clone(e),n.label=1;case 1:return n.trys.push([1,14,,15]),[4,this._schedule()];case 2:return n.sent(),[4,T.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._checkQuerySupport(t)];case 5:return t=n.sent(),[4,this._reschedule()];case 6:return n.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeTimeQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:return n.sent(),[4,r.executeAttributesQuery(t)];case 13:return r=n.sent(),[3,15];case 14:if((i=n.sent())!==T.QUERY_ENGINE_EMPTY_RESULT)throw i;return r=new P.default([],null,this),[3,15];case 15:return[2,r.createQueryResponse(t)]}})})},e.prototype.executeQueryForCount=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,function(){var t,r,i;return n(this,function(n){switch(n.label){case 0:(t=a.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,n.label=1;case 1:return n.trys.push([1,14,,15]),[4,this._schedule()];case 2:return n.sent(),[4,T.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._checkQuerySupport(t)];case 5:return t=n.sent(),[4,this._reschedule()];case 6:return n.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeTimeQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:return n.sent(),[4,r.executeAttributesQuery(t)];case 13:return[2,(r=n.sent()).size];case 14:if((i=n.sent())!==T.QUERY_ENGINE_EMPTY_RESULT)throw i;return[2,0];case 15:return[2]}})})},e.prototype.executeQueryForExtent=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,function(){var t,r,i,s,o,u,l,c;return n(this,function(n){switch(n.label){case 0:t=a.clone(e),i=t.outSR,n.label=1;case 1:return n.trys.push([1,14,,15]),[4,this._schedule()];case 2:return n.sent(),[4,T.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._checkQuerySupport(t)];case 5:return(t=n.sent()).returnGeometry=!0,t.returnCentroid=!1,t.outSR=null,[4,this._reschedule()];case 6:return n.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeTimeQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:return n.sent(),[4,r.executeAttributesQuery(t)];case 13:return r=n.sent(),(s=r.size)?(f.set(G,f.NEGATIVE_INFINITY),this.featureStore.forEachBounds(r.items,function(e){return f.expand(G,e)},w),o={xmin:G[0],ymin:G[1],xmax:G[3],ymax:G[4],spatialReference:T.cleanFromGeometryEngine(this.spatialReference)},this.hasZ&&isFinite(G[2])&&isFinite(G[5])&&(o.zmin=G[2],o.zmax=G[5]),(u=m.project(o,r.spatialReference,i)).spatialReference=T.cleanFromGeometryEngine(i||this.spatialReference),u.xmax-u.xmin==0&&(l=p.getMetersPerUnitForSR(u.spatialReference),u.xmin-=l,u.xmax+=l),u.ymax-u.ymin==0&&(l=p.getMetersPerUnitForSR(u.spatialReference),u.ymin-=l,u.ymax+=l),this.hasZ&&null!=u.zmin&&null!=u.zmax&&u.zmax-u.zmin==0&&(l=p.getMetersPerUnitForSR(u.spatialReference),u.zmin-=l,u.zmax+=l),[2,{count:s,extent:u}]):[2,{count:s,extent:null}];case 14:if((c=n.sent())===T.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw c;case 15:return[2]}})})},e.prototype.executeQueryForIds=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,function(){return n(this,function(r){return[2,this.executeQueryForIdSet(e,t).then(function(e){return o.valuesOfSet(e)})]})})},e.prototype.executeQueryForIdSet=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,function(){var t,r,i,s,o,u,l,c;return n(this,function(n){switch(n.label){case 0:(t=a.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,n.label=1;case 1:return n.trys.push([1,13,,14]),[4,this._schedule()];case 2:return n.sent(),[4,T.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._executeGeometryQuery(t)];case 5:return r=n.sent(),[4,this._reschedule()];case 6:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeTimeQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeAttributesQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:for(n.sent(),i=r.items,s=new Set,o=0,u=i;o<u.length;o++)l=u[o],s.add(r.featureAdapter.getObjectId(l));return[2,s];case 13:if((c=n.sent())===T.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw c;case 14:return[2]}})})},e.prototype.executeQueryForLatestObservations=function(e,t){var r=this;return this.timeInfo?this.executeQuery(e,t).then(function(e){return r._filterLatest(e,r.timeInfo)}):void N.error(new s("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))},e.prototype._schedule=function(e){return i(this,void 0,void 0,function(){return n(this,function(t){return this._frameQueue?[2,this._frameQueue.push(e).then(function(e){return e})]:[2,e]})})},e.prototype._reschedule=function(e){return i(this,void 0,void 0,function(){return n(this,function(t){return this._frameQueue?[2,this._frameQueue.unshift(e).then(function(e){return e})]:[2,e]})})},e.prototype._update=function(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null},e.prototype._filterLatest=function(e,t){for(var n=t.trackIdField,i=t.startTimeField,s=t.endTimeField||i,o=new Map,a=[],u=0,l=e.features;u<l.length;u++){var c=l[u],p=c.attributes[n],f=c.attributes[s];(!o.has(p)||o.get(p).attributes[s]<f)&&o.set(p,c)}return o.forEach(function(e){return a.push(e)}),r({},e,{features:a})},e.prototype._getAll=function(){if(!this._allItems){var e=[];this.featureStore.forEach(function(t){return e.push(t)}),this._allItems=new P.default(e,null,this)}return this._allItems},e.prototype._executeGeometryQuery=function(e){return i(this,void 0,void 0,function(){var t,r,s,o,a,u,l,c,p,f,h,_,d,g,m,v,S,T,I,R,N,x,O,b=this;return n(this,function(M){switch(M.label){case 0:if(t=e.geometry,r=e.outSR,s=e.spatialRel,o=y.isValid(r)&&!y.equals(this.spatialReference,r),(a=this.cacheSpatialQueries?o?JSON.stringify({geometry:t,spatialRelationship:s,outSpatialReference:r}):JSON.stringify({geometry:t,spatialRelationship:s}):null)&&void 0!==(u=this._geometryQueryCache.get(a)))return[2,u];if(l=function(t){return i(b,void 0,void 0,function(){var i;return n(this,function(n){switch(n.label){case 0:return o&&(e.returnGeometry||e.returnCentroid)?[4,t.project(r)]:[3,2];case 1:return i=n.sent(),a&&this._geometryQueryCache.put(a,i,i.size||1),[2,i];case 2:return a&&this._geometryQueryCache.put(a,t,t.size||1),[2,t]}})})},!t)return[2,l(this._getAll())];if(c=this.featureAdapter,"esriSpatialRelDisjoint"!==s)return[3,5];if(!(p=this._searchFeatures(this._getQueryBBoxes(t))).length)return[2,l(this._getAll())];for(_=new Set,d=0,g=p;d<g.length;d++)m=g[d],_.add(c.getObjectId(m));return[4,this._reschedule(_)];case 1:return _=M.sent(),v=0,f=new Array(_.size),this.featureStore.forEach(function(e){return f[v++]=e}),h=_,[4,this._reschedule()];case 2:return M.sent(),[4,E.getSpatialQueryOperator(s,t,this)];case 3:return S=M.sent(),T=function(e){return!h.has(c.getObjectId(e))||S(c.getGeometry(e))},I=P.default.bind,[4,this._runSpatialFilter(f,T)];case 4:return N=new(I.apply(P.default,[void 0,M.sent(),t,this])),[2,l(N)];case 5:return(R=this._searchFeatures(this._getQueryBBoxes(t))).length?this._canExecuteSoloPass(t,e)?[2,l(new P.default(R,t,this))]:[4,E.getSpatialQueryOperator(s,t,this)]:(N=new P.default([],t,this),a&&this._geometryQueryCache.put(a,N,N.size||1),[2,N]);case 6:return x=M.sent(),[4,this._runSpatialFilter(R,function(e){return x(c.getGeometry(e))})];case 7:return O=M.sent(),[2,l(new P.default(O,t,this))]}})})},e.prototype._runSpatialFilter=function(e,t){return i(this,void 0,void 0,function(){var r,s,o,a=this;return n(this,function(u){return t?this._budget?(r=0,s=new Array,o=function(){return i(a,void 0,void 0,function(){var i;return n(this,function(n){switch(n.label){case 0:return r<e.length?(i=e[r],t(i)&&s.push(i),this._budget.done?[4,this._reschedule()]:[3,2]):[3,3];case 1:return n.sent(),[2,o()];case 2:return++r,[3,0];case 3:return[2]}})})},[2,this._reschedule().then(function(){return o()}).then(function(){return s})]):[2,e.filter(function(e){return t(e)})]:[2,e]})})},e.prototype._canExecuteSoloPass=function(e,t){var r=this.geometryType,n=t.spatialRel;return E.canQueryWithRBush(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))},e.prototype._getQueryBBoxes=function(e){if(E.canQueryWithRBush(e)){if(d.isExtent(e))return[h.fromValues(e.xmin,e.ymin,e.xmax,e.ymax)];if(d.isPolygon(e))return e.rings.map(function(e){return h.fromValues(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))})}return[_.getBoundsXY(h.create(),e)]},e.prototype._searchFeatures=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this.featureStore.forEachInBounds(n,function(e){O.add(e)})}var i=new Array(O.size),s=0;return O.forEach(function(e){return i[s++]=e}),O.clear(),i},e.prototype._checkQuerySupport=function(e){return i(this,void 0,void 0,function(){return n(this,function(t){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new s("feature-store:unsupported-query","Unsupported query options",{query:e});return[2,c.all([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),E.checkSpatialQuerySupport(e,this.geometryType,this.spatialReference),m.checkProjectionSupport(this.spatialReference,e.outSR)]).then(function(){return e})]})})},e.prototype._checkAttributesQuerySupport=function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues;if(r&&r.length>0){var i=r.map(function(e){return e.indexOf(" ASC")>-1?e.split(" ASC")[0]:e.indexOf(" DESC")>-1?e.split(" DESC")[0]:e});g.validateFields(this.fieldsIndex,i,"orderByFields contains missing fields")}if(t&&t.length>0)g.validateFields(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new s("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:e});g.validateWhere(this.fieldsIndex,e.where)},e.prototype._checkStatisticsQuerySupport=function(e){return i(this,void 0,void 0,function(){var t,r,i,o,a,u,l,c,p,f,h;return n(this,function(n){if(t=e.outStatistics,r=e.groupByFieldsForStatistics,i=e.having,o=r&&r.length,a=t&&t.length,i){if(!o||!a)throw new s("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});g.validateHaving(this.fieldsIndex,i,t)}if(a){if(t.some(function(e){return"exceedslimit"===e.statisticType}))return[2];for(u=t.map(function(e){return e.onStatisticField}),g.validateFields(this.fieldsIndex,u,"onStatisticFields contains missing fields"),o&&g.validateFields(this.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields"),l=0,c=t;l<c.length;l++){if(p=c[l],f=p.onStatisticField,"exceedslimit"===(h=p.statisticType))throw new s("feature-store:unsupported-query","statistic type exceedslimit is not supported",{definition:p,query:e});if((!o||"count"!==h)&&f&&g.hasInvalidFieldType(f,this.fieldsIndex))throw new s("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:p,query:e})}}return[2]})})},e}();t.default=F;var w=f.create(),G=f.create()}.apply(null,n))||(e.exports=i)},1686:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(11),r(27),r(9),r(7),r(71),r(422),r(57),r(1635),r(90),r(1663),r(227),r(404),r(1669),r(1739)],void 0===(i=function(e,t,r,n,i,s,o,a,u,l,c,p,f,h,_,d,y){function g(e,t,r){if(r){var n=h.quantizeOptimizedGeometry(S,t,e.hasZ,e.hasM,"esriGeometryPoint",r);return h.convertToPoint(n,e.hasZ,e.hasM)}return h.convertToPoint(t,e.hasZ,e.hasM)}function m(e,i,o){return n(this,void 0,void 0,function(){var n,a,p,f,h,_;return r(this,function(r){switch(r.label){case 0:return e?(n=e.where,e.where=n=n&&n.trim(),(!n||/^1 *= *1$/.test(n)||i&&i===n)&&(e.where=null),e.geometry?[4,v(e)]:[2,e]):[2,null];case 1:return a=r.sent(),e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel&&(p=e.geometry.spatialReference,(a=u.getGeometryExtent(a)).spatialReference=p),e.geometry=a,[4,d.checkProjectionSupport(a.spatialReference,o)];case 2:return r.sent(),[4,c.normalizeCentralMeridian(l.fromJSON(a))];case 3:if(f=r.sent()[0],s.isNone(f))throw t.QUERY_ENGINE_EMPTY_RESULT;return h=f.toJSON(),[4,d.project(h,h.spatialReference,o)];case 4:if(!(_=r.sent()))throw t.QUERY_ENGINE_EMPTY_RESULT;return _.spatialReference=o,e.geometry=_,[2,e]}})})}function v(e){return n(this,void 0,void 0,function(){var t,n,i,s,u,l,c,f,h;return r(this,function(r){switch(r.label){case 0:return t=e.geometry,n=e.distance,i=e.units,null==n?[2,o.resolve(t)]:(s=t.spatialReference,u=i&&P.fromJSON(i)||a.getUnitString(s),s&&(p.isGeographic(s)||p.isWebMercator(s))?(c=t,[3,3]):[3,1]);case 1:return[4,d.checkProjectionSupport(s,p.WGS84).then(function(){return d.project(t,p.WGS84)})];case 2:c=r.sent(),r.label=3;case 3:return l=c,[4,y.getGeodesicBufferOperator()];case 4:return f=r.sent(),[2,(h=f(l,n,u))?h.toJSON():null]}})})}Object.defineProperty(t,"__esModule",{value:!0});var P=new i.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});t.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var E=new _.default,S=new _.default,T={esriGeometryPoint:h.convertToPoint,esriGeometryPolyline:h.convertToPolyline,esriGeometryPolygon:h.convertToPolygon,esriGeometryMultipoint:h.convertToMultipoint};t.transformCentroid=g,t.getCentroid=function(e,t,r){return"esriGeometryPolygon"===e.geometryType&&t&&(t.centroid||t.geometry)?(t.centroid||(t.centroid=f.getCentroidOptimizedGeometry(new _.default,t.geometry,e.hasZ,e.hasM)),g(e,t.centroid,r)):null},t.getGeometry=function(e,t,r,n){var i=t?"coords"in t?t:t.geometry:null;if(!i)return null;if(r){var s=h.generalizeOptimizedGeometry(E,i,e.hasZ,e.hasM,e.geometryType,r);return n?(s=h.quantizeOptimizedGeometry(S,s,e.hasZ,e.hasM,e.geometryType,n),T[e.geometryType](s,e.hasZ,e.hasM)):T[e.geometryType](s,e.hasZ,e.hasM)}if(n)return s=h.quantizeOptimizedGeometry(S,i,e.hasZ,e.hasM,e.geometryType,n),T[e.geometryType](s,e.hasZ,e.hasM);return T[e.geometryType](i,e.hasZ,e.hasM)},t.normalizeQuery=function(e,t,i){return n(this,void 0,void 0,function(){var n,s,o,a,u;return r(this,function(r){if(n=e.outFields,s=e.orderByFields,o=e.groupByFieldsForStatistics,a=e.outStatistics,n)for(u=0;u<n.length;u++)n[u]=n[u].trim();if(s)for(u=0;u<s.length;u++)s[u]=s[u].trim();if(o)for(u=0;u<o.length;u++)o[u]=o[u].trim();if(a)for(u=0;u<a.length;u++)a[u].onStatisticField&&(a[u].onStatisticField=a[u].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),[2,m(e,t,i)]})})},t.normalizeFilter=function(e,t,i){return n(this,void 0,void 0,function(){return r(this,function(r){return[2,m(e,t,i)]})})},t.normalizeQueryLike=m,t.cleanFromGeometryEngine=function(e){return e&&I in e?JSON.parse(JSON.stringify(e,R)):e};var I="_geVersion",R=function(e,t){return e!==I?t:void 0}}.apply(null,n))||(e.exports=i)},1687:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._deferreds=[],this._values=[]}return e.prototype.push=function(e){var t=this;return r.create(function(r,n){t._deferreds.push({resolve:r,reject:n}),t._values.push(e)})},e.prototype.unshift=function(e){var t=this;return r.create(function(r,n){t._deferreds.unshift({resolve:r,reject:n}),t._values.unshift(e)})},Object.defineProperty(e.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,configurable:!0}),e.prototype.process=function(){return 0!==this.length&&(this._deferreds.shift().resolve(this._values.shift()),!0)},e.prototype.cancelAll=function(){for(var e=r.createAbortError(),t=0,n=this._deferreds;t<n.length;t++)n[t].reject(e);this._deferreds.length=0,this._values.length=0},e}();t.PromiseQueue=n}.apply(null,n))||(e.exports=i)},1704:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(4),r(14),r(79),r(1815)],void 0===(i=function(e,t,r,n,i,s){function o(e,t){return e?l.get(e,t):null}function a(e,t,r,i){void 0===i&&(i=!0);for(var s=[],l=0,p=t;l<p.length;l++){var f=p[l];if("*"!==f&&!e.has(f))if(i){var h=u(f);try{var _=o(h,e);if(!_)throw new n(c,"invalid SQL expression",{where:h});if(!_.isStandardized)throw new n(c,"expression is not standard",{clause:_});a(e,_.fieldNames,"expression contains missing fields")}catch(e){var d=e&&e.details;if(d&&(d.clause||d.where))throw e;d&&d.missingFields?s.push.apply(s,d.missingFields):s.push(f)}}else s.push(f)}if(s.length)throw new n(c,r,{missingFields:s})}function u(e){return e.split(p)[0]}Object.defineProperty(t,"__esModule",{value:!0});var l=new s.WhereClauseCache(50,500),c="feature-store:unsupported-query",p=" as ",f=i.SetFromValues(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);t.validateWhere=function(e,t){if(!t)return!0;var r=l.get(t,e);if(!r)throw new n(c,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new n(c,"where clause is not standard",{where:t});return a(e,r.fieldNames,"where clause contains missing fields"),!0},t.validateHaving=function(e,t,r){if(!t)return!0;var i=l.get(t,e);if(!i)throw new n(c,"invalid SQL expression",{having:t});if(!i.isAggregate)throw new n(c,"having does not contain a valid aggregate function",{having:t});var s=i.fieldNames;if(a(e,s,"having contains missing fields"),!i.getExpressions().every(function(t){var n=t.aggregateType,i=t.field,s=e.has(i)&&e.get(i).name;return r.some(function(t){var r=t.onStatisticField,i=t.statisticType;return(e.has(r)&&e.get(r).name)===s&&i.toLowerCase().trim()===n})}))throw new n(c,"expressions in having should also exist in outStatistics",{having:t});return!0},t.getWhereClause=o,t.validateFields=a,t.getExpressionFromFieldName=u,t.getAliasFromFieldName=function(e){return e.split(p)[1]},t.hasInvalidFieldType=function(e,t){var r=t.get(e);return!!r&&!f.has(r.type)}}.apply(null,n))||(e.exports=i)},1713:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(1789),r(40),r(1790)],void 0===(i=function(e,t,n,i,s,o){function a(e,t,r,n,i){if(void 0===n&&(n=null),void 0===i&&(i=!1),null===n){var a=o.cacheKey(t,r);void 0!==p[a]?n=p[a]:(null===(n=u(t,r,null))&&(n=new o),p[a]=n)}return l._project(e,t,r instanceof s||!1===i?r:new s(r),n,i)}function u(e,t,r){void 0===r&&(r=null);var n=l._getTransformation(e,t,r);return null!==n?o.fromGE(n):null}Object.defineProperty(t,"__esModule",{value:!0});var l=null;t.isLoaded=function(){return!!l&&i.isLoaded()},t.isSupported=function(){return i.isSupported()};var c=null;t.load=function(){return c||(c=n.create(function(e,t){var n=i.load();Promise.resolve().then(function(){var s=[r(187)];(function(r){l=r,n.then(function(){l._enableProjection(i),e()},function(e){t(e)})}).apply(null,s)}).catch(r.oe)}))},t.project=function(e,t,r){return void 0===r&&(r=null),e instanceof Array?0===e.length?[]:a(e,e[0].spatialReference,t,r):a([e],e.spatialReference,t,r)[0]};var p={};t.projectMany=a,t.getTransformation=u,t.getTransformations=function(e,t,r){void 0===r&&(r=null);var n=l._getTransformationBySuitability(e,t,r);if(null!==n){for(var i=[],s=0,a=n;s<a.length;s++){var u=a[s];i.push(o.fromGE(u))}return i}return[]}}.apply(null,n))||(e.exports=i)},1739:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(11),r(14),r(7),r(170),r(298),r(57),r(90),r(1816),r(227),r(404),r(1669),r(1686)],void 0===(i=function(e,t,n,i,s,o,a,u,l,c,p,f,h,_,d){function y(){return o.create(function(e){return Promise.resolve().then(function(){var t=[r(187)];e.apply(null,t)}.bind(this)).catch(r.oe)})}Object.defineProperty(t,"__esModule",{value:!0});var g="feature-store:unsupported-query",m={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},v={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};t.importGeometryEngine=y,t.getGeodesicBufferOperator=function(){return y().then(function(e){return e.geodesicBuffer})},t.getSpatialQueryOperator=function(e,t,r){if(l.isPolygon(t)&&"esriGeometryPoint"===r.geometryType&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var n=f.convertFromPolygon(new h.default,t,!1,!1);return o.resolve(function(e){return p.polygonContainsPoint(n,!1,!1,e)})}if(l.isPolygon(t)&&"esriGeometryMultipoint"===r.geometryType){var i=f.convertFromPolygon(new h.default,t,!1,!1);if("esriSpatialRelContains"===e)return o.resolve(function(e){return p.polygonContainsMultipoint(i,!1,!1,e,r.hasZ,r.hasM)})}if(l.isExtent(t)&&"esriGeometryPoint"===r.geometryType&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return o.resolve(function(e){return a.extentContainsPoint(t,d.getGeometry(r,e))});if(l.isExtent(t)&&"esriGeometryMultipoint"===r.geometryType&&"esriSpatialRelContains"===e)return o.resolve(function(e){return a.extentContainsMultipoint(t,d.getGeometry(r,e))});if(l.isExtent(t)&&"esriSpatialRelIntersects"===e){var s=u.getExtentIntersector(r.geometryType);return o.resolve(function(e){return s(t,d.getGeometry(r,e))})}return y().then(function(n){var i=n[m[e]].bind(null,t);return function(e){return i(d.getGeometry(r,e))}})},t.checkSpatialQuerySupport=function(e,t,r){return i(this,void 0,void 0,function(){var i,o;return n(this,function(n){if(i=e.spatialRel,!(o=e.geometry))return[2];if(!function(e){return!0===v.spatialRelationship[e]}(i))throw new s(g,"Unsupported query spatial relationship",{query:e});if(!c.isValid(o.spatialReference)||!c.isValid(r))return[2];if(!function(e){return!0===v.queryGeometry[l.getJsonType(e)]}(o))throw new s(g,"Unsupported query geometry type",{query:e});if(!function(e){return!0===v.layerGeometry[e]}(t))throw new s(g,"Unsupported layer geometry type",{query:e});return e.outSR?[2,_.checkProjectionSupport(e.geometry&&e.geometry.spatialReference,e.outSR)]:[2]})})},t.canQueryWithRBush=function(e){if(l.isExtent(e))return!0;if(l.isPolygon(e)){for(var t=0,r=e.rings;t<r.length;t++){var n=r[t];if(5!==n.length)return!1;if(n[0][0]!==n[1][0]||n[0][0]!==n[4][0]||n[2][0]!==n[3][0]||n[0][1]!==n[3][1]||n[0][1]!==n[4][1]||n[1][1]!==n[2][1])return!1}return!0}return!1}}.apply(null,n))||(e.exports=i)},1770:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeExtent=function(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach(function(e){var t=r.getAttribute(e,n),a=r.getAttribute(e,i);null==t||isNaN(t)||(s=Math.min(s,t)),null==a||isNaN(a)||(o=Math.max(o,a))});else{var a=n||i;t.forEach(function(e){var t=r.getAttribute(e,a);null==t||isNaN(t)||(s=Math.min(s,t),o=Math.max(o,t))})}return{start:s,end:o}},t.getTimeOperator=function(e,t,r){if(!t||!e)return null;var n=e.startTimeField,i=e.endTimeField;if(!n&&!i)return null;var s=t.start,o=t.end;return null==s&&null==o?null:n&&i?function(e,t,r,n,i){if(null!=n&&null!=i&&n===i){var s=n;return function(n){return s>=e.getAttribute(n,t)&&s<=e.getAttribute(n,r)}}return null!=n&&null!=i?function(s){return function(e,t,r,n){return!(r>t||n<e)}(n,i,e.getAttribute(s,t),e.getAttribute(s,r))}:null!=n?function(t){return!(e.getAttribute(t,r)<n)}:null!=i?function(r){return!(e.getAttribute(r,t)>i)}:void 0}(r,n,i,s,o):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){return e.getAttribute(i,t)>=r&&e.getAttribute(i,t)<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(r,n||i,s,o)}}.apply(null,n))||(e.exports=i)},1789:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(3),r(18),r(7)],void 0===(i=function(e,t,n,i,s){function o(e){function r(e,t,r){e[t]=r(e[t])}t._pe=e,f.init(),h.init(),_.init(),d.init(),y.init(),t.PeGCSExtent=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n(r,e),r.prototype.destroy=function(){t._pe.destroy(this)},r}(t._pe.PeGCSExtent);for(var i=0,s=[t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];i<s.length;i++){r(s[i].prototype,"getName",function(e){return function(){return e.call(this,new Array(f.PE_NAME_MAX))}})}for(var o=0,a=[t._pe.PeGeogtran,t._pe.PeProjcs];o<a.length;o++){r(a[o].prototype,"getParameters",function(e){return function(){for(var r=new Array(f.PE_PARM_MAX),n=e.call(this),i=0;i<r.length;i++){var s=t._pe.getValue(n,"*");r[i]=s?t._pe.wrapPointer(s,t._pe.PeParameter):null,n+=Int32Array.BYTES_PER_ELEMENT}return r}})}r(t._pe.PeHorizon.prototype,"getCoord",function(e){return function(){var t=this.getSize();if(!t)return null;var r=[];return c(r,t,e.call(this)),r}}),r(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(e){var r=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){var n=null,i=e.call(this);if(!t._pe.compare(i,t._pe.NULL)){n=[i];var s=this.getSteps();if(s>1)for(var o=t._pe.getPointer(i),a=1;a<s;a++)n.push(t._pe.wrapPointer(o+r*a,t._pe.PeGTlistExtendedGTs))}return n}});var u=t._pe._pe_getPeHorizonSize(),l=function(e){return function(){var r=this._cache;if(r||(r=new Map,this._cache=r),r.has(e))return r.get(e);var n=null,i=e.call(this);if(!t._pe.compare(i,t._pe.NULL)){n=[i];var s=i.getNump();if(s>1)for(var o=t._pe.getPointer(i),a=1;a<s;a++)n.push(t._pe.wrapPointer(o+u*a,t._pe.PeHorizon))}return r.set(e,n),n}};r(t._pe.PeProjcs.prototype,"horizonGcsGenerate",l),r(t._pe.PeProjcs.prototype,"horizonPcsGenerate",l),t._pe.PeObject.prototype.toString=function(e){void 0===e&&(e=f.PE_STR_OPTS_NONE),t._pe.ensureCache.prepare();var r=t._pe.getPointer(this),n=t._pe.ensureInt8(new Array(f.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(r,e,n))}}function a(e){if(e){var r=t._pe.getClass(e);if(r){var n=t._pe.getCache(r);if(n){var i=t._pe.getPointer(e);i&&delete n[i]}}}}function u(e,r){for(var n=[],i=new Array(r),s=0;s<e;s++)n.push(t._pe.ensureInt8(i));return n}function l(e){var t;return Array.isArray(e[0])?(t=[],e.forEach(function(e){t.push(e[0],e[1])})):t=e,t}function c(e,r,n,i){if(void 0===i&&(i=!1),i)for(var s=0;s<2*r;s++)e[s]=t._pe.getValue(n+s*Float64Array.BYTES_PER_ELEMENT,"double");else{var o=0===e.length;for(s=0;s<r;s++)o&&(e[s]=new Array(2)),e[s][0]=t._pe.getValue(n,"double"),e[s][1]=t._pe.getValue(n+Float64Array.BYTES_PER_ELEMENT,"double"),n+=2*Float64Array.BYTES_PER_ELEMENT}}var p,f,h,_,d,y;Object.defineProperty(t,"__esModule",{value:!0}),t._pe=null,t.isLoaded=function(){return!!t._pe},t.isSupported=function(){return!!i("esri-wasm")},t.load=function(){return p||(p=s.create(function(t,n){r.e(92).then(function(){var i=[r(2028)];(function(r){r({locateFile:function(t){return e.toUrl("./support/"+t)},onAbort:function(e){n(new Error(e))}}).then(function(e){o(e),t()})}).apply(null,i)}).catch(r.oe)}))},function(e){function r(e,r,n){t._pe.ensureCache.prepare();var i=l(n),s=n===i,o=t._pe.ensureFloat64(i),a=t._pe._pe_geog_to_proj(t._pe.getPointer(e),r,o);return a&&c(n,r,o,s),a}function n(e,t,r){return i(e,t,r,0)}function i(e,r,n,i){t._pe.ensureCache.prepare();var s=l(n),o=n===s,a=t._pe.ensureFloat64(s),u=t._pe._pe_proj_to_geog_center(t._pe.getPointer(e),r,a,i);return u&&c(n,r,a,o),u}e.geogToProj=r,e.projGeog=function(e,t,i,s){switch(s){case f.PE_TRANSFORM_P_TO_G:return n(e,t,i);case f.PE_TRANSFORM_G_TO_P:return r(e,t,i)}return 0},e.projToGeog=n,e.projToGeogCenter=i}(t.PeCSTransformations||(t.PeCSTransformations={})),function(e){e.init=function(){e.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=t._pe.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT,e.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_PARM_X0=t._pe.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA}}(f=t.PeDefs||(t.PeDefs={})),function(e){function r(e,r){var s=null,o=i[e];if(o||(o={},i[e]=o),o.hasOwnProperty(String(r)))s=o[r];else{var a=t._pe.PeFactory.prototype.factoryByType(e,r);t._pe.compare(a,t._pe.NULL)||(s=a,o[r]=s)}return n(s)}function n(e){if(e){var r=e.getType();switch(r){case f.PE_TYPE_GEOGCS:e=t._pe.castObject(e,t._pe.PeGeogcs);break;case f.PE_TYPE_PROJCS:e=t._pe.castObject(e,t._pe.PeProjcs);break;case f.PE_TYPE_GEOGTRAN:e=t._pe.castObject(e,t._pe.PeGeogtran);break;default:r&f.PE_TYPE_UNIT&&(e=t._pe.castObject(e,t._pe.PeUnit))}}return e}var i={},s={};e.initialize=function(){t._pe.PeFactory.prototype.initialize(null)},e.coordsys=function(e){return r(f.PE_TYPE_COORDSYS,e)},e.factoryByType=r,e.fromString=function(e,r){var i=null,o=s[e];if(o||(o={},s[e]=o),o.hasOwnProperty(r))i=o[r];else{var a=t._pe.PeFactory.prototype.fromString(e,r);t._pe.compare(a,t._pe.NULL)||(i=a,o[r]=i)}return n(i)},e.geogcs=function(e){return r(f.PE_TYPE_GEOGCS,e)},e.geogtran=function(e){return r(f.PE_TYPE_GEOGTRAN,e)},e.getCode=function(e){return t._pe.PeFactory.prototype.getCode(e)},e.projcs=function(e){return r(f.PE_TYPE_PROJCS,e)},e.unit=function(e){return r(f.PE_TYPE_UNIT,e)}}(t.PeFactory||(t.PeFactory={})),t.PeGCSExtent=null,function(e){var r;e.init=function(){e.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,r=t._pe._pe_getPeGTlistExtendedEntrySize()},e.getGTlist=function(e,n,i,s,o,a){var u=null,l=new t._pe.PeInteger(a);try{var c=t._pe.PeGTlistExtended.prototype.getGTlist(e,n,i,s,o,l);if((a=l.val)&&(u=[c],a>1))for(var p=t._pe.getPointer(c),f=1;f<a;f++)u.push(t._pe.wrapPointer(p+r*f,t._pe.PeGTlistExtendedEntry))}finally{t._pe.destroy(l)}return u}}(h=t.PeGTlistExtended||(t.PeGTlistExtended={})),function(e){(t.PeGTlistExtendedEntry||(t.PeGTlistExtendedEntry={})).destroy=function(e){if(e&&e.length){for(var r=0,n=e;r<n.length;r++){var i=n[r];a(i),i.getEntries().forEach(function(e){a(e);var t=e.getGeogtran();a(t),t.getParameters().forEach(a),[t.getGeogcs1(),t.getGeogcs2()].forEach(function(e){a(e);var t=e.getDatum();a(t),a(t.getSpheroid()),a(e.getPrimem()),a(e.getUnit())})})}t._pe.PeGTlistExtendedEntry.prototype.Delete(e[0])}}}(),function(e){(t.PeGTTransformations||(t.PeGTTransformations={})).geogToGeog=function(e,r,n,i,s){t._pe.ensureCache.prepare();var o=l(n),a=n===o,u=t._pe.ensureFloat64(o),p=0;i&&(p=t._pe.ensureFloat64(i));var f=t._pe._pe_geog_to_geog(t._pe.getPointer(e),r,u,p,s);return f&&c(n,r,u,a),f}}(),function(e){function r(e,r,n,i,s,o){var a,c;switch(t._pe.ensureCache.prepare(),e){case"dd":a=t._pe._pe_geog_to_dd,c=f.PE_DD_MAX;break;case"ddm":a=t._pe._pe_geog_to_ddm,c=f.PE_DDM_MAX;break;case"dms":a=t._pe._pe_geog_to_dms,c=f.PE_DMS_MAX}var p=0;r&&(p=t._pe.getPointer(r));var h=l(i),_=t._pe.ensureFloat64(h),d=u(n,c),y=a(p,n,_,s,t._pe.ensureInt32(d));if(y)for(var g=0;g<n;g++)o[g]=t._pe.UTF8ToString(d[g]);return y}function n(e,r,n,i,s){var o;switch(t._pe.ensureCache.prepare(),e){case"dd":o=t._pe._pe_dd_to_geog;break;case"ddm":o=t._pe._pe_ddm_to_geog;break;case"dms":o=t._pe._pe_dms_to_geog}var a=0;r&&(a=t._pe.getPointer(r));var u=i.map(function(e){return t._pe.ensureString(e)}),l=t._pe.ensureInt32(u),p=t._pe.ensureFloat64(new Array(2*n)),f=o(a,n,l,p);return f&&c(s,n,p),f}e.geog_to_dms=function(e,t,n,i,s){return r("dms",e,t,n,i,s)},e.dms_to_geog=function(e,t,r,i){return n("dms",e,t,r,i)},e.geog_to_ddm=function(e,t,n,i,s){return r("ddm",e,t,n,i,s)},e.ddm_to_geog=function(e,t,r,i){return n("ddm",e,t,r,i)},e.geog_to_dd=function(e,t,n,i,s){return r("dd",e,t,n,i,s)},e.dd_to_geog=function(e,t,r,i){return n("dd",e,t,r,i)}}(t.PeNotationDms||(t.PeNotationDms={})),function(e){e.init=function(){e.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},e.geog_to_mgrs_extended=function(e,r,n,i,s,o,a){t._pe.ensureCache.prepare();var c=0;e&&(c=t._pe.getPointer(e));var p=l(n),h=t._pe.ensureFloat64(p),_=u(r,f.PE_MGRS_MAX),d=t._pe.ensureInt32(_),y=t._pe._pe_geog_to_mgrs_extended(c,r,h,i,s,o,d);if(y)for(var g=0;g<r;g++)a[g]=t._pe.UTF8ToString(_[g]);return y},e.mgrs_to_geog_extended=function(e,r,n,i,s){t._pe.ensureCache.prepare();var o=0;e&&(o=t._pe.getPointer(e));var a=n.map(function(e){return t._pe.ensureString(e)}),u=t._pe.ensureInt32(a),l=t._pe.ensureFloat64(new Array(2*r)),p=t._pe._pe_mgrs_to_geog_extended(o,r,u,i,l);return p&&c(s,r,l),p}}(_=t.PeNotationMgrs||(t.PeNotationMgrs={})),function(e){e.geog_to_usng=function(e,r,n,i,s,o,a){t._pe.ensureCache.prepare();var c=0;e&&(c=t._pe.getPointer(e));var p=l(n),h=t._pe.ensureFloat64(p),_=u(r,f.PE_MGRS_MAX),d=t._pe.ensureInt32(_),y=t._pe._pe_geog_to_usng(c,r,h,i,s,o,d);if(y)for(var g=0;g<r;g++)a[g]=t._pe.UTF8ToString(_[g]);return y},e.usng_to_geog=function(e,r,n,i){t._pe.ensureCache.prepare();var s=0;e&&(s=t._pe.getPointer(e));var o=n.map(function(e){return t._pe.ensureString(e)}),a=t._pe.ensureInt32(o),u=t._pe.ensureFloat64(new Array(2*r)),l=t._pe._pe_usng_to_geog(s,r,a,u);return l&&c(i,r,u),l}}(t.PeNotationUsng||(t.PeNotationUsng={})),function(e){e.init=function(){e.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS},e.geog_to_utm=function(e,r,n,i,s){t._pe.ensureCache.prepare();var o=0;e&&(o=t._pe.getPointer(e));var a=l(n),c=t._pe.ensureFloat64(a),p=u(r,f.PE_UTM_MAX),h=t._pe.ensureInt32(p),_=t._pe._pe_geog_to_utm(o,r,c,i,h);if(_)for(var d=0;d<r;d++)s[d]=t._pe.UTF8ToString(p[d]);return _},e.utm_to_geog=function(e,r,n,i,s){t._pe.ensureCache.prepare();var o=0;e&&(o=t._pe.getPointer(e));var a=n.map(function(e){return t._pe.ensureString(e)}),u=t._pe.ensureInt32(a),l=t._pe.ensureFloat64(new Array(2*r)),p=t._pe._pe_utm_to_geog(o,r,u,i,l);return p&&c(s,r,l),p}}(d=t.PeNotationUtm||(t.PeNotationUtm={})),function(e){var r=new Map;e.init=function(){e.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT},e.generate=function(n,i){var s,o;return void 0===i&&(i=e.PE_PCSINFO_OPTION_DOMAIN),r.has(n)&&(o=r.get(n))[i]&&(s=o[i]),s||(s=t._pe.PePCSInfo.prototype.generate(n,i),o||(o=[],r.set(n,o)),o[i]=s),s}}(y=t.PePCSInfo||(t.PePCSInfo={})),function(e){(t.PeVersion||(t.PeVersion={})).version_string=function(){return t._pe.PeVersion.prototype.version_string()}}(),t._init=o}.apply(null,n))||(e.exports=i)},1790:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1791)],void 0===(i=function(e,t,r){return function(){function e(e){if(this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,e&&e.steps)for(var t=0,n=e.steps;t<n.length;t++){var i=n[t];i instanceof r?this.steps.push(i):this.steps.push(new r({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}}return e.cacheKey=function(e,t){return[void 0!==e.wkid&&null!==e.wkid?e.wkid.toString():"-1",void 0!==e.wkt&&null!==e.wkt?e.wkt.toString():"",void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():""].join(",")},e.fromGE=function(t){for(var n=new e,i="",s=0,o=t.steps;s<o.length;s++){var a=o[s],u=r.fromGE(a);n.steps.push(u),i+=u.uid.toString()+","}return n._cached_projection={},n._gtlistentry=null,n._chain=i,n},e.prototype.getInverse=function(){var t=new e;t.steps=[];for(var r=this.steps.length-1;r>=0;r--){var n=this.steps[r];t.steps.push(n.getInverse())}return t},e.prototype.getGTListEntry=function(){for(var e="",t=0,r=this.steps;t<r.length;t++)e+=r[t].uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=e),this._gtlistentry},e.prototype.assignCachedGe=function(t,r,n){this._cached_projection[e.cacheKey(t,r)]=n},e.prototype.getCachedGeTransformation=function(t,r){for(var n="",i=0,s=this.steps;i<s.length;i++)n+=s[i].uid.toString()+",";n!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=n);var o=this._cached_projection[e.cacheKey(t,r)];return void 0===o?null:o},e}()}.apply(null,n))||(e.exports=i)},1791:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){var r=0;return function(){function e(e){void 0===e&&(e=null),this.uid=r++,e?(this._wkt=void 0!==e.wkt?e.wkt:null,this._wkid=void 0!==e.wkid?e.wkid:-1,this._isInverse=void 0!==e.isInverse&&!0===e.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}return e.fromGE=function(t){var r=new e;return r._wkt=t.wkt,r._wkid=t.wkid,r._isInverse=t.isInverse,r},Object.defineProperty(e.prototype,"wkt",{get:function(){return this._wkt},set:function(e){this._wkt=e,this.uid=r++},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wkid",{get:function(){return this._wkid},set:function(e){this._wkid=e,this.uid=r++},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInverse",{get:function(){return this._isInverse},set:function(e){this._isInverse=e,this.uid=r++},enumerable:!0,configurable:!0}),e.prototype.getInverse=function(){var t=new e;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t},e}()}.apply(null,n))||(e.exports=i)},1815:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(665),r(635)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._cache=new r(e),this._invalidCache=new r(t)}return e.prototype.get=function(e,t){var r=t.uid+":"+e,i=this._cache.get(r);if(i)return i;if(void 0!==this._invalidCache.get(r))return null;try{var s=n.WhereClause.create(e,t);return this._cache.put(r,s),s}catch(e){return this._invalidCache.put(r,null),null}},e}();t.WhereClauseCache=i}.apply(null,n))||(e.exports=i)},1816:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return e?t?4:3:t?3:2}function n(e,t,n,s,o){if(!e)return!1;for(var a=r(t,n),u=e.coords,l=!1,c=0,p=0,f=e.lengths;p<f.length;p++){var h=f[p];l=i(l,u,a,c,h,s,o),c+=h*a}return l}function i(e,t,r,n,i,s,o){for(var a=e,u=n,l=n,c=n+i*r;l<c;l+=r){(u=l+r)===c&&(u=n);var p=t[l],f=t[l+1],h=t[u],_=t[u+1];(f<o&&_>=o||_<o&&f>=o)&&p+(o-f)/(_-f)*(h-p)<s&&(a=!a)}return a}Object.defineProperty(t,"__esModule",{value:!0}),t.polygonContainsPoint=function(e,t,r,i){return n(e,t,r,i.coords[0],i.coords[1])},t.polygonContainsMultipoint=function(e,t,i,s,o,a){var u=r(o,a),l=s.coords,c=s.lengths;if(!c)return!1;for(var p=0,f=0;p<c.length;p++,f+=u)if(!n(e,t,i,l[f],l[f+1]))return!1;return!0},t.polygonContainsCoords=n}.apply(null,n))||(e.exports=i)},2445:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(4),r(10),r(11),r(79),r(9),r(7),r(432),r(90),r(227),r(2446),r(1704),r(1669),r(1770),r(1686)],void 0===(i=function(e,t,r,n,i,s,o,a,u,l,c,p,f,h,_,d){Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(e,t,r){this.items=e,this.queryGeometry=t,this.definitionExpression=r.definitionExpression,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.fieldsIndex=r.fieldsIndex,this.timeInfo=r.timeInfo,this.featureAdapter=r.featureAdapter}return Object.defineProperty(e.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),e.prototype.createQueryResponse=function(e){var t;return t=e.outStatistics?e.outStatistics.some(function(e){return"exceedslimit"===e.statisticType})?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(l.isValid(e.outSR)&&!l.equals(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=d.cleanFromGeometryEngine(r({spatialReference:e.outSR},h.project(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):t.queryGeometry=d.cleanFromGeometryEngine(r({spatialReference:e.outSR},this.queryGeometry))),t},e.prototype.executeAttributesQuery=function(t){var r=f.getWhereClause(t.where,this.fieldsIndex);if(!r)return a.resolve(this);if(r.isStandardized){for(var n=0,i=[],s=0,o=this.items;s<o.length;s++){var u=o[s];r.testFeature(u,this.featureAdapter)&&(i[n++]=u)}var l=new e(i,this.queryGeometry,this);return l.definitionExpression=t.where,a.resolve(l)}return a.reject(new TypeError("Where clause is not standardized"))},e.prototype.executeObjectIdsQuery=function(t){if(!t.objectIds||!t.objectIds.length)return a.resolve(this);var r=s.SetFromValues(t.objectIds),n=this.featureAdapter.getObjectId;return a.resolve(new e(this.items.filter(function(e){return r.has(n(e))}),this.queryGeometry,this))},e.prototype.executeTimeQuery=function(t){var r=_.getTimeOperator(this.timeInfo,t.timeExtent,this.featureAdapter);if(!o.isSome(r))return a.resolve(this);var n=this.items.filter(r);return a.resolve(new e(n,this.queryGeometry,this))},e.prototype.project=function(t){return i(this,void 0,void 0,function(){var r,i,s=this;return n(this,function(n){switch(n.label){case 0:return!t||l.equals(this.spatialReference,t)?[2,this]:(r=this.featureAdapter,[4,h.projectMany(this.items.map(function(e){return d.getGeometry(s,r.getGeometry(e))}),this.spatialReference,t)]);case 1:return i=n.sent(),[2,new e(i.map(function(e,t){return r.cloneWithGeometry(s.items[t],c.convertFromGeometry(e,s.hasZ,s.hasM))}),this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:t,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})},e.prototype._createFeatureQueryResponse=function(e){var t=this,r=this.items,n=this,i=n.geometryType,s=n.hasM,o=n.hasZ,a=n.objectIdField,l=n.spatialReference,c=e.outFields,p=e.outSR,f=e.quantizationParameters,h=e.resultRecordCount,_=e.resultOffset,y=!1;if(null!=h&&null!=_){var g=_+h;y=r.length>g,r=r.slice(_,Math.min(r.length,g))}return{exceededTransferLimit:y,features:this._createFeatures(e,r),fields:c&&c.map(function(e){return t.fieldsIndex.get(e)}),geometryType:i,hasM:s,hasZ:o,objectIdFieldName:a,spatialReference:d.cleanFromGeometryEngine(p||l),transform:f&&u.toQuantizationTransform(f)||null}},e.prototype._createFeatures=function(e,t){var r=new p.default(e,this.featureAdapter,this.fieldsIndex),n=e.quantizationParameters,i=e.returnGeometry,s=e.returnCentroid,o=e.maxAllowableOffset,a=e.orderByFields,l=[],c=0;if(t.length&&a&&a.length){var f=a[0].split(" "),h=f[0],_=this.fieldsIndex.get(h),y="DESC"===f[1];t.sort(function(e,t){var n=r.getFieldValue(e,h,_),i=r.getFieldValue(t,h,_);if("number"==typeof n&&"number"==typeof i)return y?i-n:n-i;if("string"==typeof n&&"string"==typeof i){var s=n.toUpperCase(),o=i.toUpperCase();return(y?s>o:s<o)?-1:(y?s<o:s>o)?1:0}})}if(i||s){var g=u.toQuantizationTransform(n);if(i&&!s)for(var m=0,v=t;m<v.length;m++){var P=v[m];l[c++]={attributes:r.getAttributes(P),geometry:d.getGeometry(this,this.featureAdapter.getGeometry(P),o,g)}}else if(!i&&s)for(var E=0,S=t;E<S.length;E++){P=S[E];l[c++]={attributes:r.getAttributes(P),centroid:d.transformCentroid(this,this.featureAdapter.getCentroid(P,this),g)}}else for(var T=0,I=t;T<I.length;T++){P=I[T];l[c++]={attributes:r.getAttributes(P),centroid:d.transformCentroid(this,this.featureAdapter.getCentroid(P,this),g),geometry:d.getGeometry(this,this.featureAdapter.getGeometry(P),o,g)}}}else for(var R=0,N=t;R<N.length;R++){P=N[R];var x=r.getAttributes(P);x&&(l[c++]={attributes:x})}return l},e.prototype._createExceedsLimitQueryResponse=function(e){for(var t=!1,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,s=0,o=e.outStatistics;s<o.length;s++){var a=o[s];if("exceedslimit"===a.statisticType){r=null!=a.maxPointCount?a.maxPointCount:Number.POSITIVE_INFINITY,n=null!=a.maxRecordCount?a.maxRecordCount:Number.POSITIVE_INFINITY,i=null!=a.maxVertexCount?a.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)t=this.items.length>r;else if(this.items.length>n)t=!0;else{var u=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;t=this.items.reduce(function(e,t){var r=l.getGeometry(t);return e+(r&&r.coords.length||0)},0)/u>i}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}},e.prototype._createStatisticsQueryResponse=function(e){for(var t=new p.default(e,this.featureAdapter,this.fieldsIndex),r=e.outStatistics,n=[],i=[],s=e.groupByFieldsForStatistics,o=e.having,a=s&&s.length,u=a&&s[0],l=this.fieldsIndex.get(u),c=!l,f={},h={},_={},d={attributes:{}},y=0,g=r;y<g.length;y++){var m=g[y],v=m.outStatisticFieldName,P=m.statisticType,E="exceedslimit"!==P?m.onStatisticField:void 0,S=this.fieldsIndex.get(E),T=a&&(E===u||c)&&"count"===P;if(a){f[E]||(f[E]=this._calculateUniqueValues(t,u,l));var I=f[E];for(var R in I){var N=I[R],x=N.count,O=N.data,b=N.items;if(!o||t.validateItems(b,o)){var M=h[O]||{attributes:{}},F=null;if(T)F=x;else F=(w=this._calculateStatistics(b,t,E,S))[G="var"===P?"variance":P];M.attributes[v]=F,M.attributes[c?"EXPR_1":u]=O,h[O]=M}}}else{_[E]||(_[E]=this._calculateStatistics(this.items,t,E,S));var w=_[E],G="var"===P?"variance":P;d.attributes[v]=w[G]}i.push({name:v,alias:v,type:"esriFieldTypeDouble"})}if(a)for(var A in h)n.push(h[A]);else n.push(d);return{fields:i,features:n}},e.prototype._calculateStatistics=function(e,t,r,n){for(var i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=null,a=null,u=null,l=null,c=[],p=0,f=0;f<e.length;f++){var h=e[f];"string"==typeof(g=t.getFieldValue(h,r,n))?p++:null==g||isNaN(g)||(o+=g,i=Math.min(i,g),s=Math.max(s,g),c.push(g),p++)}if(p){a=o/p;for(var _=0,d=0,y=c;d<y.length;d++){var g=y[d];_+=Math.pow(g-a,2)}l=p>1?_/(p-1):0,u=Math.sqrt(l)}else i=null,s=null;return{avg:a,count:p,max:s,min:i,stddev:u,sum:o,variance:l}},e.prototype._calculateUniqueValues=function(e,t,r){for(var n={},i=0,s=this.items;i<s.length;i++){var o=s[i],a=e.getFieldValue(o,t,r);(null==a||"string"==typeof a&&""===a.trim())&&(a=null),null==n[a]?n[a]={count:1,data:a,items:[o]}:(n[a].count++,n[a].items.push(o))}return n},e}();t.default=y}.apply(null,n))||(e.exports=i)},2446:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(9),r(1704)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=t;var i=e.outFields;if(i&&-1===i.indexOf("*")){this.outFields=i;for(var s=0,o=0,a=i;o<a.length;o++){var u=a[o],l=n.getExpressionFromFieldName(u),c=this.fieldsIndex.get(l),p=c?null:n.getWhereClause(l,r),f=c?c.name:n.getAliasFromFieldName(u)||"FIELD_EXP_"+s++;this._fieldDataCache.set(u,{alias:f,clause:p})}}}return e.prototype.getAttributes=function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)},e.prototype.getFieldValue=function(e,t,r){var i=r?r.name:t,s=null;return this._fieldDataCache.has(i)?s=this._fieldDataCache.get(i).clause:r||(s=n.getWhereClause(t,this.fieldsIndex),this._fieldDataCache.set(i,{alias:i,clause:s})),r?this.featureAdapter.getAttribute(e,i):s.calculateValue(e,this.featureAdapter)},e.prototype.validateItem=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)},e.prototype.validateItems=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)},e.prototype._processAttributesForOutFields=function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);for(var r={},n=0,i=t;n<i.length;n++){var s=i[n],o=this._fieldDataCache.get(s),a=o.alias,u=o.clause;r[a]=u?u.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,a)}return r},e.prototype._processAttributesForDistinctValues=function(e){if(r.isNone(e)||!this.returnDistinctValues)return e;var t=this.outFields,n=[];if(t)for(var i=0,s=t;i<s.length;i++){var o=s[i],a=this._fieldDataCache.get(o).alias;n.push(e[a])}else for(var a in e)n.push(e[a]);var u=(t||["*"]).join(",")+"="+n.join(","),l=this._returnDistinctMap.get(u)||0;return this._returnDistinctMap.set(u,++l),l>1?null:e},e}();t.default=i}.apply(null,n))||(e.exports=i)}}]);