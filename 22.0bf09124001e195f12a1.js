(function(){(this||window).webpackJsonp.registerAbsMids({"esri/core/HandleOwner":1503,"esri/views/layers/LayerView":1504,"esri/views/2d/engine/webgl/definitions":1506,"esri/views/layers/RefreshableLayerView":1508,"esri/views/2d/engine/Container":1510,"esri/views/2d/layers/LayerView2D":1512,"esri/views/2d/tiling/TileStrategy":1524,"esri/renderers/support/clickToleranceUtils":1525,"esri/views/layers/support/popupUtils":1526,"esri/views/2d/layers/support/popupUtils2D":1633,"esri/views/2d/layers/features/controllers":1649,"esri/views/layers/support/FeatureEffect":1654,"esri/views/layers/FeatureLayerView":1692,"esri/views/layers/support/ParsedFeatureEffect":1693,"esri/views/layers/support/cssFilterParser":1694,"esri/views/layers/support/Transition":1695,"esri/views/2d/layers/FeatureLayerView2D":1788,"esri/views/2d/layers/features/tileRenderers":2216,"esri/views/2d/layers/support/FeatureLayerProxy":2217,"esri/views/2d/layers/support/util":2218})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1503:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(6),r(17),r(0)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.call(this)||this;return n.handles=new o,n}return r(t,e),t.prototype.destroy=function(){this.handles.destroy()},n([a.property({readOnly:!0})],t.prototype,"handles",void 0),n([a.subclass("esri.core.HandleOwner")],t)}(a.declared(i))}.apply(null,n))||(e.exports=i)},1504:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(48),r(1503),r(210),r(10),r(209),r(9),r(0)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c){return function(e){function t(t){var r=e.call(this)||this;return r.layer=null,r.parent=null,r.view=null,r}return r(t,e),t.prototype.initialize=function(){var e=this;this.addResolvingPromise(this.layer),this.when().catch(function(t){if("layerview:create-error"!==t.name){var r=e.layer&&e.layer.id||"no id",n=e.layer&&e.layer.title||"no title";return s.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+n+"', id: '"+r+"')",t),l.reject(t)}})},t.prototype.destroy=function(){this.layer=this.view=this.parent=null},Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&this.isUpdating()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null==e?1:e};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.isUpdating=function(){return!1},n([c.property()],t.prototype,"layer",void 0),n([c.property()],t.prototype,"parent",void 0),n([c.property({readOnly:!0,dependsOn:["view","visible","layer.loaded","parent.suspended"]})],t.prototype,"suspended",null),n([c.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],t.prototype,"updating",null),n([c.property()],t.prototype,"view",void 0),n([c.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),n([c.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),n([c.subclass("esri.views.layers.LayerView")],t)}(c.declared(o,i,a.Identifiable,u))}.apply(null,n))||(e.exports=i)},1506:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EXTRUDE_SCALE=64,t.PICTURE_FILL_COLOR=4294967295,t.TILE_SIZE=512,t.ANGLE_FACTOR_256=256/360,t.DEBUG_LABELS=!1,t.COLLISION_BUCKET_SIZE=128,t.DOT_DENSITY_MAX_FIELDS=8,t.COLLISION_MAX_ZOOM_DELTA=3,t.COLLISION_EARLY_REJECT_BUCKET_SIZE=16,t.COLLISION_BOX_PADDING=8,t.COLLISION_TILE_BOX_SIZE=t.TILE_SIZE/t.COLLISION_BUCKET_SIZE,t.COLLISION_PLACEMENT_PADDING=8,t.HEURISTIC_GLYPHS_PER_LINE=50,t.HEURISTIC_GLYPHS_PER_FEATURE=10,t.GLYPH_SIZE=24,t.TEXT_LINE_HEIGHT=1.2*t.GLYPH_SIZE,t.TEXT_MAX_WIDTH=10*t.GLYPH_SIZE,t.TEXT_SPACING=0,t.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}},t.TEXTURE_BINDING_SPRITE_ATLAS=0,t.TEXTURE_BINDING_GLYPH_ATLAS=1,t.TEXTURE_BINDING_HIGHLIGHT_0=2,t.TEXTURE_BINDING_HIGHLIGHT_1=3,t.TEXTURE_BINDING_RENDERER_0=4,t.TEXTURE_BINDING_RENDERER_1=5,t.MAX_FILTERS=2,t.FILTER_FLAG_0=1,t.EFFECT_FLAG_0=2}.apply(null,n))||(e.exports=i)},1508:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(6),r(0)],void 0===(i=function(e,t,r,n,i,o){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refreshTimestamp=null,t}return r(t,e),t.prototype.refresh=function(e){void 0===e&&(e=Date.now()),this._set("refreshTimestamp",e),this.doRefresh&&this.doRefresh()},n([o.property()],t.prototype,"layer",void 0),n([o.aliasOf("layer.refreshInterval")],t.prototype,"refreshInterval",void 0),n([o.property({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),n([o.subclass("esri.layers.mixins.RefreshableLayerView")],t)}(o.declared(i))}.apply(null,n))||(e.exports=i)},1510:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(5),r(548)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._childrenSet=new Set,t._childrenToAttach=[],t._childrenToDetach=[],t._renderPhase=3,t.children=[],t}return r(t,e),Object.defineProperty(t.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),t.prototype.detach=function(){for(var e=0,t=this.children.concat(this._childrenToDetach);e<t.length;e++){var r=t[e];r.attached&&(this.detachChild(r),r.attached=!1,r.parent=null)}},t.prototype.doRender=function(e){var t=e.globalOpacity;e.globalOpacity*=this.opacity,this._renderPhase=0,this.attachChildren(),this._renderPhase=1;for(var r=this._childrenToDetach;r.length>0;){var n=r.shift();this.detachChild(n),n.attached=!1,n.parent=null,n.stage=null}this._renderPhase=2,this.renderChildren(e),this._renderPhase=3,e.globalOpacity=t},t.prototype.addChild=function(e){return this.addChildAt(e,this.children.length)},t.prototype.addChildAt=function(e,t){if(void 0===t&&(t=this.numChildren),!e)return e;if(this.contains(e))return e;var r=e.parent;r&&r!==this&&r.removeChild(e),t>=this.numChildren?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e);var n=this._childrenToDetach.indexOf(e);return n>-1&&this._childrenToDetach.splice(n,1),this._childrenToAttach.push(e),this._renderPhase>=2&&this.requestRender(),e},t.prototype.contains=function(e){return this._childrenSet.has(e)},t.prototype.getChildIndex=function(e){return this.children.indexOf(e)},t.prototype.getChildAt=function(e){return e<0||e>this.children.length?null:this.children[e]},t.prototype.removeAllChildren=function(){for(var e=this.numChildren;e--;)this.removeChildAt(0)},t.prototype.removeChild=function(e){return this.contains(e)?this.removeChildAt(this.getChildIndex(e)):e},t.prototype.removeChildAt=function(e){var t;if(e<0||e>=this.children.length)return null;if(t=this.children.splice(e,1)[0],function(e,t){e.delete(t)}(this._childrenSet,t),t.attached)this._childrenToDetach.push(t),this._renderPhase>=2&&this.requestRender();else{var r=this._childrenToAttach.indexOf(t);r>-1&&this._childrenToAttach.splice(r,1)}return t},t.prototype.requestChildRender=function(e){e&&e.parent===this&&this._renderPhase>=2&&this.requestRender()},t.prototype.setChildIndex=function(e,t){var r=this.getChildIndex(e);r>-1&&(this.children.splice(r,1),this.children.splice(t,0,e),this._renderPhase>=2&&this.requestRender())},t.prototype.sortChildren=function(e){return this._renderPhase>2&&this.requestRender(),this.children.sort(e)},t.prototype.attachChildren=function(){var e=this._childrenToAttach;if(0!==e.length)for(var t=0,r=!1;!r;){var n=e[t];n.parent=this,n.stage=this.stage,this.attachChild(n)?(n.attached=!0,e.splice(t,1)):++t,r=e.length===t}},t.prototype.renderChildren=function(e){for(var t=this.children,r=t.length,n=0;n<r;n++)t[n].processRender(e)},t.prototype.attachChild=function(e){return e.attach()},t.prototype.detachChild=function(e){e.detach()},t}(n.DisplayObject);t.Container=i}.apply(null,n))||(e.exports=i)},1512:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(21),r(0),r(1504)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attached=!1,t.lastUpdateId=-1,t.moving=!1,t.updateRequested=!1,t}return r(t,e),t.prototype.initialize=function(){var e=this;this.when(function(){e.requestUpdate()});var t=function(){return e.notifyChange("rendering")};this.handles.add([i.init(this,"suspended",function(t){e.container&&(e.container.visible=!t),e.view&&!t&&e.updateRequested&&e.view.requestLayerViewUpdate(e)},!0),i.init(this,"fullOpacity",function(t){e.container&&(e.container.opacity=t)},!0),i.on(this,"container","post-render",t),i.on(this,"container","will-render",t)])},t.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach()),this.handles.remove("initialize"),this.updateRequested=!1,this.layer=null},Object.defineProperty(t.prototype,"rendering",{get:function(){return this.attached&&!this.suspended&&(this.moving||this.container.renderRequested||this.isRendering())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0}),t.prototype.isVisibleAtScale=function(e){var t=!0,r=this.layer,n=r.minScale,i=r.maxScale;if(null!=n&&null!=i){var o=!n,a=!i;!o&&e<=n&&(o=!0),!a&&e>=i&&(a=!0),t=o&&a}return t},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))},t.prototype.processUpdate=function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1},t.prototype.isUpdating=function(){return!1},t.prototype.isRendering=function(){return!1},t.prototype.canResume=function(){var e=this.inherited(arguments);return e&&(e=this.isVisibleAtScale(this.view.scale)),e},n([o.property()],t.prototype,"attached",void 0),n([o.property()],t.prototype,"container",void 0),n([o.property()],t.prototype,"moving",void 0),n([o.property({dependsOn:["attached","suspended","moving"]})],t.prototype,"rendering",null),n([o.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),n([o.property({readOnly:!0})],t.prototype,"updateParameters",void 0),n([o.property()],t.prototype,"updateRequested",void 0),n([o.property({dependsOn:["updateRequested","attached"]})],t.prototype,"updating",null),n([o.property()],t.prototype,"view",void 0),n([o.subclass("esri.views.2d.layers.LayerView2D")],t)}(o.declared(a))}.apply(null,n))||(e.exports=i)},1524:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(5),r(352)],void 0===(i=function(e,t,r,n){function i(e,t){e.delete(t)}var o=new n(0,0,0,0),a=new Map,s=[],u=[];return function(){function e(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,this.resampling=null==e.resampling||!!e.resampling,e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),null!=e.buffer&&(this.buffer=e.buffer)}return e.prototype.destroy=function(){this.tileIndex.clear()},e.prototype.update=function(e){var t=this,r=this.resampling,n=this.tileIndex,l=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.coveragePolicy);if(u.length=0,s.length=0,a.clear(),l){var c=this.tileInfoView.tileInfo,p=c.minScale,d=c.maxScale,f=l.spans,h=l.lodInfo,y=h.level,g=e.state.scale,v=!e.stationary&&g>this._previousScale;if(this._previousScale=g,this.tiles.length=0,!r&&(g>p||g<d))return this.tiles.length=0,a.clear(),n.forEach(function(e){t.releaseTile(e)}),n.clear(),u.length=0,s.length=0,a.clear(),!0;n.forEach(function(e){return e.visible=!0});var m=0,b=0;if(f.length>0)for(var _=0,w=f;_<w.length;_++)for(var E=w[_],F=E.row,I=E.colFrom,x=E.colTo,R=I;R<=x;R++){m++;var O=o.set(y,F,h.normalizeCol(R),h.getWorldForColumn(R)).id;if(n.has(O)){(S=n.get(O)).isReady?(a.set(O,S),b++):v||this._addParentTile(O,a)}else{var S=this.acquireTile(o);this.tileIndex.set(O,S),v||this._addParentTile(O,a)}}var C=b===m;n.forEach(function(e,r){if(o.set(r),!a.has(r)){var n=t.tileInfoView.intersects(l,o);if(!n||!v&&C)if("purge"===t.cachePolicy){!(o.level!==y)&&n||s.push(r)}else(o.level>y||!n)&&s.push(r);else e.isReady?u.push(r):o.level>y&&s.push(r)}});for(var T=0,P=u;T<P.length;T++){O=P[T];(S=n.get(O))&&S.isReady&&a.set(O,S)}for(var A=0,q=s;A<q.length;A++){O=q[A],S=n.get(O);this.releaseTile(S),i(n,O)}return a.forEach(function(e){return t.tiles.push(e)}),n.forEach(function(e){a.has(e.key.id)||(e.visible=!1)}),C}},e.prototype.clear=function(){var e=this,t=this.tileIndex;t.forEach(function(t){e.releaseTile(t)}),t.clear()},e.prototype._addParentTile=function(e,t){for(var r=e,n=null;r=this.tileInfoView.getTileParentId(r);)if(this.tileIndex.has(r)&&(n=this.tileIndex.get(r))&&n.isReady){t.has(n.key.id)||t.set(n.key.id,n);break}},e}()}.apply(null,n))||(e.exports=i)},1525:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):t&&t.yoffset?Math.max(e,Math.abs(t.yoffset)):e}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateTolerance=function(e){if(!e)return 6;if("simple"===e.type)return r(6,e.symbol);if("unique-value"===e.type){var t=6;return e.uniqueValueInfos.forEach(function(e){t=r(t,e.symbol)}),t}if("class-breaks"===e.type){var n=6;return e.classBreakInfos.forEach(function(e){n=r(n,e.symbol)}),n}return e.type,6}}.apply(null,n))||(e.exports=i)},1526:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(22),r(25),r(154),r(32),r(127)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.getRequiredFields=function(e,t){return void 0===t&&(t=e.popupTemplate),n(this,void 0,void 0,function(){var n,s,u,l,c,p,d,f,h,y,g;return r(this,function(r){switch(r.label){case 0:return o.isSome(t)?[4,t.getRequiredFields(e.fields)]:[2,[]];case 1:return n=r.sent(),s=t.lastEditInfoEnabled,u=e.objectIdField,l=e.typeIdField,i.includes(n,"*")?[2,["*"]]:(p=a.fixFields,d=[e.fields],h=(f=n).concat,y=[[l]],(g=s)?[4,a.getFeatureEditFields(e)]:[3,3]);case 2:g=r.sent(),r.label=3;case 3:return(c=p.apply(void 0,d.concat([h.apply(f,y.concat([g||null]))])))&&u&&a.hasField(e.fields,u)&&-1===c.indexOf(u)&&c.push(u),[2,c]}})})},t.getFetchPopupTemplate=function(e,t){return e.popupTemplate?e.popupTemplate:o.isSome(t)&&t.defaultPopupTemplateEnabled&&o.isSome(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}}.apply(null,n))||(e.exports=i)},1633:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(5),r(1),r(35)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.createQueryGeometry=function(e,t,r){var n=r.get("state.resolution"),o=t*("number"==typeof n?n:1),a=e.clone().offset(-o,-o),s=e.clone().offset(o,o),u=r.spatialReference;return new i({xmin:Math.min(a.x,s.x),ymin:Math.min(a.y,s.y),xmax:Math.max(a.x,s.x),ymax:Math.max(a.y,s.y),spatialReference:u})}}.apply(null,n))||(e.exports=i)},1649:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(11),r(22),r(25),r(13),r(9)],void 0===(i=function(e,t,n,i,o,a,s){function u(e){switch(e){case"on-demand":return s.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(4),r.e(5),r.e(44)]).then(function(){var t=[r(1790)];e.apply(null,t)}.bind(this)).catch(r.oe)});case"memory":return s.create(function(e){return Promise.all([r.e(0),r.e(4),r.e(48)]).then(function(){var t=[r(1791)];e.apply(null,t)}.bind(this)).catch(r.oe)});case"stream":return s.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(4),r.e(5),r.e(52)]).then(function(){var t=[r(1792)];e.apply(null,t)}.bind(this)).catch(r.oe)});default:return s.reject(new a("mapview-controller:bad-type","Unable to create controller for unknown type: "+e))}}Object.defineProperty(t,"__esModule",{value:!0}),t.getControllerConfiguration=function(e,t){var r=e.source,n=t&&t.toJSON();if("stream"===e.type){var i={type:"stream",purgeOptions:e.purgeOptions,filter:n,serviceFilter:function(e){if(!e)return null;var t={};return e.geometry&&(t.geometry=e.geometry.toJSON()),e.where&&(t.where=e.where),t}(e.filter),processing:null};return s.resolve(i)}if(!e.capabilities.operations.supportsQuery)return s.reject(new a("graphicscontroller:query-capability-required","Service requires query capabilities to be used as a feature layer",{layer:e}));if(function(e){return e&&"openPorts"in e}(r)){var o={type:"memory",filter:n,processing:"processing"in e&&e.processing&&e.processing.toWorker()||null};return s.resolve(o)}var u={type:"on-demand",gdbVersion:"gdbVersion"in e?e.gdbVersion:null,historicMoment:"historicMoment"in e&&e.historicMoment?e.historicMoment.getTime():null,processing:"processing"in e&&e.processing?e.processing.toWorker():null,filter:n};return s.resolve(u)},t.createController=function(e,t){return o(this,void 0,void 0,function(){var r,o,a,s,l;return i(this,function(i){switch(i.label){case 0:return[4,u(e.type)];case 1:return r=i.sent().default,o=t.serviceAndViewInfo,a=t.remoteClient,s=t.tileStore,[4,(l=new r(n({},o,{configuration:e,tileStore:s,remoteClient:a}))).setFilter({index:0,filter:e.filter})];case 2:return i.sent(),[2,l]}})})}}.apply(null,n))||(e.exports=i)},1654:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(2),r(6),r(10),r(32),r(0),r(556),r(1693),r(1695)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c){var p=o.getLogger("esri.views.layers.support.FeatureEffect");return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.filter=null,t.includedEffect=null,t.excludedEffect=null,t.excludedLabelsVisible=!1,t}var i;return n(t,e),i=t,Object.defineProperty(t.prototype,"insideEffect",{get:function(){return p.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead"),this.includedEffect},set:function(e){p.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead"),this.includedEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outsideEffect",{get:function(){return p.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead"),this.excludedEffect},set:function(e){p.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead"),this.excludedEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parsedIncludedEffect",{get:function(){return a.isSome(this.includedEffect)?"string"==typeof this.includedEffect?l.fromString(this.includedEffect):new c({from:l.fromString(this.includedEffect.from),to:l.fromString(this.includedEffect.to),duration:this.includedEffect.duration}):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parsedExcludedEffect",{get:function(){return a.isSome(this.excludedEffect)?"string"==typeof this.excludedEffect?l.fromString(this.excludedEffect):new c({from:l.fromString(this.excludedEffect.from),to:l.fromString(this.excludedEffect.to),duration:this.excludedEffect.duration}):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderingHash",{get:function(){return this.excludedLabelsVisible+"-"+this.includedEffect+"-"+this.excludedEffect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"done",{get:function(){return(!a.isSome(this.parsedIncludedEffect)||this.parsedIncludedEffect.done)&&(!a.isSome(this.parsedExcludedEffect)||this.parsedExcludedEffect.done)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new i({filter:this.filter&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})},r([s.property({type:u})],t.prototype,"filter",void 0),r([s.property({type:String})],t.prototype,"includedEffect",void 0),r([s.property({type:String})],t.prototype,"excludedEffect",void 0),r([s.property({type:Boolean})],t.prototype,"excludedLabelsVisible",void 0),r([s.property({dependsOn:["includedEffect"]})],t.prototype,"parsedIncludedEffect",null),r([s.property({dependsOn:["excludedEffect"]})],t.prototype,"parsedExcludedEffect",null),r([s.property({dependsOn:["includedEffect","excludedEffect"]})],t.prototype,"renderingHash",null),i=r([s.subclass("esri.views.layers.support.FeatureEffect")],t)}(s.declared(i))}.apply(null,n))||(e.exports=i)},1692:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(11),r(22),r(25),r(154),r(170),r(13),r(10),r(32),r(9),r(21),r(0),r(127),r(81),r(1508),r(1654),r(556),r(1526)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c,p,d,f,h,y,g,v,m,b,_){var w=c.getLogger("esri.views.layers.FeatureLayerView");return function(e){function t(t){var r=e.call(this,t)||this;return r.effect=null,r.filter=null,r.layer=null,r.requiredFields=null,r.view=null,r}return r(t,e),t.prototype.initialize=function(){var e=this;f.init(this,["layer.renderer","layer.labelingInfo","layer.elevationInfo.featureExpressionInfo","filter","effect"],function(){return e._updateRequiredFields()})},Object.defineProperty(t.prototype,"availableFields",{get:function(){var e=this,t=e.layer,r=e.layer.fields,n=e.requiredFields;return"outFields"in t&&t.outFields?y.fixFields(r,y.unpackFieldNames(r,t.outFields).concat(n)):y.fixFields(r,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maximumNumberOfFeatures",{get:function(){return 0},set:function(e){w.error("#maximumNumberOfFeatures=","Setting maximum number of features is not supported")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maximumNumberOfFeaturesExceeded",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.highlight=function(e,t){return void 0===t&&(t={}),this.inherited(arguments)},t.prototype.queryFeatures=function(e){return this.inherited(arguments)},t.prototype.queryObjectIds=function(e){return this.inherited(arguments)},t.prototype.queryFeatureCount=function(e){return this.inherited(arguments)},t.prototype.queryExtent=function(e){return this.inherited(arguments)},t.prototype._updateRequiredFields=function(){return a(this,void 0,void 0,function(){var e,t,r,n,i,a,l,c,p,f,h,g,v;return o(this,function(o){switch(o.label){case 0:return this.layer&&this.view?(e="3d"===this.view.type,r=(t=this).layer,n=t.layer,i=n.fields,a=n.objectIdField,l=n.renderer,c=new u.default,[4,d.eachAlways([l?l.collectRequiredFields(c,i):null,y.collectLabelingFields(c,r),e?y.collectElevationFields(c,r):null,this.filter?y.collectFilterFields(c,r,this.filter):null,this.effect?y.collectFilterFields(c,r,this.effect.filter):null])]):[2];case 1:for(p=o.sent(),f=0,h=p;f<h.length;f++)(g=h[f]).error&&w.error(g.error);return y.collectField(c,i,a),v=s.from(c).sort(),this._set("requiredFields",v),[2]}})})},t.prototype.validateFetchPopupFeatures=function(e){var t=this.layer;return this.layer.popupEnabled?_.getFetchPopupTemplate(this.layer,e)?void 0:new l("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:t}):new l("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:t})},t.prototype.fetchClientPopupFeatures=function(e){return a(this,void 0,void 0,function(){var t,r,n,i,a,s,u,l,c,f,h;return o(this,function(o){switch(o.label){case 0:return(t=p.isSome(e)?e.clientGraphics:null)&&0!==t.length?(r=[],n=[],i=this.layer,a=_.getFetchPopupTemplate(i,e),p.isSome(a)?(s=g.hasGeometryOperations(a),[4,this.createPopupQuery(e)]):[2,d.resolve([])]):[2,d.resolve([])];case 1:for(u=o.sent(),l=y.unpackFieldNames(i.fields,u.outFields),c=0,f=t;c<f.length;c++)h=f[c],s||!y.featureHasFields(l,h)?n.push(h):r.push(h);return 0===n.length?[2,d.resolve(r)]:(u.objectIds=n.map(function(e){return e.attributes[i.objectIdField]}),[2,i.queryFeatures(u).then(function(e){return r.concat(e.features)}).catch(function(){return n})])}})})},t.prototype.createPopupQuery=function(e){return a(this,void 0,void 0,function(){var t,r,n;return o(this,function(i){switch(i.label){case 0:return t=this.layer,(r=t.createQuery()).returnGeometry=!0,r.returnZ=!0,r.returnM=!0,n=r,[4,_.getRequiredFields(this.layer,_.getFetchPopupTemplate(this.layer,e))];case 1:return n.outFields=i.sent(),r.outSpatialReference=this.view.spatialReference,[2,r]}})})},n([h.property({readOnly:!0,dependsOn:["layer.outFields?","requiredFields"]})],t.prototype,"availableFields",null),n([h.property({type:m})],t.prototype,"effect",void 0),n([h.property({type:b})],t.prototype,"filter",void 0),n([h.property()],t.prototype,"layer",void 0),n([h.property({type:Number})],t.prototype,"maximumNumberOfFeatures",null),n([h.property({readOnly:!0,type:Boolean})],t.prototype,"maximumNumberOfFeaturesExceeded",null),n([h.property({readOnly:!0})],t.prototype,"requiredFields",void 0),n([h.property()],t.prototype,"view",void 0),n([h.subclass("esri.views.layers.FeatureLayerView")],t)}(h.declared(v))}.apply(null,n))||(e.exports=i)},1693:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(2),r(11),r(13),r(8),r(10),r(0),r(18),r(264),r(1694)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c,p){var d=s.getLogger("esri.views.layers.support.ParsedFeatureEffect"),f={grayscale:function(e){var t=1-e.amount,r=c.mat4f32.fromValues(.2126+.7874*t,.7152-.7152*t,.0722-.0722*t,0,.2126-.2126*t,.7152+.2848*t,.0722-.0722*t,0,.2126-.2126*t,.7152-.7152*t,.0722+.9278*t,0,0,0,0,1);return l.mat4.transpose(r,r)},sepia:function(e){var t=1-e.amount,r=c.mat4f32.fromValues(.393+.607*t,.769-.769*t,.189-.189*t,0,.349-.349*t,.686+.314*t,.168-.168*t,0,.272-.272*t,.534-.534*t,.131+.869*t,0,0,0,0,1);return l.mat4.transpose(r,r)},saturate:function(e){var t=e.amount,r=c.mat4f32.fromValues(.213+.787*t,.715-.715*t,.072-.072*t,0,.213-.213*t,.715+.285*t,.072-.072*t,0,.213-.213*t,.715-.715*t,.072+.928*t,0,0,0,0,1);return l.mat4.transpose(r,r)},"hue-rotate":function(e){var t=Math.sin(e.angle*Math.PI/180),r=Math.cos(e.angle*Math.PI/180),n=c.mat4f32.fromValues(.213+.787*r-.213*t,.715-.715*r-.715*t,.072-.072*r+.928*t,0,.213-.213*r+.143*t,.715+.285*r+.14*t,.072-.072*r-.283*t,0,.213-.213*r-.787*t,.715-.715*r+.715*t,.072+.928*r+.072*t,0,0,0,0,1);return l.mat4.transpose(n,n)},invert:function(e){var t=e.amount,r=c.mat4f32.fromValues(-t,0,0,1,0,-t,0,1,0,0,-t,1,0,0,0,1);return l.mat4.transpose(r,r)},opacity:function(e){var t=e.amount,r=c.mat4f32.fromValues(t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,t);return l.mat4.transpose(r,r)},brightness:function(e){var t=e.amount,r=c.mat4f32.fromValues(t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1);return l.mat4.transpose(r,r)},contrast:function(e){var t=e.amount,r=c.mat4f32.fromValues(t,0,0,.5-.5*t,0,t,0,.5-.5*t,0,0,t,.5-.5*t,0,0,0,1);return l.mat4.transpose(r,r)}};return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.customTransforms=null,t.done=!0,t}var a;return n(t,e),a=t,t.fromString=function(e){var t;try{t=p.parse(e)}catch(e){d.error(new o("invalid-type","Encountered an error when parsing css",e))}return new a({transforms:t})},t.prototype.getColorMatrix=function(){var e=this;return(this.transforms||[]).map(function(e){return i({},e)}).reverse().reduce(function(t,r){return l.mat4.multiply(t,t,e._getFactory(r)(r))},c.mat4f32.create())},t.prototype.clone=function(){return new a({transforms:this.transforms&&this.transforms.map(function(e){return i({},e)}),customTransforms:this.customTransforms&&this.customTransforms.map(function(e){return i({},e)})})},t.prototype._getFactory=function(e){var t=f[e.type];if(!t){if(this.customTransforms)for(var r=0,n=this.customTransforms;r<n.length;r++){var i=function(t){if(t.type===e.type){var r=c.mat4f32.fromValues.apply(c.mat4f32,t.matrix),n=l.mat4.transpose(r,r);return{value:function(e){return n}}}}(n[r]);if("object"==typeof i)return i.value}return d.error("invalid-type","No effect "+e.type+" exists"),function(e){return c.mat4f32.create()}}return t},r([u.property()],t.prototype,"transforms",void 0),r([u.property()],t.prototype,"customTransforms",void 0),a=r([u.subclass("esri.views.layers.support.ParsedFeatureEffect")],t)}(u.declared(a))}.apply(null,n))||(e.exports=i)},1694:function(e,t,r){var n;void 0===(n=function(){"use strict";function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function o(e){return a[e.type](e)}var a={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};return"Expected "+function(e){var t,r,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=o(e[t]);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+(t?'"'+n(t)+'"':"end of input")+" found."},{SyntaxError:e,parse:function(t,r){function n(){return t.substring(Dt,Mt)}function i(e,t){return{type:"literal",text:e,ignoreCase:t}}function o(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function a(e){return{type:"other",description:e}}function s(e){var r,n=Gt[e];if(n)return n;for(r=e-1;!Gt[r];)r--;for(n={line:(n=Gt[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Gt[e]=n,n}function u(e,t){var r=s(e),n=s(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function l(e){Mt<Ht||(Mt>Ht&&(Ht=Mt,Jt=[]),Jt.push(e))}function c(t,r){return new e(t,null,null,r)}function p(){var e;return(e=function(){var e,r,n;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,4)===R?(n=R,Mt+=4):(n=E,0===Bt&&l(O)),n!==E&&_()!==E?(Dt=e,r=S(),e=r):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(x)),e}())===E&&(e=function(){var e,t;if(e=[],(t=d())!==E)for(;t!==E;)e.push(t),t=d();else e=E;return e}()),e}function d(){var e;return(e=function(){var e,r,n,i,o;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,5)===T?(n=T,Mt+=5):(n=E,0===Bt&&l(P)),n!==E&&_()!==E&&(i=v())!==E&&_()!==E?(41===t.charCodeAt(Mt)?(o=A,Mt++):(o=E,0===Bt&&l(q)),o!==E&&_()!==E?(Dt=e,r=j(i),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(C)),e}())===E&&(e=function(){var e,r,n,i,o;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,11)===k?(n=k,Mt+=11):(n=E,0===Bt&&l(N)),n!==E&&_()!==E&&(i=f())!==E&&_()!==E?(41===t.charCodeAt(Mt)?(o=A,Mt++):(o=E,0===Bt&&l(q)),o!==E&&_()!==E?(Dt=e,r=U(i),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(L)),e}())===E&&(e=function(){var e,r,n,i,o;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,9)===M?(n=M,Mt+=9):(n=E,0===Bt&&l(D)),n!==E&&_()!==E&&(i=f())!==E&&_()!==E?(41===t.charCodeAt(Mt)?(o=A,Mt++):(o=E,0===Bt&&l(q)),o!==E&&_()!==E?(Dt=e,r=G(i),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(V)),e}())===E&&(e=function(){var e,r,n,i,o,a,s,u;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,12)===J?(n=J,Mt+=12):(n=E,0===Bt&&l(B)),n!==E&&_()!==E&&(i=v())!==E&&_()!==E&&(o=v())!==E&&_()!==E?((a=v())===E&&(a=null),a!==E&&_()!==E?((s=function(){var e,r,n,i,o,a,s,u,c,p,d,g,v,m,w;return e=Mt,35===t.charCodeAt(Mt)?(r=vt,Mt++):(r=E,0===Bt&&l(mt)),r!==E?(n=Mt,(i=b())!==E&&(o=b())!==E?n=i=[i,o]:(Mt=n,n=E),n!==E?(i=Mt,(o=b())!==E&&(a=b())!==E?i=o=[o,a]:(Mt=i,i=E),i!==E?(o=Mt,(a=b())!==E&&(s=b())!==E?o=a=[a,s]:(Mt=o,o=E),o!==E?(Dt=e,r=bt(n,i,o),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),e===E&&(e=Mt,35===t.charCodeAt(Mt)?(r=vt,Mt++):(r=E,0===Bt&&l(mt)),r!==E&&(n=b())!==E&&(i=b())!==E&&(o=b())!==E?(Dt=e,r=_t(n,i,o),e=r):(Mt=e,e=E),e===E&&(e=Mt,t.substr(Mt,5)===wt?(r=wt,Mt+=5):(r=E,0===Bt&&l(Et)),r!==E&&(n=_())!==E&&(i=y())!==E&&(o=_())!==E?(44===t.charCodeAt(Mt)?(a=Ft,Mt++):(a=E,0===Bt&&l(It)),a!==E&&(s=_())!==E&&(u=y())!==E&&_()!==E?(44===t.charCodeAt(Mt)?(c=Ft,Mt++):(c=E,0===Bt&&l(It)),c!==E&&_()!==E&&(p=y())!==E&&(d=_())!==E?(44===t.charCodeAt(Mt)?(g=Ft,Mt++):(g=E,0===Bt&&l(It)),g!==E&&(v=_())!==E&&(m=f())!==E&&_()!==E?(41===t.charCodeAt(Mt)?(w=A,Mt++):(w=E,0===Bt&&l(q)),w!==E?(Dt=e,r=xt(i,u,p,m),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),e===E&&(e=Mt,t.substr(Mt,5)===wt?(r=wt,Mt+=5):(r=E,0===Bt&&l(Et)),r!==E&&(n=_())!==E&&(i=h())!==E&&(o=_())!==E?(44===t.charCodeAt(Mt)?(a=Ft,Mt++):(a=E,0===Bt&&l(It)),a!==E&&(s=_())!==E&&(u=h())!==E&&_()!==E?(44===t.charCodeAt(Mt)?(c=Ft,Mt++):(c=E,0===Bt&&l(It)),c!==E&&_()!==E&&(p=h())!==E?(44===t.charCodeAt(Mt)?(d=Ft,Mt++):(d=E,0===Bt&&l(It)),d!==E&&(g=_())!==E&&(v=f())!==E?(41===t.charCodeAt(Mt)?(m=A,Mt++):(m=E,0===Bt&&l(q)),m!==E?(Dt=e,r=Rt(i,u,p,v),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),e===E&&(e=Mt,t.substr(Mt,5)===wt?(r=wt,Mt+=5):(r=E,0===Bt&&l(Et)),r!==E&&(n=_())!==E&&(i=y())!==E&&(o=_())!==E?(44===t.charCodeAt(Mt)?(a=Ft,Mt++):(a=E,0===Bt&&l(It)),a!==E&&(s=_())!==E&&(u=y())!==E&&_()!==E?(44===t.charCodeAt(Mt)?(c=Ft,Mt++):(c=E,0===Bt&&l(It)),c!==E&&_()!==E&&(p=y())!==E&&(d=_())!==E?(41===t.charCodeAt(Mt)?(g=A,Mt++):(g=E,0===Bt&&l(q)),g!==E?(Dt=e,r=Ot(i,u,p),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),e===E&&(e=Mt,t.substr(Mt,5)===wt?(r=wt,Mt+=5):(r=E,0===Bt&&l(Et)),r!==E&&(n=_())!==E&&(i=h())!==E&&(o=_())!==E?(44===t.charCodeAt(Mt)?(a=Ft,Mt++):(a=E,0===Bt&&l(It)),a!==E&&(s=_())!==E&&(u=h())!==E&&_()!==E?(44===t.charCodeAt(Mt)?(c=Ft,Mt++):(c=E,0===Bt&&l(It)),c!==E&&_()!==E&&(p=h())!==E?(41===t.charCodeAt(Mt)?(d=A,Mt++):(d=E,0===Bt&&l(q)),d!==E?(Dt=e,r=St(i,u,p),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),e===E&&(e=Mt,t.substr(Mt,4)===Ct?(r=Ct,Mt+=4):(r=E,0===Bt&&l(Tt)),r!==E&&(n=_())!==E&&(i=y())!==E&&(o=_())!==E?(44===t.charCodeAt(Mt)?(a=Ft,Mt++):(a=E,0===Bt&&l(It)),a!==E&&(s=_())!==E&&(u=y())!==E&&_()!==E?(44===t.charCodeAt(Mt)?(c=Ft,Mt++):(c=E,0===Bt&&l(It)),c!==E&&_()!==E&&(p=y())!==E&&(d=_())!==E?(41===t.charCodeAt(Mt)?(g=A,Mt++):(g=E,0===Bt&&l(q)),g!==E?(Dt=e,r=Ot(i,u,p),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),e===E&&(e=Mt,t.substr(Mt,4)===Ct?(r=Ct,Mt+=4):(r=E,0===Bt&&l(Tt)),r!==E&&(n=_())!==E&&(i=h())!==E&&(o=_())!==E?(44===t.charCodeAt(Mt)?(a=Ft,Mt++):(a=E,0===Bt&&l(It)),a!==E&&(s=_())!==E&&(u=h())!==E&&_()!==E?(44===t.charCodeAt(Mt)?(c=Ft,Mt++):(c=E,0===Bt&&l(It)),c!==E&&_()!==E&&(p=h())!==E&&(d=_())!==E?(41===t.charCodeAt(Mt)?(g=A,Mt++):(g=E,0===Bt&&l(q)),g!==E?(Dt=e,r=St(i,u,p),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),e===E&&(e=function(){var e,r,n;if(Bt++,e=Mt,r=[],Nt.test(t.charAt(Mt))?(n=t.charAt(Mt),Mt++):(n=E,0===Bt&&l(Ut)),n!==E)for(;n!==E;)r.push(n),Nt.test(t.charAt(Mt))?(n=t.charAt(Mt),Mt++):(n=E,0===Bt&&l(Ut));else r=E;return r!==E&&(Dt=e,r=Vt()),Bt--,(e=r)===E&&(r=E,0===Bt&&l(kt)),e}())))))))),e}())===E&&(s=null),s!==E&&_()!==E?(41===t.charCodeAt(Mt)?(u=A,Mt++):(u=E,0===Bt&&l(q)),u!==E&&_()!==E?(Dt=e,r=X(i,o,a,s),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(H)),e}())===E&&(e=function(){var e,r,n,i,o;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,10)===Y?(n=Y,Mt+=10):(n=E,0===Bt&&l(Z)),n!==E&&_()!==E&&(i=f())!==E&&_()!==E?(41===t.charCodeAt(Mt)?(o=A,Mt++):(o=E,0===Bt&&l(q)),o!==E&&_()!==E?(Dt=e,r=z(i),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(Q)),e}())===E&&(e=function(){var e,r,n,i,o;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,11)===K?(n=K,Mt+=11):(n=E,0===Bt&&l($)),n!==E&&_()!==E&&(i=function(){var e,r,n;return Bt++,e=Mt,(r=function(){var e,r;return Bt++,e=Mt,Oe.test(t.charAt(Mt))?(r=t.charAt(Mt),Mt++):(r=E,0===Bt&&l(Se)),r===E&&(r=null),r!==E&&h()!==E?(Dt=e,r=xe(),e=r):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(Re)),e}())!==E&&(n=g())!==E?(Dt=e,r=qe(r,n),e=r):(Mt=e,e=E),e===E&&(e=Mt,48===t.charCodeAt(Mt)?(r=je,Mt++):(r=E,0===Bt&&l(Le)),r!==E?((n=g())===E&&(n=null),n!==E?(Dt=e,r=ke(),e=r):(Mt=e,e=E)):(Mt=e,e=E)),Bt--,e===E&&(r=E,0===Bt&&l(Ae)),e}())!==E&&_()!==E?(41===t.charCodeAt(Mt)?(o=A,Mt++):(o=E,0===Bt&&l(q)),o!==E&&_()!==E?(Dt=e,r=ee(i),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(W)),e}())===E&&(e=function(){var e,r,n,i,o;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,7)===re?(n=re,Mt+=7):(n=E,0===Bt&&l(ne)),n!==E&&_()!==E&&(i=f())!==E&&_()!==E?(41===t.charCodeAt(Mt)?(o=A,Mt++):(o=E,0===Bt&&l(q)),o!==E&&_()!==E?(Dt=e,r=ie(i),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(te)),e}())===E&&(e=function(){var e,r,n,i,o;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,8)===ae?(n=ae,Mt+=8):(n=E,0===Bt&&l(se)),n!==E&&_()!==E&&(i=f())!==E&&_()!==E?(41===t.charCodeAt(Mt)?(o=A,Mt++):(o=E,0===Bt&&l(q)),o!==E&&_()!==E?(Dt=e,r=ue(i),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(oe)),e}())===E&&(e=function(){var e,r,n,i,o;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,9)===ce?(n=ce,Mt+=9):(n=E,0===Bt&&l(pe)),n!==E&&_()!==E&&(i=f())!==E&&_()!==E?(41===t.charCodeAt(Mt)?(o=A,Mt++):(o=E,0===Bt&&l(q)),o!==E&&_()!==E?(Dt=e,r=de(i),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(le)),e}())===E&&(e=function(){var e,r,n,i,o;return Bt++,e=Mt,(r=_())!==E?(t.substr(Mt,6)===he?(n=he,Mt+=6):(n=E,0===Bt&&l(ye)),n!==E&&_()!==E&&(i=f())!==E&&_()!==E?(41===t.charCodeAt(Mt)?(o=A,Mt++):(o=E,0===Bt&&l(q)),o!==E&&_()!==E?(Dt=e,r=ge(i),e=r):(Mt=e,e=E)):(Mt=e,e=E)):(Mt=e,e=E),Bt--,e===E&&(r=E,0===Bt&&l(fe)),e}()),e}function f(){var e;return Bt++,(e=y())===E&&(e=h()),Bt--,e===E&&0===Bt&&l(ve),e}function h(){var e,r,n,i,o;if(Bt++,e=Mt,r=[],be.test(t.charAt(Mt))?(n=t.charAt(Mt),Mt++):(n=E,0===Bt&&l(_e)),n!==E)for(;n!==E;)r.push(n),be.test(t.charAt(Mt))?(n=t.charAt(Mt),Mt++):(n=E,0===Bt&&l(_e));else r=E;if(r!==E)if(46===t.charCodeAt(Mt)?(n=Fe,Mt++):(n=E,0===Bt&&l(Ie)),n!==E){if(i=[],be.test(t.charAt(Mt))?(o=t.charAt(Mt),Mt++):(o=E,0===Bt&&l(_e)),o!==E)for(;o!==E;)i.push(o),be.test(t.charAt(Mt))?(o=t.charAt(Mt),Mt++):(o=E,0===Bt&&l(_e));else i=E;i!==E?(Dt=e,e=r=xe()):(Mt=e,e=E)}else Mt=e,e=E;else Mt=e,e=E;return e===E&&(e=function(){var e,r,n;if(Bt++,e=Mt,r=[],be.test(t.charAt(Mt))?(n=t.charAt(Mt),Mt++):(n=E,0===Bt&&l(_e)),n!==E)for(;n!==E;)r.push(n),be.test(t.charAt(Mt))?(n=t.charAt(Mt),Mt++):(n=E,0===Bt&&l(_e));else r=E;return r!==E&&(Dt=e,r=we()),Bt--,(e=r)===E&&(r=E,0===Bt&&l(me)),e}()),Bt--,e===E&&(r=E,0===Bt&&l(Ee)),e}function y(){var e,r,n;return e=Mt,(r=h())!==E?(37===t.charCodeAt(Mt)?(n=Ce,Mt++):(n=E,0===Bt&&l(Te)),n!==E?(Dt=e,e=r=Pe(r)):(Mt=e,e=E)):(Mt=e,e=E),e}function g(){var e,r;return Bt++,e=Mt,t.substr(Mt,3)===Ue?(r=Ue,Mt+=3):(r=E,0===Bt&&l(Ve)),r!==E&&(Dt=e,r=Me()),(e=r)===E&&(e=Mt,t.substr(Mt,4)===De?(r=De,Mt+=4):(r=E,0===Bt&&l(Ge)),r!==E&&(Dt=e,r=He()),(e=r)===E&&(e=Mt,t.substr(Mt,3)===Je?(r=Je,Mt+=3):(r=E,0===Bt&&l(Be)),r!==E&&(Dt=e,r=Xe()),(e=r)===E&&(e=Mt,t.substr(Mt,4)===Qe?(r=Qe,Mt+=4):(r=E,0===Bt&&l(Ye)),r!==E&&(Dt=e,r=Ze()),e=r))),Bt--,e===E&&(r=E,0===Bt&&l(Ne)),e}function v(){var e,r,n;return Bt++,e=Mt,(r=h())!==E&&(n=m())!==E?(Dt=e,e=r=qe(r,n)):(Mt=e,e=E),e===E&&(e=Mt,48===t.charCodeAt(Mt)?(r=je,Mt++):(r=E,0===Bt&&l(Le)),r!==E?((n=m())===E&&(n=null),n!==E?(Dt=e,e=r=ke()):(Mt=e,e=E)):(Mt=e,e=E)),Bt--,e===E&&(r=E,0===Bt&&l(ze)),e}function m(){var e,r;return e=Mt,t.substr(Mt,2)===We?(r=We,Mt+=2):(r=E,0===Bt&&l(Ke)),r!==E&&(Dt=e,r=Me()),(e=r)===E&&(e=Mt,t.substr(Mt,2)===$e?(r=$e,Mt+=2):(r=E,0===Bt&&l(et)),r!==E&&(Dt=e,r=tt()),(e=r)===E&&(e=Mt,t.substr(Mt,2)===rt?(r=rt,Mt+=2):(r=E,0===Bt&&l(nt)),r!==E&&(Dt=e,r=it()),(e=r)===E&&(e=Mt,81===t.charCodeAt(Mt)?(r=ot,Mt++):(r=E,0===Bt&&l(at)),r!==E&&(Dt=e,r=st()),(e=r)===E&&(e=Mt,t.substr(Mt,2)===ut?(r=ut,Mt+=2):(r=E,0===Bt&&l(lt)),r!==E&&(Dt=e,r=ct()),(e=r)===E&&(e=Mt,t.substr(Mt,2)===pt?(r=pt,Mt+=2):(r=E,0===Bt&&l(dt)),r!==E&&(Dt=e,r=ft()),(e=r)===E&&(e=Mt,t.substr(Mt,2)===ht?(r=ht,Mt+=2):(r=E,0===Bt&&l(yt)),r!==E&&(Dt=e,r=gt()),e=r)))))),e}function b(){var e;return Pt.test(t.charAt(Mt))?(e=t.charAt(Mt),Mt++):(e=E,0===Bt&&l(At)),e}function _(){var e,r;for(Bt++,e=[],jt.test(t.charAt(Mt))?(r=t.charAt(Mt),Mt++):(r=E,0===Bt&&l(Lt));r!==E;)e.push(r),jt.test(t.charAt(Mt))?(r=t.charAt(Mt),Mt++):(r=E,0===Bt&&l(Lt));return Bt--,e===E&&(r=E,0===Bt&&l(qt)),e}r=void 0!==r?r:{};var w,E={},F={start:p},I=p,x=a("none"),R="none",O=i("none",!1),S=function(){return null},C=a("blur()"),T="blur(",P=i("blur(",!1),A=")",q=i(")",!1),j=function(e){return{type:"blur",radius:e}},L=a("brightness()"),k="brightness(",N=i("brightness(",!1),U=function(e){return{type:"brightness",amount:e}},V=a("contrast()"),M="contrast(",D=i("contrast(",!1),G=function(e){return{type:"contrast",amount:e}},H=a("drop-shadow()"),J="drop-shadow(",B=i("drop-shadow(",!1),X=function(e,t,r,n){return{type:"drop-shadow",offsetX:e,offsetY:t,blurRadius:r,color:n}},Q=a("grayscale()"),Y="grayscale(",Z=i("grayscale(",!1),z=function(e){return{type:"grayscale",amount:e}},W=a("hue-rotate()"),K="hue-rotate(",$=i("hue-rotate(",!1),ee=function(e){return{type:"hue-rotate",angle:e}},te=a("invert()"),re="invert(",ne=i("invert(",!1),ie=function(e){return{type:"invert",amount:e}},oe=a("opacity()"),ae="opacity(",se=i("opacity(",!1),ue=function(e){return{type:"opacity",amount:e}},le=a("saturate()"),ce="saturate(",pe=i("saturate(",!1),de=function(e){return{type:"saturate",amount:e}},fe=a("sepia()"),he="sepia(",ye=i("sepia(",!1),ge=function(e){return{type:"sepia",amount:e}},ve=a("<number-percentage>"),me=a("<integer>"),be=/^[0-9]/,_e=o([["0","9"]],!1,!1),we=function(){return parseInt(n(),10)},Ee=a("<number>"),Fe=".",Ie=i(".",!1),xe=function(){return parseFloat(n())},Re=a("<signedNumber>"),Oe=/^[+\-]/,Se=o(["+","-"],!1,!1),Ce="%",Te=i("%",!1),Pe=function(e){return e/100},Ae=a("<angle>"),qe=function(e,t){return e*t},je="0",Le=i("0",!1),ke=function(){return 0},Ne=a("<unit>"),Ue="deg",Ve=i("deg",!1),Me=function(){return 1},De="grad",Ge=i("grad",!1),He=function(){return.9},Je="rad",Be=i("rad",!1),Xe=function(){return 180/Math.PI},Qe="turn",Ye=i("turn",!1),Ze=function(){return 1/360},ze=a("<length>"),We="px",Ke=i("px",!1),$e="cm",et=i("cm",!1),tt=function(){return 96/2.54},rt="mm",nt=i("mm",!1),it=function(){return 96/2.54/10},ot="Q",at=i("Q",!1),st=function(){return 96/2.54/40},ut="in",lt=i("in",!1),ct=function(){return 96},pt="pc",dt=i("pc",!1),ft=function(){return 16},ht="pt",yt=i("pt",!1),gt=function(){return 96/73},vt="#",mt=i("#",!1),bt=function(e,t,r){return[parseInt(e.join(""),16),parseInt(t.join(""),16),parseInt(r.join(""),16)]},_t=function(e,t,r){return[parseInt([e,e].join(""),16),parseInt([t,t].join(""),16),parseInt([r,r].join(""),16)]},wt="rgba(",Et=i("rgba(",!1),Ft=",",It=i(",",!1),xt=function(e,t,r,n){return[255*e,255*t,255*r,n]},Rt=function(e,t,r,n){return[e,t,r,n]},Ot=function(e,t,r){return[255*e,255*t,255*r,1]},St=function(e,t,r){return[e,t,r,1]},Ct="rgb(",Tt=i("rgb(",!1),Pt=/^[0-9a-fA-F]/,At=o([["0","9"],["a","f"],["A","F"]],!1,!1),qt=a("whitespace"),jt=/^[ \t\n\r]/,Lt=o([" ","\t","\n","\r"],!1,!1),kt=a("<named-color>"),Nt=/^[a-z]/,Ut=o([["a","z"]],!1,!1),Vt=function(){var e=n();return Qt.has(e)||function(e,t){throw c(e,t=void 0!==t?t:u(Dt,Mt))}('unknown color "'+e+'"'),Xt[e].concat(1)},Mt=0,Dt=0,Gt=[{line:1,column:1}],Ht=0,Jt=[],Bt=0;if("startRule"in r){if(!(r.startRule in F))throw new Error("Can't start parsing from rule \""+r.startRule+'".');I=F[r.startRule]}var Xt={transparent:[0,0,0,0],black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rebeccapurple:[102,51,153],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]},Qt=new Set(Object.keys(Xt));if((w=I())!==E&&Mt===t.length)return w;throw w!==E&&Mt<t.length&&l({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}(Jt,Ht<t.length?t.charAt(Ht):null,Ht<t.length?u(Ht,Ht+1):u(Ht,Ht))}}}.apply(null,[]))||(e.exports=n)},1695:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(2),r(6),r(0),r(18)],void 0===(i=function(e,t,r,n,i,o,a){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.from=null,t.to=null,t.duration=4e3,t.repeat=!0,t.done=!1,t}var i;return n(t,e),i=t,t.prototype.getColorMatrix=function(){if(this.done=!1,null==this._lastTime)this._currentStep=0,this._lastTime=Date.now();else{var e=this._lastTime,t=Date.now(),r=t-e;this._currentStep=this._currentStep+r,this._currentStep>=2147483647&&(this._currentStep=0),this._lastTime=t}var n=this._currentStep%this.duration/(this.duration/2),i=n<=1?n:2-n,o=this.from.getColorMatrix(),s=this.to.getColorMatrix();return a.mat4.multiplyScalar(o,o,1-i),a.mat4.multiplyScalar(s,s,i),!this.repeat&&this._currentStep>=this.duration&&(this.done=!0),a.mat4.add(o,o,s)},t.prototype.clone=function(){var e=new i({from:this.from.clone(),to:this.to.clone(),duration:this.duration});return e._lastTime=this._lastTime,e._currentStep=this._currentStep,e},r([o.property()],t.prototype,"from",void 0),r([o.property()],t.prototype,"to",void 0),r([o.property({type:Number})],t.prototype,"duration",void 0),r([o.property({type:Boolean})],t.prototype,"repeat",void 0),i=r([o.subclass("esri.views.layers.support.Transition")],t)}(o.declared(i))}.apply(null,n))||(e.exports=i)},1788:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(117),r(11),r(22),r(25),r(43),r(79),r(51),r(26),r(13),r(32),r(9),r(21),r(0),r(28),r(1525),r(1464),r(353),r(1510),r(1506),r(1512),r(1649),r(2216),r(2217),r(1633),r(1524),r(1692),r(556),r(1654)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c,p,d,f,h,y,g,v,m,b,_,w,E,F,I,x,R,O,S,C,T,P){var A=v.ensureType(_);return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._pipelineIsUpdating=!1,t._filterRequestsOutstanding=new Array(E.MAX_FILTERS),t._updatingFilter=!1,t._updatingRenderer=!1,t.container=new w.Container,t.filter=null,t.effect=null,t.highlightIDs=new Set,t}return r(t,e),t.prototype.destroy=function(){this._proxy.destroy()},t.prototype.initialize=function(){var e=this;if(this._proxy=this._createProxy(),this.layer.isTable)this.addResolvingPromise(h.reject(new d("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer})));else{this.addResolvingPromise(h.all([I.getControllerConfiguration(this.layer,this.filter),this._proxy.when()]).then(function(e){var t=e[0];return e[1].configure({controller:t})}));var t=this.watch("filter",function(){return e._handleFilterChange(0,e.filter)}),r=this.watch("effect",function(t,r){r&&t&&t.filter.enable(),e._handleFilterChange(1,t&&t.filter)});this.handles.add(t),this.handles.add(r)}},Object.defineProperty(t.prototype,"labelsVisible",{get:function(){return!this.suspended&&this.layer.labelingInfo&&this.layer.labelsVisible},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effects",{get:function(){return this.effect&&[this.effect]||[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numFeatures",{get:function(){var e=0;return this.attached&&this._tileStrategy.tiles.forEach(function(t){e+=t.iconDisplayRecords?t.iconDisplayRecords.length:0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderingConfigHash",{get:function(){if(!this.layer)return null;var e=this.availableFields,t=this.layer,r=t.definitionExpression,n=t.renderer,i=t.labelingInfo,o="historicMoment"in this.layer?this.layer.historicMoment:null;return JSON.stringify({effectHash:f.isSome(this.effect)&&this.effect.renderingHash,definitionExpression:r,historicMoment:o,availableFields:e,renderer:n,labelingInfo:i})},enumerable:!0,configurable:!0}),t.prototype.highlight=function(e,t){var r,n=this;return void 0===t&&(t={}),e instanceof l?r=[e.getAttribute(this.layer.objectIdField||"__OBJECTID")]:"number"==typeof e?r=[e]:p.isCollection(e)?r=e.map(function(e){return e&&e.getAttribute(n.layer.objectIdField)}).toArray():Array.isArray(e)&&e.length>0&&(r="number"==typeof e[0]?e:e.map(function(e){return e&&e.getAttribute(n.layer.objectIdField)})),(r=r.filter(function(e){return null!=e}))&&r.length&&this._addHighlight(r),{remove:function(){n._removeHighlight(r)},pause:function(){n._removeHighlight(r)},resume:function(){n._addHighlight(r)}}},t.prototype._addHighlight=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this.highlightIDs.add(n)}this._updateHighlight()},t.prototype._removeHighlight=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this.highlightIDs.delete(n)}this._updateHighlight()},t.prototype.hitTest=function(e,t){var r=this;return this.suspended||!this.tileRenderer?h.resolve(null):this.tileRenderer.hitTest(e,t).then(function(e){return 0===e.length?null:r._proxy.queryFeatures(new _({objectIds:e,outSpatialReference:r.view.spatialReference,returnGeometry:!0})).then(function(e){if(!e.features[0])return null;var t=l.fromJSON(e.features[0]);return t.layer=r.layer,t.sourceLayer=r.layer,t.geometry&&(t.geometry.spatialReference=r.view.spatialReference),t})})},t.prototype.queryFeatures=function(e){var t=this;return this.queryFeaturesJSON(e).then(function(e){var r=b.fromJSON(e);return r.features.forEach(function(e){e.layer=t.layer,e.sourceLayer=t.layer}),r})},t.prototype.queryFeaturesJSON=function(e){return this._proxy.queryFeatures(this._cleanUpQuery(e))},t.prototype.queryObjectIds=function(e){return this._proxy.queryObjectIds(this._cleanUpQuery(e))},t.prototype.queryFeatureCount=function(e){return this._proxy.queryFeatureCount(this._cleanUpQuery(e))},t.prototype.queryExtent=function(e){return this._proxy.queryExtent(this._cleanUpQuery(e)).then(function(e){return{count:e.count,extent:u.Extent.fromJSON(e.extent)}})},t.prototype.setVisibility=function(e,t){var r=t?[e]:[],n=t?[]:[e];this.tileRenderer.setFilterFlag(0,r,n,!0)},t.prototype.update=function(e){this.attached&&this._tileStrategy&&this.tileRenderer&&(this._tileStrategy.update(e)||this.requestUpdate(),this._proxy.setViewState(e.state),this.notifyChange("numFeatures"),this.notifyChange("updating"))},t.prototype.attach=function(){var e=this;this._tileStrategy=new S({cachePolicy:"purge",acquireTile:function(t){return e._acquireTile(t)},releaseTile:function(t){return e._releaseTile(t)},tileInfoView:this.view.featuresTilingScheme,buffer:0}),this.handles.add([y.watch(this,"layer.processing?.version",function(t){e._proxy.redraw()}),this.layer.on("edits",function(t){e._proxy.onEdits(t)}),y.init(this,"renderingConfigHash",function(){return e._renderingConfigHashChanged()})],"attach")},t.prototype.detach=function(){this.container.removeAllChildren(),this.handles.remove("attach"),this._tileRendererPromise=null,this._pipelineIsUpdating=!1,this.tileRenderer&&(this.tileRenderer.uninstall(this.container),this.tileRenderer=null),this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null)},t.prototype.moveStart=function(){this.requestUpdate()},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.moveEnd=function(){this.requestUpdate()},t.prototype.fetchPopupFeatures=function(e,t){return s(this,void 0,void 0,function(){var r,n,i;return a(this,function(o){return(r=this.validateFetchPopupFeatures(t))?[2,h.reject(r)]:(n=this.fetchClientPopupFeatures(t),e?(i=this._fetchServicePopupFeatures(e,t),[2,h.eachAlwaysValues([n,i]).then(c.flatten)]):[2,n])})})},t.prototype._fetchServicePopupFeatures=function(e,t){return s(this,void 0,void 0,function(){var r,n,i,o,s,u,l,c,p,d;return a(this,function(a){switch(a.label){case 0:return[4,this.createPopupQuery(t)];case 1:if(r=a.sent(),n=this.layer,i=n.renderer,o=m.calculateTolerance(i),r.geometry=this.createFetchPopupFeaturesQueryGeometry(e,o),s=new Set,u=n.objectIdField,l=f.isSome(t)?t.clientGraphics:null)for(c=0,p=l;c<p.length;c++)d=p[c],s.add(d.attributes[u]);return[2,n.queryFeatures(r).then(function(e){return e.features.filter(function(e){return!s.has(e.attributes[u])})})]}})})},t.prototype.createFetchPopupFeaturesQueryGeometry=function(e,t){return O.createQueryGeometry(e,t,this.view)},t.prototype.doRefresh=function(){this._proxy.refresh()},t.prototype.isUpdating=function(){return null!=this.layer.renderer&&(null==this.tileRenderer||this._pipelineIsUpdating||this.tileRenderer.updating||this._updatingFilter||this._updatingRenderer)},t.prototype._createClientOptions=function(){var e=this;return{executeProcessing:function(t){if(!("processing"in e.layer&&e.layer.processing))return t.featureSet;var r=e.layer.processing;return r.process(t.featureSet,r.options)||h.reject(new d("FeatureLayer","invalid processing.process() method, returns nothing"))},setUpdating:function(t){e._pipelineIsUpdating=t,e.notifyChange("updating")}}},t.prototype._cleanUpQuery=function(e){var t=e?A(e):new _;return t.outSpatialReference||(t.outSpatialReference=this.view.spatialReference),t},t.prototype._handleFilterChange=function(e,t){return s(this,void 0,void 0,function(){var r,n,i,o,s,u;return a(this,function(a){switch(a.label){case 0:return f.isSome(this._filterRequestsOutstanding[e])?(this._filterRequestsOutstanding[e]={filter:t},[2]):(this._updatingFilter=!0,r=f.isSome(t)&&t.toJSON(),[4,this._proxy.setFilter(e,r)]);case 1:for(n=a.sent(),i=n.show,o=n.hide,this.tileRenderer&&this.tileRenderer.setFilterFlag(e,i,o,!1),f.isSome(t)&&t.enable(),this.tileRenderer&&(this.tileRenderer.featuresView.requestRender(),!(!this.layer.labelingInfo||!this.layer.labelingInfo.length)&&(this.tileRenderer.forEachTile(function(e){return e.isDirty=!0}),this.view.labelManager.requestUpdate())),s=0;s<this._filterRequestsOutstanding.length;s++)if(u=this._filterRequestsOutstanding[s],f.isSome(u)){this._filterRequestsOutstanding[s]=null,this._handleFilterChange(s,u.filter);break}return this._updatingFilter=!1,[2]}})})},t.prototype._createProxy=function(){return new R.default({layer:this.layer,featuresTiling:this.view.featuresTilingScheme,client:this._createClientOptions()})},t.prototype._acquireTile=function(e){var t=this,r=this.tileRenderer.acquireTile(e);return r.once("attach",function(){t.requestUpdate()}),r},t.prototype._releaseTile=function(e){this.tileRenderer.releaseTile(e)},t.prototype._renderingConfigHashChanged=function(){var e=this;this._updatingRenderer=!0;var t=this._tileRendererPromise=x.createOrReuseTileRenderer(this.tileRenderer,this.layer.renderer,{layerView:this,tileInfoView:this.view.featuresTilingScheme,layer:this.layer}).then(function(r){if(e._tileRendererPromise===t){if(e._tileRendererPromise=null,e.tileRenderer!==r&&(e._tileStrategy.clear(),e.tileRenderer&&(e.tileRenderer.uninstall(e.container),e.tileRenderer.destroy()),e.tileRenderer=e._proxy.client.tileRenderer=r,r&&r.install(e.container),e._updateHighlight(),e.requestUpdate()),!r)return void(e._updatingRenderer=!1);var n=r.getProcessorConfiguration();e.tileRenderer.wouldClear(n)?(e.tileRenderer.clear(),e.tileRenderer.applyConfiguration(n),e._proxy.configure({processor:n}).then(function(){e._updatingRenderer=!1,e.notifyChange("updating")}),e.requestUpdate()):e.tileRenderer.needsProcessorReconfiguration(n)?(e._proxy.configure({processor:n}).then(function(){e._updatingRenderer=!1,e.notifyChange("updating")}),e.requestUpdate()):(e.tileRenderer.applyConfiguration(n),e.requestUpdate(),e._updatingRenderer=!1,e.notifyChange("updating"))}},function(){e._tileRendererPromise=null,e._updatingRenderer=!1,e.notifyChange("updating")})},t.prototype._updateHighlight=function(){this.tileRenderer&&"updateHighlight"in this.tileRenderer&&this.tileRenderer.updateHighlight()},n([g.property()],t.prototype,"_pipelineIsUpdating",void 0),n([g.property()],t.prototype,"_updatingFilter",void 0),n([g.property()],t.prototype,"_updatingRenderer",void 0),n([g.property({dependsOn:["suspended","layer.labelingInfo","layer.labelsVisible"]})],t.prototype,"labelsVisible",null),n([g.property({type:T})],t.prototype,"filter",void 0),n([g.property({type:P})],t.prototype,"effect",void 0),n([g.property({readOnly:!0,dependsOn:["effect"]})],t.prototype,"effects",null),n([g.property()],t.prototype,"numFeatures",null),n([g.property({dependsOn:["effect","layer.renderer","availableFields","layer.definitionExpression","layer.historicMoment?","layer.labelingInfo"]})],t.prototype,"renderingConfigHash",null),n([g.property()],t.prototype,"tileRenderer",void 0),n([g.property({dependsOn:["layer.renderer","tileRenderer.updating","_updatingFilter","_updatingRenderer"]})],t.prototype,"updating",void 0),n([g.subclass("esri.views.2d.layers.FeatureLayerView2D")],t)}(g.declared(F,C))}.apply(null,n))||(e.exports=i)},2216:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(273),r(9)],void 0===(i=function(e,t,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.createOrReuseTileRenderer=function(e,t,o){if(e&&e.supportsRenderer(t))return i.create(function(t){return n(function(){return t(e)})});if(!t)return i.resolve(null);switch(t.type){case"class-breaks":case"simple":case"unique-value":case"dot-density":return i.create(function(e){n(function(){return Promise.all([r.e(6),r.e(8),r.e(71)]).then(function(){var t=[r(2275)];e.apply(null,t)}.bind(this)).catch(r.oe)})}).then(function(e){return e.default}).then(function(e){return new e(o)});case"heatmap":return i.create(function(e){n(function(){return Promise.all([r.e(9),r.e(66)]).then(function(){var t=[r(2277)];e.apply(null,t)}.bind(this)).catch(r.oe)})}).then(function(e){return e.default}).then(function(e){return new e(o)})}return i.resolve(null)}}.apply(null,n))||(e.exports=i)},2217:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(11),r(6),r(209),r(9),r(356),r(355),r(0),r(2218),r.dj.m(e)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c,p,d){Object.defineProperty(t,"__esModule",{value:!0});var f=function(t){function i(e){var r=t.call(this,e)||this;return r.tileRenderer=null,r}return r(i,t),i.prototype.initialize=function(){var t=this;this.addResolvingPromise(l.open(u.getAbsMid("../features/Pipeline",e,d),{client:this.client,strategy:"dedicated"}).then(function(e){return t._connection=e,t._getStartupOptions(t.layer,t.featuresTiling)}).then(function(e){return function(e){return Array.isArray(e)}(e.service.source)?t._connection.invoke("startup",e,{transferList:e.service.source}):t._connection.invoke("startup",e)}))},i.prototype.destroy=function(){this._connection&&(this._connection.close(),this._connection=null)},i.prototype.configure=function(e){return this._connection.invoke("configure",e)},i.prototype.refresh=function(){return this._connection.invoke("controller.refresh")},i.prototype.redraw=function(){return this._connection.invoke("controller.redraw")},i.prototype.setViewState=function(e){return this._connection.invoke("setViewState",e.toJSON())},i.prototype.queryFeatures=function(e){return this._connection.invoke("controller.queryFeatures",e.toJSON())},i.prototype.queryObjectIds=function(e){return this._connection.invoke("controller.queryObjectIds",e.toJSON())},i.prototype.queryFeatureCount=function(e){return this._connection.invoke("controller.queryFeatureCount",e.toJSON())},i.prototype.queryExtent=function(e){return this._connection.invoke("controller.queryExtent",e.toJSON())},i.prototype.queryLatestObservations=function(e){return this._connection.invoke("controller.queryLatestObservations",e.toJSON())},i.prototype.onEdits=function(e){var t=e.addedFeatures,r=e.deletedFeatures,n=e.updatedFeatures;return this._connection.invoke("controller.onEdits",{addedFeatures:t,deletedFeatures:r,updatedFeatures:n})},i.prototype.enableEvent=function(e,t){return this._connection.invoke("controller.enableEvent",{name:e,value:t})},i.prototype.setFilter=function(e,t){return this._connection.invoke("controller.setFilter",{index:e,filter:t})},i.prototype._getStartupOptions=function(e,t){var r=e.capabilities,n=e.objectIdField,i=e.source,o=e.fields.map(function(e){return e.toJSON()}),a=e.fullExtent&&e.fullExtent.toJSON(),u=p.toJSONGeometryType(e.geometryType),l=e.timeInfo&&e.timeInfo.toJSON()||null;if(function(e){return e&&"openPorts"in e}(i))return i.openPorts().then(function(e){return{service:{capabilities:r,fields:o,fullExtent:a,geometryType:u,objectIdField:n,source:e,timeInfo:l},tileInfo:t.tileInfo.toJSON()}});if("stream"===e.type){var c=e.source,d=c.relatedLayerDefinition,f=c.archivedLayerDefinition,h=d&&{capabilities:d.capabilities,fields:d.fields,fullExtent:d.extent,geometryType:d.geometryType,objectIdField:d.objectIdField,source:c.layerDefinition.relatedFeatures.featuresUrl,joinField:c.layerDefinition.relatedFeatures.joinField}||null,y=f&&{capabilities:f.capabilities,fields:f.fields,fullExtent:f.extent,geometryType:f.geometryType,objectIdField:f.objectIdField,source:c.layerDefinition.keepLatestArchive.featuresUrl,maximumFeatureAge:c.layerDefinition.keepLatestArchive.maximumFeatureAge,updateInterval:c.layerDefinition.keepLatestArchive.updateInterval}||null;return s.resolve({service:{capabilities:e.capabilities,fields:e.fields.map(function(e){return e.toJSON()}),fullExtent:a||null,geometryType:p.toJSONGeometryType(e.geometryType),objectIdField:e.objectIdField||"__OBJECTID",source:e.parsedUrl.path,buddyLayers:{relatedFeatures:h,keepLatestArchive:y},streamUrls:c.layerDefinition.streamUrls,timeInfo:l,content:e.parsedUrl.query},tileInfo:t.tileInfo.toJSON()})}return s.resolve({service:{capabilities:r,fields:o,fullExtent:a,geometryType:u,objectIdField:n,source:"dynamicDataSource"in e?e.dynamicDataSource?e.parsedUrl:e.url+"/"+e.layerId:e.parsedUrl,timeInfo:l},tileInfo:t.tileInfo.toJSON()})},n([c.property({constructOnly:!0})],i.prototype,"client",void 0),n([c.property({constructOnly:!0})],i.prototype,"layer",void 0),n([c.property({constructOnly:!0})],i.prototype,"featuresTiling",void 0),n([c.property()],i.prototype,"tileRenderer",void 0),n([c.subclass()],i)}(c.declared(o,a));t.default=f}.apply(null,n))||(e.exports=i)},2218:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(24)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=new r.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});t.toJSONGeometryType=function(e){return n.toJSON(e)}}.apply(null,n))||(e.exports=i)}}]);