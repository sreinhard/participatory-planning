(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/FeatureLayer":556,"esri/tasks/support/FeatureSet":1406,"esri/tasks/operations/PBFWorker":1407,"esri/tasks/operations/query":1408,"esri/geometry/support/normalizeUtils":1463,"esri/tasks/geometry/cut":1464,"esri/tasks/geometry/simplify":1465,"esri/core/pbf":1471,"esri/tasks/operations/pbfQueryUtils":1481,"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":1482,"esri/tasks/support/AttachmentQuery":1496,"esri/tasks/operations/pbfFeatureServiceParser":1497,"esri/tasks/operations/pbfDehydratedFeatureSet":1498,"esri/tasks/operations/pbfOptimizedFeatureSet":1499,"esri/tasks/operations/urlUtils":1500,"esri/tasks/support/RelationshipQuery":1501,"esri/layers/graphics/data/FeatureStore":1504,"esri/layers/graphics/data/QueryEngineCapabilities":1506,"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":1517,"esri/views/2d/layers/graphics/graphicsUtils":1518,"esri/renderers/support/styleUtils":1527,"esri/layers/support/FeatureProcessing":1528,"esri/support/popupUtils":1529,"esri/layers/mixins/TemporalLayer":1540,"esri/layers/support/TimeInfo":1541,"esri/TimeInterval":1542,"esri/layers/support/TimeReference":1543,"esri/views/2d/layers/features/support/AttributeStore":1546,"esri/layers/support/FeatureReduction":1571,"esri/layers/support/fieldProperties":1572,"esri/layers/support/FeatureTemplate":1592,"esri/views/2d/layers/features/controllers/BaseController":1611,"esri/views/2d/layers/features/support/pixelBuffering":1612,"esri/layers/support/FeatureReductionSelection":1636,"esri/layers/support/labelingInfo":1637,"esri/layers/graphics/editingSupport":1691,"esri/layers/graphics/sources/MemorySource":1692,"esri/layers/support/FeatureIndex":1693,"esri/layers/support/FeatureType":1694,"esri/layers/support/Relationship":1695,"esri/layers/graphics/data/executeTileQuery":1723,"esri/views/2d/layers/features/controllers/StreamController":2423,"esri/layers/graphics/data/StreamStore":2424,"esri/core/CircularArray":2425,"esri/layers/graphics/sources/connections/GeoEventConnection":2426,"esri/layers/graphics/sources/connections/StreamConnection":2427,"esri/views/2d/layers/features/controllers/support/DispatchQueue":2428})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[41,4,60,71,72,78,106],{1406:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(2),r(42),r(84),r(26),r(9),r(14),r(0),r(39),r(71),r(548)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,p,c,d){var f=new s.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"}),y=function(e){function t(t){var r=e.call(this,t)||this;return r.displayFieldName=null,r.exceededTransferLimit=!1,r.features=[],r.fields=null,r.geometryType=null,r.hasM=!1,r.hasZ=!1,r.queryGeometry=null,r.spatialReference=null,r}return i(t,e),t.prototype.readFeatures=function(e,t){for(var r=p.fromJSON(t.spatialReference),i=[],n=0;n<e.length;n++){var s=e[n],a=o.fromJSON(s),l=s.geometry&&s.geometry.spatialReference;u.isSome(a.geometry)&&!l&&(a.geometry.spatialReference=r),i.push(a)}return i},t.prototype.writeGeometryType=function(e,t,r,i){if(e)f.write(e,t,r,i);else{var n=this.features;if(n)for(var o=0,s=n;o<s.length;o++){var a=s[o];if(a&&u.isSome(a.geometry))return void f.write(a.geometry.type,t,r,i)}}},t.prototype.writeSpatialReference=function(e,t,r,i){if(e)t.spatialReference=e.toJSON();else{var n=this.features;if(n)for(var o=0,s=n;o<s.length;o++){var a=s[o];a&&u.isSome(a.geometry)&&a.geometry.spatialReference&&(t.spatialReference=a.geometry.spatialReference.toJSON())}}},t.prototype.toJSON=function(e){var t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var i=t.features[r];if(i.geometry){var n=e&&e[r];i.geometry=n&&n.toJSON()||i.geometry}}return t},t.prototype.quantize=function(e){for(var t=e.scale,r=t[0],i=t[1],n=e.translate,o=n[0],s=n[1],a=this.features,l=this._getQuantizationFunction(this.geometryType,function(e){return Math.round((e-o)/r)},function(e){return Math.round((s-e)/i)}),p=0,c=a.length;p<c;p++)l(u.expect(a[p].geometry))||(a.splice(p,1),p--,c--);return this.transform=e,this},t.prototype.unquantize=function(){var e=this,t=e.geometryType,r=e.features,i=e.transform;if(!i)return this;for(var n=i.translate,o=n[0],s=n[1],a=i.scale,l=a[0],p=a[1],c=this._getHydrationFunction(t,function(e){return e*l+o},function(e){return s-e*p}),d=0,f=r;d<f.length;d++){var y=f[d].geometry;u.isSome(y)&&c(y)}return this},t.prototype._quantizePoints=function(e,t,r){for(var i,n,o=[],s=0,a=e.length;s<a;s++){var u=e[s];if(s>0){var l=t(u[0]),p=r(u[1]);l===i&&p===n||(o.push([l-i,p-n]),i=l,n=p)}else i=t(u[0]),n=r(u[1]),o.push([i,n])}return o.length>0?o:null},t.prototype._getQuantizationFunction=function(e,t,r){var i=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var n=c.isPolygon(e)?e.rings:e.paths,o=[],s=0,a=n.length;s<a;s++){var u=n[s],l=i._quantizePoints(u,t,r);l&&o.push(l)}return o.length>0?(c.isPolygon(e)?e.rings=o:e.paths=o,e):null}:"multipoint"===e?function(e){var n;return(n=i._quantizePoints(e.points,t,r)).length>0?(e.points=n,e):null}:"extent"===e?function(e){return e}:void 0},t.prototype._getHydrationFunction=function(e,t,r){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var i,n,o=c.isPolygon(e)?e.rings:e.paths,s=0,a=o.length;s<a;s++)for(var u=o[s],l=0,p=u.length;l<p;l++){var d=u[l];l>0?(i+=d[0],n+=d[1]):(i=d[0],n=d[1]),d[0]=t(i),d[1]=r(n)}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?function(e){for(var i,n,o=e.points,s=0,a=o.length;s<a;s++){var u=o[s];s>0?(i+=u[0],n+=u[1]):(i=u[0],n=u[1]),u[0]=t(i),u[1]=r(n)}}:void 0},r([l.property({type:String,json:{write:!0}})],t.prototype,"displayFieldName",void 0),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"exceededTransferLimit",void 0),r([l.property({type:[o],json:{write:!0}})],t.prototype,"features",void 0),r([l.reader("features")],t.prototype,"readFeatures",null),r([l.property({type:[d],json:{write:!0}})],t.prototype,"fields",void 0),r([l.property({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:f.read}}})],t.prototype,"geometryType",void 0),r([l.writer("geometryType")],t.prototype,"writeGeometryType",null),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasM",void 0),r([l.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"hasZ",void 0),r([l.property({types:n.geometryTypes,json:{read:c.fromJSON,write:!0}})],t.prototype,"queryGeometry",void 0),r([l.property({type:p,json:{write:!0}})],t.prototype,"spatialReference",void 0),r([l.writer("spatialReference")],t.prototype,"writeSpatialReference",null),r([l.property({json:{write:!0}})],t.prototype,"transform",void 0),r([l.subclass("esri.tasks.support.FeatureSet")],t)}(l.declared(a));return y.prototype.toJSON.isDefaultToJSON=!0,y||(y={}),y}.apply(null,i))||(e.exports=n)},1407:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(5),r(84),r(8),r(350),r(349),r(39),r(548),r(1481),r.dj.m(e)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,p){Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(){}return e.prototype._parseFeatureQuery=function(e){var t=l.parsePBFFeatureQuery(e.buffer,e.options);if(e.options&&"dehydrated"===e.options.type){var r=t;if(t.spatialReference=r.spatialReference.toJSON(),r.fields)for(var i=0;i<r.fields.length;i++)r.fields[i]=r.fields[i].toJSON()}return n.resolve(t)},e}(),d=function(t){function c(){var r=t.call(this)||this;return r._thread=void 0,s.open(o.getAbsMid("./PBFWorker",e,p),{strategy:"dedicated"}).then(function(e){void 0===r._thread?r._thread=e:e.close()}),r}return r(c,t),c.prototype.destroy=function(){this._thread&&this._thread.close(),this._thread=null},c.prototype.parseFeatureQuery=function(e,t){return e&&0!==e.byteLength?this._thread?this._thread.invoke("_parseFeatureQuery",{buffer:e,options:t},{transferList:[e]}).then(function(e){if(t&&"dehydrated"===t.type){var r=e;if(r.spatialReference=a.fromJSON(r.spatialReference),r.fields)for(var n=0;n<r.fields.length;n++)r.fields[n]=u.fromJSON(r.fields[n]);for(var o=r.spatialReference,s=0,l=r.features;s<l.length;s++){var p=l[s];p.uid=i.generateUID(),p.geometry&&(p.geometry.spatialReference=o)}}return e}):n.resolve(l.parsePBFFeatureQuery(e,t)):n.resolve(null)},c}(c);t.PBFWorker=d,t.default=function(){return new c}}.apply(null,i))||(e.exports=n)},1408:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(48),r(52),r(14),r(31),r(71),r(1463),r(1481),r(1407),r(1500),r(153)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,p,c){function d(e,t){var r=e.geometry,i=e.toJSON(),n=i;if(r&&(n.geometry=JSON.stringify(r),n.geometryType=a.getJsonType(r),n.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),i.groupByFieldsForStatistics&&(n.groupByFieldsForStatistics=i.groupByFieldsForStatistics.join(",")),i.objectIds&&(n.objectIds=i.objectIds.join(",")),i.orderByFields&&(n.orderByFields=i.orderByFields.join(",")),!i.outFields||t&&(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)?delete n.outFields:-1!==i.outFields.indexOf("*")?n.outFields="*":n.outFields=i.outFields.join(","),i.outSR?n.outSR=i.outSR.wkid||JSON.stringify(i.outSR):r&&(i.returnGeometry||i.returnCentroid)&&(n.outSR=n.inSR),i.returnGeometry&&delete i.returnGeometry,i.outStatistics&&(n.outStatistics=JSON.stringify(i.outStatistics)),i.pixelSize&&(n.pixelSize=JSON.stringify(i.pixelSize)),i.quantizationParameters&&(n.quantizationParameters=JSON.stringify(i.quantizationParameters)),i.source&&(n.layer=JSON.stringify({source:i.source}),delete i.source),i.timeExtent){var o=i.timeExtent,s=o.start,u=o.end;null==s&&null==u||(n.time=s===u?s:(null==s?"null":s)+","+(null==u?"null":u)),delete i.timeExtent}return n}function f(e,t,a,l,p){void 0===l&&(l={});var f="string"==typeof e?s.urlToObject(e):e,y=t.geometry?[t.geometry]:[];return l.responseType="pbf"===a?"array-buffer":"json",n.safeCast(u.normalizeCentralMeridian(y,null,l)).then(function(e){var n=e&&e[0];o.isSome(n)&&((t=t.clone()).geometry=n);var s=c.mapParameters(r({},f.query,{f:a},p,d(t,p)));return i(f.path+"/query",r({},l,{query:s}))})}Object.defineProperty(t,"__esModule",{value:!0});var y,h="Layer does not support extent calculation.";t.queryToQueryStringParameters=d,t.executeQuery=function(e,t,r){return f(e,t,"json",r)},t.executeQueryPBF=function(e,t,r,i){return f(e,t,"pbf",i).then(function(e){var t=function(t){var r=e;return r.data=t,r};return r.useWorker?(null==y&&(y=new p.PBFWorker),y).parseFeatureQuery(e.data,r).then(function(e){return t(e)}):t(l.parsePBFFeatureQuery(e.data,r))})},t.executeQueryForIds=function(e,t,r){return f(e,t,"json",r,{returnIdsOnly:!0})},t.executeQueryForCount=function(e,t,r){return f(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})},t.executeQueryForExtent=function(e,t,r){return f(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then(function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(h);if(t.hasOwnProperty("count"))throw new Error(h);return e})}}.apply(null,i))||(e.exports=n)},1463:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(12),r(97),r(15),r(11),r(14),r(8),r(63),r(96),r(39),r(94),r(56),r(1464),r(1465)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,p,c,d,f,y,h){function m(e){return"polygon"===e.type}function v(e){return"polygon"===e[0].type}function g(e){return"polyline"===e[0].type}function b(e){return m(e)?e.rings:e.paths}function _(e,t){return Math.ceil((e-t)/(2*t))}function w(e,t){for(var r=0,i=b(e);r<i.length;r++)for(var n=0,o=i[r];n<o.length;n++){o[n][0]+=t}return e}function x(e){for(var t=[],r=0,i=0,n=0;n<e.length;n++){for(var o=e[n],s=null,a=0;a<o.length;a++)s=o[a],t.push(s),0===a?i=r=s[0]:(r=Math.min(r,s[0]),i=Math.max(i,s[0]));s&&t.push([(r+i)/2,0])}return t}function F(e,t){if(!(e instanceof p||e instanceof l)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw O.error(r),new o(r)}for(var i=[],n=0,s=b(e);n<s.length;n++){var a=s[n],u=[];i.push(u),u.push([a[0][0],a[0][1]]);for(var c=0;c<a.length-1;c++){var d=a[c][0],f=a[c][1],y=a[c+1][0],h=a[c+1][1],v=Math.sqrt((y-d)*(y-d)+(h-f)*(h-f)),g=(h-f)/v,_=(y-d)/v,w=v/t;if(w>1){for(var x=1;x<=w-1;x++){var F=x*t,S=_*F+d,I=g*F+f;u.push([S,I])}var T=(v+Math.floor(w-1)*t)/2,M=_*T+d,j=g*T+f;u.push([M,j])}u.push([y,h])}}return m(e)?new l({rings:i,spatialReference:e.spatialReference}):new p({paths:i,spatialReference:e.spatialReference})}function S(e,t,r){if(t){var i=F(e,1e6);e=f.webMercatorToGeographic(i,!0)}return r&&(e=w(e,r)),e}function I(e,t,r){var i;if(Array.isArray(e)){if((i=e[0])>t){var n=_(i,t);e[0]=i+n*(-2*t)}else if(i<r){n=_(i,r);e[0]=i+n*(-2*r)}}else if((i=e.x)>t){n=_(i,t);e=e.clone().offset(n*(-2*t),0)}else if(i<r){n=_(i,r);e=e.clone().offset(n*(-2*r),0)}return e}function T(e,t){for(var r=-1,i=0;i<t.cutIndexes.length;i++)!function(i){for(var n=t.cutIndexes[i],o=t.geometries[i],s=b(o),a=0;a<s.length;a++)!function(e){var t=s[e];t.some(function(r){if(r[0]<180)return!0;for(var i=0,n=0;n<t.length;n++){var s=t[n][0];i=s>i?s:i}for(var a=-360*_(i=Number(i.toFixed(9)),180),u=0;u<t.length;u++){var l=o.getPoint(e,u);o.setPoint(e,u,l.clone().offset(a,0))}return!0})}(a);if(n===r){if(v(e))for(var u=0,l=b(o);u<l.length;u++){var p=l[u];e[n]=e[n].addRing(p)}else if(g(e))for(var c=0,d=b(o);c<d.length;c++){var f=d[c];e[n]=e[n].addPath(f)}}else r=n,e[n]=o}(i);return e}Object.defineProperty(t,"__esModule",{value:!0});var O=s.getLogger("esri.geometry.support.normalizeUtils"),M={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new p({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:c.WebMercator}),minus180Line:new p({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:c.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new p({paths:[[[180,-180],[180,180]]],spatialReference:c.WebMercator}),minus180Line:new p({paths:[[[-180,-180],[-180,180]]],spatialReference:c.WebMercator})}};t.straightLineDensify=F,t.normalizeCentralMeridian=function e(t,o,s){return i(this,void 0,void 0,function(){var i,c,m,v,g,b,x,F,O,j,E,C,P,R,k,D,A,B,q,N,z,L,G,U,V,Q,J,W,Z,X,H,Y,K,$,ee,te,re;return r(this,function(r){switch(r.label){case 0:if(!Array.isArray(t))return[2,e([t],o)];for(i=o?o.url:n.geometryServiceUrl,j=0,E=[],C=[],P=0,R=t;P<R.length;P++)k=R[P],a.isNone(k)?C.push(k):(c||(c=k.spatialReference,m=d.getInfo(c),v=c.isWebMercator,g=M[x=v?102100:4326].maxX,b=M[x].minX,F=M[x].plus180Line,O=M[x].minus180Line),m?"mesh"===k.type?C.push(k):"point"===k.type?C.push(I(k.clone(),g,b)):"multipoint"===k.type?((D=k.clone()).points=D.points.map(function(e){return I(e,g,b)}),C.push(D)):"extent"===k.type?(B=k.clone(),A=B._normalize(!1,!1,m),C.push(A.rings?new l(A):A)):k.extent?(B=k.extent,q=_(B.xmin,b),z=0==(N=q*(2*g))?k.clone():w(k.clone(),N),B.offset(N,0),B.intersects(F)&&B.xmax!==g?(j=B.xmax>j?B.xmax:j,z=S(z,v),E.push(z),C.push("cut")):B.intersects(O)&&B.xmin!==b?(j=B.xmax*(2*g)>j?B.xmax*(2*g):j,z=S(z,v,360),E.push(z),C.push("cut")):C.push(z)):C.push(k.clone()):C.push(k));for(L=_(j,g),G=-90,U=L,V=new p;L>0;)Q=360*L-180,V.addPath([[Q,G],[Q,-1*G]]),G*=-1,L--;return E.length>0&&U>0?[4,y.cut(i,E,V,s)]:[3,3];case 1:for(J=r.sent(),W=T(E,J),Z=[],X=[],ee=0;ee<C.length;ee++)"cut"!==(te=C[ee])?X.push(te):(re=W.shift(),H=t[ee],a.isSome(H)&&"polygon"===H.type&&H.rings&&H.rings.length>1&&re.rings.length>=H.rings.length?(Z.push(re),X.push("simplify")):X.push(v?f.geographicToWebMercator(re):re));return Z.length?[4,h.simplify(i,Z,s)]:[2,X];case 2:for(Y=r.sent(),K=[],ee=0;ee<X.length;ee++)"simplify"!==(te=X[ee])?K.push(te):K.push(v?f.geographicToWebMercator(Y.shift()):Y.shift());return[2,K];case 3:for($=[],ee=0;ee<C.length;ee++)"cut"!==(te=C[ee])?$.push(te):(re=E.shift(),$.push(!0===v?f.geographicToWebMercator(re):re));return[2,u.resolve($)]}})})},t.getDenormalizedExtent=function(e){var t;if(!e)return null;var r=e.extent;if(!r)return null;var i=e.spatialReference&&d.getInfo(e.spatialReference);if(!i)return r;var n,o=i.valid,s=o[0],a=o[1],u=2*a,l=r.width,p=r.xmin,c=r.xmax;if(p=(t=[c,p])[0],c=t[1],"extent"===e.type||0===l||l<=a||l>u||p<s||c>a)return r;switch(e.type){case"polygon":if(!(e.rings.length>1))return r;n=x(e.rings);break;case"polyline":if(!(e.paths.length>1))return r;n=x(e.paths);break;case"multipoint":n=e.points}for(var f=r.clone(),y=0;y<n.length;y++){var h=n[y][0];h<0?(h+=a,c=Math.max(h,c)):(h-=a,p=Math.min(h,p))}return f.xmin=p,f.xmax=c,f.width<l?(f.xmin-=a,f.xmax-=a,f):r},t.normalizeMapX=function(e,t){var r=d.getInfo(t);if(r){var i=r.valid,n=i[0],o=i[1],s=o-n;if(e<n)for(;e<n;)e+=s;if(e>o)for(;e>o;)e-=s}return e}}.apply(null,i))||(e.exports=n)},1464:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(12),r(10),r(42),r(48),r(31),r(71)],void 0===(n=function(e,t,r,i,n,o,s,a,u){Object.defineProperty(t,"__esModule",{value:!0}),t.cut=function(e,t,l,p){return i(this,void 0,void 0,function(){var i,c,d,f,y,h,m;return n(this,function(n){switch(n.label){case 0:return i="string"==typeof e?a.urlToObject(e):e,c=t[0].spatialReference,d=r({},p,{query:r({},i.query,{f:"json",sr:JSON.stringify(c),target:JSON.stringify({geometryType:u.getJsonType(t[0]),geometries:t}),cutter:JSON.stringify(l)})}),[4,s(i.path+"/cut",d)];case 1:return f=n.sent(),y=f.data,h=y.cutIndexes,m=y.geometries,[2,{cutIndexes:h,geometries:(void 0===m?[]:m).map(function(e){return o.fromJSON(e).set(c)})}]}})})}}.apply(null,i))||(e.exports=n)},1465:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(12),r(10),r(48),r(31),r(71)],void 0===(n=function(e,t,r,i,n,o,s,a){Object.defineProperty(t,"__esModule",{value:!0}),t.simplify=function(e,t,u){return i(this,void 0,void 0,function(){var i,l,p,c;return n(this,function(n){switch(n.label){case 0:return i="string"==typeof e?s.urlToObject(e):e,l=t[0].spatialReference,p=a.getJsonType(t[0]),c=r({},u,{query:r({},i.query,{f:"json",sr:l.wkid?l.wkid:JSON.stringify(l),geometries:JSON.stringify(function(e){return{geometryType:a.getJsonType(e[0]),geometries:e.map(function(e){return e.toJSON()})}}(t))})}),[4,o(i.path+"/simplify",c)];case 1:return[2,function(e,t,r){var i=a.getGeometryType(t);return e.map(function(e){var t=i.fromJSON(e);return t.spatialReference=r,t})}(n.sent().data,p,l)]}})})}}.apply(null,i))||(e.exports=n)},1471:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(22)],void 0===(n=function(e,t,r){var i=r("esri-text-decoder")?TextDecoder:null;return function(){function e(e,t,r,n){this._tag=0,this._dataType=99,this._data=e,this._dataView=t,this._pos=r||0,this._end=n||e.byteLength,this._textDecoder=i?new i("utf-8"):null}return e.prototype.clone=function(){return new e(this._data,this._dataView,this._pos,this._end)},e.prototype.pos=function(){return this._pos},e.prototype.next=function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0},e.prototype.empty=function(){return this._pos>=this._end},e.prototype.tag=function(){return this._tag},e.prototype.getInt32=function(){return this._decodeVarint()},e.prototype.getInt64=function(){return this._decodeVarint()},e.prototype.getUInt32=function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))},e.prototype.getUInt64=function(){return this._decodeVarint()},e.prototype.getSInt32=function(){var e=this.getUInt32();return e>>>1^-(1&e)|0},e.prototype.getSInt64=function(){return this._decodeSVarint()},e.prototype.getBool=function(){var e=0!==this._data[this._pos];return this._skip(1),e},e.prototype.getEnum=function(){return this._decodeVarint()},e.prototype.getFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getUint32(t+4,!0);return this._skip(8),r},e.prototype.getSFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getInt32(t+4,!0);return this._skip(8),r},e.prototype.getDouble=function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e},e.prototype.getFixed32=function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e},e.prototype.getSFixed32=function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e},e.prototype.getFloat=function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e},e.prototype.getString=function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r},e.prototype.getBytes=function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r},e.prototype.getMessage=function(){var t=this._getLength(),r=this._pos,i=new e(this._data,this._dataView,r,r+t);return this._skip(t),i},e.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},e.prototype._skip=function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e},e.prototype._decodeVarint=function(){var e,t=this._data,r=this._pos,i=0;if(this._end-r>=10)do{if(i|=127&(e=t[r++]),0==(128&e))break;if(i|=(127&(e=t[r++]))<<7,0==(128&e))break;if(i|=(127&(e=t[r++]))<<14,0==(128&e))break;if(i|=(127&(e=t[r++]))<<21,0==(128&e))break;if(i+=268435456*(127&(e=t[r++])),0==(128&e))break;if(i+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(i+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(i+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(i+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(i+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var n=1;r!==this._end&&0!=(128&(e=t[r]));)++r,i+=(127&e)*n,n*=128;if(r===this._end)throw new Error("Varint overrun!");++r,i+=e*n}return this._pos=r,i},e.prototype._decodeSVarint=function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2},e.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},e.prototype._toString=function(e,t,r){if(r=Math.min(this._end,r),this._textDecoder){var i=e.subarray(t,r);return this._textDecoder.decode(i)}for(var n="",o="",s=t;s<r;++s){var a=e[s];128&a?o+="%"+a.toString(16):(n+=decodeURIComponent(o)+String.fromCharCode(a),o="")}return o.length&&(n+=decodeURIComponent(o)),n},e.prototype._toBytes=function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)},e}()}.apply(null,i))||(e.exports=n)},1481:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1497)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.parsePBFFeatureQuery=function(e,t){var i=r.parseFeatureQuery(e,t).queryResult.featureResult;if(i&&i.features&&i.features.length&&i.objectIdFieldName)for(var n=i.objectIdFieldName,o=0,s=i.features;o<s.length;o++){var a=s[o];a.attributes&&(a.objectId=a.attributes[n])}return i}}.apply(null,i))||(e.exports=n)},1482:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1484),r(552),r(550)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.optimizedFeatureQueryEngineAdapter={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new i.default(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return e.centroid||(e.centroid=r.getCentroidOptimizedGeometry(new n.default,e.geometry,t.hasZ,t.hasM)),e.centroid}},t.default=t.optimizedFeatureQueryEngineAdapter}.apply(null,i))||(e.exports=n)},1496:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(9),r(13),r(0),r(27)],void 0===(n=function(e,t,r,i,n,o,s,a){var u=function(e){function t(t){var r=e.call(this,t)||this;return r.attachmentTypes=null,r.globalIds=null,r.num=null,r.objectIds=null,r.returnMetadata=!1,r.size=null,r.start=null,r.where=null,r}var n;return r(t,e),n=t,t.prototype.writeStart=function(e,t,r){t.resultOffset=this.start,t.resultRecordCount=this.num||10},t.prototype.clone=function(){return new n(o.clone({attachmentTypes:this.attachmentTypes,where:this.where,globalIds:this.globalIds,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))},i([s.property({type:[String],json:{write:!0}})],t.prototype,"attachmentTypes",void 0),i([s.property({type:[Number],json:{write:!0}})],t.prototype,"globalIds",void 0),i([s.property({type:Number,json:{read:{source:"resultRecordCount"}}})],t.prototype,"num",void 0),i([s.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),i([s.property({type:Boolean,json:{default:!1,write:!0}})],t.prototype,"returnMetadata",void 0),i([s.property({type:[Number],json:{write:!0}})],t.prototype,"size",void 0),i([s.property({type:Number,json:{read:{source:"resultOffset"}}})],t.prototype,"start",void 0),i([s.writer("start"),s.writer("num")],t.prototype,"writeStart",null),i([s.property({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],t.prototype,"where",void 0),n=i([s.subclass("esri.tasks.support.AttachmentQuery")],t)}(s.declared(n));return u.from=a.default(u),u}.apply(null,i))||(e.exports=n)},1497:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(15),r(11),r(1471),r(1498),r(1499)],void 0===(n=function(e,t,r,i,n,o,s){function a(e){return e>=I.length?null:I[e]}function u(e){return e>=T.length?null:T[e]}function l(e){return e>=O.length?null:O[e]}function p(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function c(e,t,r){for(var i=e.createPointGeometry(t);r.next();)switch(r.tag()){case 3:for(var n=r.getUInt32(),o=r.pos()+n,s=0;r.pos()<o;)e.addCoordinatePoint(i,r.getSInt64(),0,s++);break;case 1:case 2:default:r.skip()}return i}function d(e,t,r){for(var i=e.createGeometry(t),n=2+(t.hasZ?1:0)+(t.hasM?1:0);r.next();)switch(r.tag()){case 2:for(var o=r.getUInt32(),s=r.pos()+o,a=0;r.pos()<s;)e.addLength(i,r.getUInt32(),a++);break;case 3:for(var u=r.getUInt32(),l=(s=r.pos()+u,0),p=0;r.pos()<s;)e.addCoordinate(i,r.getSInt64(),p,l),++l===n&&(p++,l=0);break;case 1:default:r.skip()}return i}function f(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function y(e){for(var t={type:a(0)};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=a(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=u(e.getEnum());break;case 5:case 6:default:e.skip()}return t}function h(e,t,r,i){for(var n=e.createFeature(t),o=0;r.next();)switch(r.tag()){case 1:var s=i[o++].name;n.attributes[s]=f(r.getMessage());break;case 2:n.geometry=d(e,t,r.getMessage());break;case 4:n.centroid=c(e,t,r.getMessage());break;default:r.skip()}return n}function m(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function v(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function g(e){for(var t={originPosition:l(0)};e.next();)switch(e.tag()){case 1:t.originPosition=l(e.getEnum());break;case 2:t.scale=m(e.getMessage());break;case 3:t.translate=v(e.getMessage());break;default:e.skip()}return t}function b(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function _(e,t){for(var r=e.createSpatialReference();t.next();)switch(t.tag()){case 1:r.wkid=t.getUInt32();break;case 5:r.wkt=t.getString();break;case 2:case 3:case 4:default:t.skip()}return r}function w(e,t){var r=e.createFeatureResult();r.geometryType=p(e,0);for(var i=!1;t.next();)switch(t.tag()){case 1:r.objectIdFieldName=t.getString();break;case 3:r.globalIdFieldName=t.getString();break;case 4:r.geohashFieldName=t.getString();break;case 5:r.geometryProperties=b(t.getMessage());break;case 7:r.geometryType=p(e,t.getEnum());break;case 8:r.spatialReference=_(e,t.getMessage());break;case 10:r.hasZ=t.getBool();break;case 11:r.hasM=t.getBool();break;case 12:r.transform=g(t.getMessage());break;case 9:var n=t.getBool();r.exceededTransferLimit=n;break;case 13:e.addField(r,y(t.getMessage()));break;case 15:i||(e.prepareFeatures(r),i=!0),e.addFeature(r,h(e,r,t.getMessage(),r.fields));break;case 2:case 6:default:t.skip()}return e.finishFeatureResult(r),r}function x(e,t){for(var r={};t.next();)switch(t.tag()){case 1:r.featureResult=w(e,t.getMessage());break;default:t.skip()}return r}function F(e){return e&&"dehydrated"===e.type?new o.Context(e):new s.Context(e)}Object.defineProperty(t,"__esModule",{value:!0});var S=i.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),I=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],T=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],O=["upperLeft","lowerLeft"];t.parseFeatureQuery=function(e,t){var i=F(t);try{for(var o=new n(new Uint8Array(e),new DataView(e)),s={};o.next();)switch(o.tag()){case 2:s.queryResult=x(i,o.getMessage());break;default:o.skip()}return s}catch(e){var a=new r("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:e});return S.error(a),{queryResult:{featureResult:i.createFeatureResult()}}}}}.apply(null,i))||(e.exports=n)},1498:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(84),r(25),r(39),r(95),r(548)],void 0===(n=function(e,t,r,i,n,o,s){function a(e,t,r,i){return t}function u(e,t,r,i){switch(r){case 0:return d(e,t+i,0);case 1:return f(e,t+i,1)}}function l(e,t,r,i){switch(r){case 0:return d(e,t+i,0);case 1:return f(e,t+i,1);case 2:return d(e,t,2)}}function p(e,t,r,i){switch(r){case 0:return d(e,t+i,0);case 1:return f(e,t+i,1);case 2:return d(e,t,3)}}function c(e,t,r,i){switch(r){case 0:return d(e,t+i,0);case 1:return f(e,t+i,1);case 2:case 3:return d(e,t,3)}}function d(e,t,r){var i=e.translate,n=e.scale;return i[r]+t*n[r]}function f(e,t,r){var i=e.translate,n=e.scale;return i[r]-t*n[r]}Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(e){this.options=e,this.geometryTypes=["point","multipoint","polyline","polygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=a,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this.AttributesConstructor=function(){}}return e.prototype.createFeatureResult=function(){return new o.DehydratedFeatureSetClass},e.prototype.finishFeatureResult=function(e){this.options.applyTransform&&(e.transform=null),this.AttributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0},e.prototype.createSpatialReference=function(){return new n},e.prototype.addField=function(e,t){e.fields.push(s.fromJSON(t));var r=e.fields.map(function(e){return e.name});this.AttributesConstructor=function(){for(var e=0,t=r;e<t.length;e++)this[t[e]]=null}},e.prototype.addFeature=function(e,t){var r=this.options.maxStringAttributeLength?this.options.maxStringAttributeLength:0;if(r>0)for(var i in t.attributes){var n=t.attributes[i];"string"==typeof n&&n.length>r&&(t.attributes[i]="")}e.features.push(t)},e.prototype.prepareFeatures=function(e){switch(this.options.applyTransform&&e.transform&&(this.transform=e.transform,this.applyTransform=this.deriveApplyTransform(e)),this.vertexDimension=2,e.hasZ&&this.vertexDimension++,e.hasM&&this.vertexDimension++,e.geometryType){case"point":this.addCoordinate=this.addCoordinatePoint.bind(this),this.createGeometry=this.createPointGeometry.bind(this);break;case"polygon":this.addCoordinate=this.addCoordinatePolygon.bind(this),this.createGeometry=this.createPolygonGeometry.bind(this);break;case"polyline":this.addCoordinate=this.addCoordinatePolyline.bind(this),this.createGeometry=this.createPolylineGeometry.bind(this);break;case"multipoint":this.addCoordinate=this.addCoordinateMultipoint.bind(this),this.createGeometry=this.createMultipointGeometry.bind(this);break;default:i.neverReached(e.geometryType)}},e.prototype.createFeature=function(e){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,new o.DehydratedFeatureClass(r.generateUID(),null,new this.AttributesConstructor)},e.prototype.addLength=function(e,t,r){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t)},e.prototype.createPointGeometry=function(e){var t={type:"point",x:0,y:0,spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM};return t.hasZ&&(t.z=0),t.hasM&&(t.m=0),t},e.prototype.addCoordinatePoint=function(e,t,r,i){switch(t=this.applyTransform(this.transform,t,i,0),i){case 0:e.x=t;break;case 1:e.y=t;break;case 2:e.hasZ?e.z=t:e.m=t;break;case 3:e.m=t}},e.prototype.transformPathLikeValue=function(e,t){var r=0;return t<=1&&(r=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,r)},e.prototype.addCoordinatePolyline=function(e,t,r,i){this.dehydratedAddPointsCoordinate(e.paths,t,r,i)},e.prototype.addCoordinatePolygon=function(e,t,r,i){this.dehydratedAddPointsCoordinate(e.rings,t,r,i)},e.prototype.addCoordinateMultipoint=function(e,t,r){0===r&&e.points.push([]);var i=this.transformPathLikeValue(t,r);e.points[e.points.length-1].push(i)},e.prototype.createPolygonGeometry=function(e){return{type:"polygon",rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.createPolylineGeometry=function(e){return{type:"polyline",paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.createMultipointGeometry=function(e){return{type:"multipoint",points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.dehydratedAddPointsCoordinate=function(e,t,r,i){if(null===this.coordinateBuffer){var n=this.lengths.reduce(function(e,t){return e+t},0);this.coordinateBuffer=new Float64Array(n*this.vertexDimension)}0===i&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);var o=this.transformPathLikeValue(t,i),s=e[e.length-1];0===i&&s.push(new Float64Array(this.coordinateBuffer.buffer,this.coordinateBufferPtr*Float64Array.BYTES_PER_ELEMENT,this.vertexDimension)),this.coordinateBuffer[this.coordinateBufferPtr++]=o},e.prototype.deriveApplyTransform=function(e){var t=e.hasZ,r=e.hasM;return t&&r?c:t?l:r?p:u},e}();t.Context=y}.apply(null,i))||(e.exports=n)},1499:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(552),r(566),r(550)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"]}return e.prototype.createFeatureResult=function(){return new i.default},e.prototype.prepareFeatures=function(){},e.prototype.finishFeatureResult=function(){},e.prototype.addFeature=function(e,t){e.features.push(t)},e.prototype.createFeature=function(){return new r.default},e.prototype.createSpatialReference=function(){return{wkid:0}},e.prototype.createGeometry=function(){return new n.default},e.prototype.addField=function(e,t){e.fields.push(t)},e.prototype.addCoordinate=function(e,t){e.coords.push(t)},e.prototype.addCoordinatePoint=function(e,t){e.coords.push(t)},e.prototype.addLength=function(e,t){e.lengths.push(t)},e.prototype.createPointGeometry=function(){return new n.default},e}();t.Context=o}.apply(null,i))||(e.exports=n)},1500:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapParameters=function e(t){var r={};for(var i in t)if("declaredClass"!==i){var n=t[i];if(null!=n&&"function"!=typeof n)if(Array.isArray(n)){r[i]=[];for(var o=0;o<n.length;o++)r[i][o]=e(n[o])}else"object"==typeof n?n.toJSON&&(r[i]=JSON.stringify(n)):r[i]=n}return r}}.apply(null,i))||(e.exports=n)},1501:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(42),r(9),r(13),r(0),r(27)],void 0===(n=function(e,t,r,i,n,o,s,a,u){var l=function(e){function t(t){var r=e.call(this,t)||this;return r.gdbVersion=null,r.geometryPrecision=void 0,r.historicMoment=null,r.maxAllowableOffset=void 0,r.objectIds=null,r.outFields=null,r.outSpatialReference=null,r.relationshipId=void 0,r.returnGeometry=!1,r.source=null,r.where=null,r}var o;return r(t,e),o=t,t.prototype._writeHistoricMoment=function(e,t){t.historicMoment=e&&e.getTime()},t.prototype.clone=function(){return new o(s.clone({gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&this.historicMoment.getTime(),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,source:this.source,where:this.where}))},i([a.property({type:String,json:{write:!0}})],t.prototype,"gdbVersion",void 0),i([a.property({type:Number,json:{write:!0}})],t.prototype,"geometryPrecision",void 0),i([a.property({type:Date})],t.prototype,"historicMoment",void 0),i([a.writer("historicMoment")],t.prototype,"_writeHistoricMoment",null),i([a.property({type:Number,json:{write:!0}})],t.prototype,"maxAllowableOffset",void 0),i([a.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),i([a.property({type:[String],json:{write:!0}})],t.prototype,"outFields",void 0),i([a.property({type:n.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],t.prototype,"outSpatialReference",void 0),i([a.property({json:{write:!0}})],t.prototype,"relationshipId",void 0),i([a.property({json:{write:!0}})],t.prototype,"returnGeometry",void 0),i([a.property({json:{write:!0}})],t.prototype,"source",void 0),i([a.property({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],t.prototype,"where",void 0),o=i([a.subclass("esri.tasks.support.RelationshipQuery")],t)}(a.declared(o));return l.from=u.default(l),l}.apply(null,i))||(e.exports=n)},1504:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(12),r(5),r(551),r(15),r(37),r(22),r(11),r(14),r(1494),r(43),r(35),r(352),r(1482)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,p,c,d,f,y,h){Object.defineProperty(t,"__esModule",{value:!0});var m=[],v=l.getLogger("esri.layers.graphics.data.FeatureStore"),g={minX:0,minY:0,maxX:0,maxY:0},b=function(){function e(e,t,r){this._geometryInfo=e,this._onFeatureAdd=t,this._onFeatureRemove=r,this._featuresById=new o.default,this._boundsByFeature=new o.default,this._featuresByBounds=new o.default,this._index=c(9,u("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this.events=new a,this.featureAdapter=h.optimizedFeatureQueryEngineAdapter}return Object.defineProperty(e.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var e=f.create(f.NEGATIVE_INFINITY);return this._boundsByFeature.forEach(function(t){t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]))}),e},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this._add(e,m),this._index.load(m),this._emitChanged(),m.length=0},e.prototype.addMany=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this._add(i,m)}this._index.load(m),this._emitChanged(),m.length=0},e.prototype.clear=function(){this._featuresById.clear(),this._boundsByFeature.clear(),this._featuresByBounds.clear(),this._index.clear(),this._emitChanged()},e.prototype.removeById=function(e){var t=this._featuresById.get(e);if(!t)return null;var r=this._boundsByFeature.get(t);return r&&(this._index.remove(r),this._featuresByBounds.delete(r)),this._boundsByFeature.delete(t),this._featuresById.delete(e),this._emitChanged(),t},e.prototype.removeIf=function(e,t){var r=this;this._featuresById.forEach(function(i,n){t(i)&&(r._remove(i),e.push(i))}),this._emitChanged()},e.prototype.removeManyById=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],n=this._featuresById.get(i);if(n){var o=this._boundsByFeature.get(n);o&&(this._index.remove(o),this._featuresByBounds.delete(o)),this._boundsByFeature.delete(n)}this._featuresById.delete(i)}this._emitChanged()},e.prototype.forEachBounds=function(e,t,r){for(var i=0,n=e;i<n.length;i++){var o=n[i],s=this._boundsByFeature.get(o);s&&t(d.fromRect(r,s))}},e.prototype.getFeature=function(e){return this._featuresById.get(e)},e.prototype.has=function(e){return this._featuresById.has(e)},e.prototype.forEach=function(e){this._featuresById.forEach(function(t){return e(t)})},e.prototype.forEachInBounds=function(e,t){for(var r=0,i=function(e,t){return g.minX=t[0],g.minY=t[1],g.maxX=t[2],g.maxY=t[3],e.search(g)}(this._index,e);r<i.length;r++){var n=i[r];t(this._featuresByBounds.get(n))}},e.prototype.transferById=function(e,t){var r=this._featuresById.get(t);r&&(this._remove(r),e.add(r),this._emitChanged())},e.prototype.transferByIds=function(e,t){for(var r=[],i=0,n=t;i<n.length;i++){var o=n[i],s=this._featuresById.get(o);s&&(this._remove(s),r.push(s))}e.addMany(r),this._emitChanged()},e.prototype.transferIdRange=function(e,t,r){for(var i=[],n=t;n<r;n++){var o=this._featuresById.get(n);o&&(this._remove(o),i.push(o))}e.addMany(i),this._emitChanged()},e.prototype.transferIf=function(e,t){var r=this,i=[];this._featuresById.forEach(function(e,n){t(e)&&(r._remove(e),i.push(e))}),e.addMany(i),this._emitChanged()},e.prototype.transferAll=function(e){var t=this,r=[];this._featuresById.forEach(function(e,i){t._remove(e),r.push(e)}),e.addMany(r),this._emitChanged()},e.prototype._emitChanged=function(){this.events.emit("changed",void 0)},e.prototype._add=function(e,t){if(e){var r=e.objectId;if(null==r)return void v.error(new s("featurestore:invalid-feature","feature id is missing",{feature:e}));var i,n=this._featuresById.get(r);if(n?(i=this._boundsByFeature.get(n),e.localId=n.localId,i&&(this._index.remove(i),this._boundsByFeature.delete(n),this._featuresByBounds.delete(i))):p.isSome(this._onFeatureAdd)&&this._onFeatureAdd(e),!e.geometry)return this._boundsByFeature.set(e,null),void this._featuresById.set(r,e);i=y.getBoundsOptimizedGeometry(i||f.create(),e.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(e,i),this._featuresByBounds.set(i,e),this._featuresById.set(r,e),t.push(i)}},e.prototype._remove=function(e){var t;e&&(p.isSome(this._onFeatureRemove)&&this._onFeatureRemove(e),(t=this._boundsByFeature.get(e))&&(this._index.remove(t),this._boundsByFeature.delete(e),this._featuresByBounds.delete(t)),this._featuresById.delete(e.objectId))},e}();t.default=b}.apply(null,i))||(e.exports=n)},1506:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}}.apply(null,i))||(e.exports=n)},1517:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(17),r(1462),r(208)],void 0===(n=function(e,t,r,i,n){function o(e){return{value:e.value,size:r.toPt(e.size)}}function s(e){return e.map(function(e){return o(e)})}function a(e){if("string"==typeof e||"number"==typeof e)return r.toPt(e);var t=e;return{type:"size",expression:t.expression,stops:s(t.stops)}}function u(e){var t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(i.Utils.isString(e.field)){if(!e.stops)return null;if(e.stops.length>8)return null;for(var r=e.stops,n=0;n<8;++n){var o=r[Math.min(n,r.length-1)];t.values[n]=o.value,t.opacities[n]=o.opacity}}else{if(!(e.stops&&e.stops.length>=0))return null;var s=e.stops&&e.stops.length>=0&&e.stops[0].opacity;for(n=0;n<8;n++)t.values[n]=1/0,t.opacities[n]=s}return t}Object.defineProperty(t,"__esModule",{value:!0});var l=i.enums.WGLVVFlag;t.getVisualVariableSizeValueRepresentationRatio=function(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e},t.stopToSizeStop=o,t.normalizeSizeStops=s,t.normalizeSizeElement=a,t.getVisualVariablesFields=function(e){var t=e&&e.length>0?{}:null;return t&&e.forEach(function(e){var r=e.type;e.field&&(t[r]=e.field)}),t},t.convertVisualVariables=function(e){var t=e&&e.length>0?{}:null,o=t?{}:null;if(!t)return{vvFields:t,vvRanges:o};for(var p=0,c=e;p<c.length;p++){var d=c[p],f=d.type;if(d.field&&(t[f]=d.field),"size"===f){o.size||(o.size={});var y=d;switch(i.getTypeOfSizeVisualVariable(y)){case l.SIZE_MINMAX_VALUE:o.size.minMaxValue={minDataValue:y.minDataValue,maxDataValue:y.maxDataValue,minSize:a(y.minSize),maxSize:a(y.maxSize)};break;case l.SIZE_SCALE_STOPS:o.size.scaleStops={stops:s(y.stops)};break;case l.SIZE_FIELD_STOPS:for(var h=[],m=[],v=s(y.stops),g=v.length,b=0;b<6;b++){var _=v[Math.min(b,g-1)];h.push(_.value),m.push(r.pt2px(_.size))}o.size.fieldStops={values:h,sizes:m};break;case l.SIZE_UNIT_VALUE:o.size.unitValue={unit:y.valueUnit,valueRepresentation:y.valueRepresentation}}}else if("color"===f){var w=n.convertVisualVariables([d],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null});for(o.color=w.color,b=0;b<32;b+=4)i.color.premultiplyAlpha(o.color.colors,b,!0)}else if("opacity"===f)o.opacity=u(d);else if("rotation"===f){var x=d;o.rotation={type:x.rotationType}}}return{vvFields:t,vvRanges:o}}}.apply(null,i))||(e.exports=n)},1518:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(14),r(17),r(261),r(561),r(40),r(256),r(39),r(35),r(559),r(362),r(71),r(1463),r(94),r(94),r(1462)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,p,c,d,f,y,h,m){function v(e,t,r,o,a){var u,l,p=i.pt2px(r.xoffset),c=i.pt2px(r.yoffset),d=O*r.angle,f=O*a;switch(r.type){case"simple-marker":var y=r;u=l=i.pt2px(y.size);break;case"picture-marker":var h=r;u=i.pt2px(h.width),l=i.pt2px(h.height)}var m=n.mat2d.identity(C);n.mat2d.translate(m,m,s.vec2.set(P,e,t)),n.mat2d.rotate(m,m,f-d),n.mat2d.scale(m,m,s.vec2.set(P,o,-o)),n.mat2d.translate(m,m,s.vec2.set(P,p,-c));var v=[0,0];s.vec2.transformMat2d(v,s.vec2.set(P,-.5*u,-.5*l),m);var g=[0,0];s.vec2.transformMat2d(g,s.vec2.set(P,-.5*u,.5*l),m);var b=[0,0];s.vec2.transformMat2d(b,s.vec2.set(P,.5*u,-.5*l),m);var _=[0,0];return s.vec2.transformMat2d(_,s.vec2.set(P,.5*u,.5*l),m),{rings:[[v,b,_,g,v]]}}function g(e,t,r,o,a){var u=m.CIMSymbolHelper.getEnvelope(r.data);if(!u)return null;var l=i.pt2px(u.width),p=i.pt2px(u.height),c=i.pt2px(u.x),d=i.pt2px(u.y),f=0*O,y=O*a,h=n.mat2d.identity(C);n.mat2d.translate(h,h,s.vec2.set(P,e,t)),n.mat2d.rotate(h,h,y-f),n.mat2d.scale(h,h,s.vec2.set(P,o,-o)),n.mat2d.translate(h,h,s.vec2.set(P,c,-d));var v=[0,0];s.vec2.transformMat2d(v,s.vec2.set(P,-.5*l,-.5*p),h);var g=[0,0];s.vec2.transformMat2d(g,s.vec2.set(P,-.5*l,.5*p),h);var b=[0,0];s.vec2.transformMat2d(b,s.vec2.set(P,.5*l,-.5*p),h);var _=[0,0];return s.vec2.transformMat2d(_,s.vec2.set(P,.5*l,.5*p),h),{rings:[[v,b,_,g,v]]}}function b(e,t,r,o,a,u){var l=m.alignmentUtils.getYAnchorDirection(r.verticalAlignment||"baseline"),p="baseline"===(r.verticalAlignment||"baseline"),c=i.pt2px(r.xoffset),d=i.pt2px(r.yoffset),f=i.pt2px(r.font.size)/24,y=4*f,h=p?25*f:o[1]+(1+l)*o[3]*.5,v=O*r.angle,g=O*u,b=n.mat2d.identity(C);n.mat2d.translate(b,b,s.vec2.set(P,e,t)),n.mat2d.rotate(b,b,g-v),n.mat2d.scale(b,b,s.vec2.set(P,a,-a)),n.mat2d.translate(b,b,s.vec2.set(P,c,-d)),n.mat2d.translate(b,b,s.vec2.set(P,-y,-y-h));var _=[0,0];s.vec2.transformMat2d(_,s.vec2.set(P,o[0],o[1]),b);var w=[0,0];s.vec2.transformMat2d(w,s.vec2.set(P,o[0],o[1]+o[3]),b);var x=[0,0];s.vec2.transformMat2d(x,s.vec2.set(P,o[0]+o[2],o[1]),b);var F=[0,0];return s.vec2.transformMat2d(F,s.vec2.set(P,o[0]+o[2],o[1]+o[3]),b),{rings:[[_,x,F,w,_]]}}function _(e,t,r){if(!r||0===r.glyphMosaicItems.length)return e;var n=m.bidiText(t.text),o=n[0],s=n[1],a=m.alignmentUtils.getJustification(t.horizontalAlignment||"center"),u=m.alignmentUtils.getXAnchorDirection(t.horizontalAlignment||"center"),l=r.glyphMosaicItems,p=new m.TextShapingNew([l],m.definitions.TEXT_MAX_WIDTH,m.definitions.TEXT_LINE_HEIGHT,m.definitions.TEXT_SPACING,[0,.5*-j],.5*(1-u),0,a).getShaping(o,s),c=m.fontUtils.getFontDecorationTop(t.font.decoration);isNaN(c)||m.TextShapingNew.addDecoration(p,c);var d=m.TextShapingNew.getBox(p),f=i.pt2px(t.font.size)/L;return e[0]=f*d.x,e[1]=f*d.y,e[2]=f*d.width,e[3]=f*d.height,e}function w(e,t,r,i,n,o,s){var a;switch(i.type){case"simple-marker":case"picture-marker":a=v(t,r,i,o,0);break;case"text":a=b(t,r,i,n,o,0);break;case"cim":a=g(t,r,i,o,0)}for(var u,l,p=0,c=0;c<a.rings[0].length-1;c++)u=(t-(l=a.rings[0][c])[0])*(t-l[0])+(r-l[1])*(r-l[1]),p=Math.max(p,u);p=Math.sqrt(p);var d=f.normalizeMapX(t-p,s),y=f.normalizeMapX(t+p,s);if(d>y){var m=h.getInfo(s);if(m){var _=m.valid;d=_[0],y=_[1]}}return e[0]=d,e[1]=r-p,e[2]=y,e[3]=r+p,e}function x(e,t){return Math.ceil((e-t)/(2*t))}function F(e,t){var r,i=t.valid,n=i[0],o=i[1],s=2*o,a=0;return e>o?(e-=(r=Math.ceil(Math.abs(e-o)/s))*s,a=r):e<n&&(e+=(r=Math.ceil(Math.abs(e-n)/s))*s,a=-r),{x:e,frameId:a}}function S(e,t){var r=t.xmin,i=t.ymin,n=t.xmax,o=t.ymax;return I(e,r,i)&&I(e,r,o)&&I(e,n,o)&&I(e,n,i)}function I(e,t,r){return t>=e.xmin&&t<=e.xmax&&r>=e.ymin&&r<=e.ymax}function T(e,t,r){var i;if(Array.isArray(e)){if((i=e[0])>t){var n=x(i,t);e[0]=i+n*(-2*t)}else if(i<r){n=x(i,r);e[0]=i+n*(-2*r)}}else if((i=e.x)>t){n=x(i,t);e.x+=n*(-2*t)}else if(i<r){n=x(i,r);e.x+=n*(-2*r)}return e}Object.defineProperty(t,"__esModule",{value:!0});var O=Math.PI/180,M=m.definitions.TEXT_MAX_WIDTH,j=m.definitions.TEXT_LINE_HEIGHT,E=m.definitions.TEXT_SPACING,C=o.mat2df32.create(),P=a.vec2f32.create(),R=l.create();t.ensureClosedRings=function(e){if(d.isPolygon(e))for(var t=0,r=e.rings;t<r.length;t++){var i=r[t];i.length<3||i[0][0]===i[i.length-1][0]&&i[0][1]===i[i.length-1][1]||i.push(i[0])}},t.getBounds=function(e,t,r,i,n,o,s,a){if(!i||!r)return e[0]=e[1]=e[2]=e[3]=0,t[0]=t[1]=t[2]=t[3]=0,e;var u=i;if(!d.isPoint(u)){p.getBoundsXY(e,u);var l=t[0];0===l&&(l=function(e,t){var r=0;switch(e.type){case"simple-fill":case"picture-fill":var i=e.outline;if(!i)return 0;r=i.width;break;case"simple-line":r=e.width;break;case"simple-marker":r=e.size;break;case"picture-marker":r=Math.max(e.width,e.height);break;case"text":var n=[0,0,0,0];_(n,e,t),r=Math.max(n[0],n[1]);break;case"cim":var o=m.CIMSymbolHelper.getEnvelope(e.data);r=Math.sqrt(o.width*o.width+o.height*o.height)}return r}(r,n),t[0]=l);var c=o*l/2;return e[0]-=c,e[1]-=c,e[2]+=c,e[3]+=c,e}var f=u.x,y=u.y;return"text"===r.type&&0===t[2]&&0===t[3]&&_(t,r,n),w(e,f,y,r,t,o,a),e},t.isMarkerSymbol=function(e){return"simple-marker"===e||"picture-marker"===e||"text"===e},t.graphicGeometryToNumber=function(e){switch(r.expect(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0};var k=a.vec2f32.create(),D=a.vec2f32.create(),A=a.vec2f32.create(),B=a.vec2f32.create(),q=a.vec2f32.create(),N=a.vec2f32.create(),z=a.vec2f32.create();t.isPointOnPolyline=function(e,t,r,i){s.vec2.set(A,t,r);for(var n,o,a,u,l,p,c,d,f,y=e.paths,h=1/0,m=0;m<y.length;m++){var v=y[m];if(!(v.length<2))for(var g=1;g<v.length;g++)n=v[g-1][0],a=v[g-1][1],o=v[g][0],u=v[g][1],l=Math.min(n,o)-i,p=Math.min(a,u)-i,c=Math.max(n,o)+i,d=Math.max(a,u)+i,t<l||t>c||r<p||r>d||(s.vec2.set(k,n,a),s.vec2.set(D,o,u),s.vec2.subtract(B,D,k),s.vec2.subtract(q,k,A),s.vec2.scale(N,B,s.vec2.dot(B,q)/s.vec2.dot(B,B)),s.vec2.subtract(z,q,N),h>(f=s.vec2.dot(z,z))&&(h=f))}return Math.sqrt(h)<=i},t.getMarkerSymbolBounds=v,t.getCIMMarkerBounds=g,t.getTextSymbolBounds=b,t.normalizeCentralMeridian=function(e){var t,r,i,n,o,s,a,u,l=null;if(!e)return null;t=e.spatialReference,r=y.getInfo(t),i=t.isWebMercator,n=G[s=i?102100:4326].maxX,o=G[s].minX,a=G[s].plus180Line,u=G[s].minus180Line;var f,h=e.toJSON();if(!r)return h;if("mesh"===e.type)f=h;else if(d.isPoint(h))f=T(h,n,o);else if(d.isMultipoint(h))h.points=h.points.map(function(e){return T(e,n,o)}),f=h;else if(d.isExtent(h))f=function(e,t){if(!t)return e;var r=function(e,t){var r,i=[],n=e.ymin,o=e.ymax,s=e.xmax-e.xmin,a=e.xmin,u=e.xmax,l=t.valid,p=l[0],c=l[1],d=(r=F(e.xmin,t)).x,f=r.frameId,y=(r=F(e.xmax,t)).x,h=r.frameId,m=d===y&&s>0;if(s>2*c){var v={xmin:a<u?d:y,ymin:n,xmax:c,ymax:o},g={xmin:p,ymin:n,xmax:a<u?y:d,ymax:o},b={xmin:0,ymin:n,xmax:c,ymax:o},_={xmin:p,ymin:n,xmax:0,ymax:o},w=[],x=[];S(v,b)&&w.push(f),S(v,_)&&x.push(f),S(g,b)&&w.push(h),S(g,_)&&x.push(h);for(var I=f+1;I<h;I++)w.push(I),x.push(I);i.push({extent:v,frameIds:[f]},{extent:g,frameIds:[h]},{extent:b,frameIds:w},{extent:_,frameIds:x})}else d>y||m?i.push({extent:{xmin:d,ymin:n,xmax:c,ymax:o},frameIds:[f]},{extent:{xmin:p,ymin:n,xmax:y,ymax:o},frameIds:[h]}):i.push({extent:{xmin:d,ymin:n,xmax:y,ymax:o},frameIds:[f]});return i}(e,t).map(function(e){return e.extent});return r.length<2?r[0]||e:r.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:r.map(function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]})}}(h,r);else if(d.isPolygon(h)||d.isPolyline(h)){var m=R;p.getBoundsXY(m,h);var v={xmin:m[0],ymin:m[1],xmax:m[2],ymax:m[3]},g=x(v.xmin,o)*(2*n),b=0===g?h:function(e,t){for(var r=0,i=function(e){return d.isPolygon(e)?e.rings:e.paths}(e);r<i.length;r++)for(var n=0,o=i[r];n<o.length;n++){var s=o[n];s[0]+=t}return e}(h,g);v.xmin+=g,v.xmax+=g,c.extentIntersectsPolyline(v,a)&&v.xmax!==n?l=b:c.extentIntersectsPolyline(v,u)&&v.xmin!==o?l=b:f=b}else f=e.clone();return null!==l?(new U).cut(l,n):f};var L=24;t.getTextSymbolSize=_,t.getTextSymbolEstimatedSize=function(e,t,r){var n=m.bidiText(t.text),o=n[0],s=n[1],a=m.alignmentUtils.getJustification(t.horizontalAlignment||"center"),u=m.alignmentUtils.getXAnchorDirection(t.horizontalAlignment||"center"),l=new m.TextShapingNew([],M,j,E,[0,.5*-j],.5*(1-u),0,a).getEstimatedShaping(o,s,r),p=m.TextShapingNew.getBox(l),c=i.pt2px(t.font.size)/L;return e[0]=c*p.x,e[1]=c*p.y,e[2]=c*p.width,e[3]=c*p.height,e};var G={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:{paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator},minus180Line:{paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:u.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:u.WGS84}}},U=function(){function e(){}return e.prototype.cut=function(e,t){var r;if(e.rings)this.closed=!0,r=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,r=e.paths,this.minPts=2}for(var i=r.length,n=-2*t,o=0;o<i;o++){var s=r[o];if(s&&s.length>=this.minPts){for(var a=[],u=0,l=s;u<l.length;u++){var p=l[u];a.push([p[0]+n,p[1]])}r.push(a)}}return this.closed?e.rings=r:e.paths=r,e},e}()}.apply(null,i))||(e.exports=n)},1527:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(12),r(52),r(8),r(154)],void 0===(n=function(e,t,r,i,n,o,s){Object.defineProperty(t,"__esModule",{value:!0}),t.loadStyleRenderer=function(e,t,a){return i(this,void 0,void 0,function(){var i,u,l;return r(this,function(r){switch(r.label){case 0:return(i=e&&e.getAtOrigin&&e.getAtOrigin("renderer",t.origin))&&"unique-value"===i.type&&i.styleOrigin?[4,n.result(i.populateFromStyle())]:[3,2];case 1:u=r.sent(),o.throwIfAborted(a),!1===u.ok&&(l=u.error,t&&t.messages&&t.messages.push(new s("renderer:style-reference","Failed to create unique value renderer from style reference: "+l.message,{error:l,context:t})),e.clear("renderer",t.origin)),r.label=2;case 2:return[2]}})})}}.apply(null,i))||(e.exports=n)},1528:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(6),r(13),r(0),r(548),r(106)],void 0===(n=function(e,t,r,i,n,o,s,a,u){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return r(t,e),n=t,t.fromWorker=function(e){if(!e)return null;var t=JSON.parse(e),r=new n;return r.fields=t.fields&&t.fields.map(function(e){return a.fromJSON(e)}),r.options=t.options,r.process=new(Function.bind.apply(Function,[void 0].concat(t.process.args,[t.process.body]))),r},Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new n(o.clone({fields:this.fields,options:this.options,process:this.process}))},t.prototype.getField=function(e){return u.getField(this.fields,e)},t.prototype.refresh=function(){this.notifyChange("version")},t.prototype.toWorker=function(){var e=this.process.toString();return JSON.stringify({fields:this.fields,options:this.options,process:{body:e.substring(e.indexOf("{")+1,e.lastIndexOf("}")),args:e.slice(e.indexOf("(")+1,e.indexOf(")")).match(/([^\s,]+)/g)}})},i([s.property({type:[a]})],t.prototype,"fields",void 0),i([s.property()],t.prototype,"options",void 0),i([s.property()],t.prototype,"process",void 0),i([s.property({readOnly:!0,dependsOn:["process","options","fields"]})],t.prototype,"version",null),n=i([s.subclass("esri.layers.support.FeatureProcessing")],t)}(s.declared(n))}.apply(null,i))||(e.exports=n)},1529:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(369),r(354),r(572),r(367),r(568)],void 0===(n=function(e,t,r,i,n,o,s,a){function u(e,t){var r=e;if(t.ignoreFieldTypes&&(e=e.filter(function(e){return-1===t.ignoreFieldTypes.indexOf(e.type)})),0===e.length)return null;var i=t.maximumFields&&e.length>t.maximumFields;return i&&(e=e.slice(0,t.maximumFields)),e===r&&(e=e.slice()),e.sort(l),{fields:e,limitExceeded:i}}function l(e,t){return"oid"===e.type?-1:"oid"===t.type?1:d(e)?-1:d(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function p(e){return e.map(function(e){return new s({fieldName:e.name,label:e.alias,format:function(e){switch(e.type){case"small-integer":case"integer":case"single":return new a({digitSeparator:!0,places:0});case"double":return new a({digitSeparator:!0,places:2});case"date":return new a({dateFormat:"long-month-day-year"});default:return null}}(e),visible:!0})})}function c(e){var t=[new o.FieldsContent,new o.AttachmentsContent];return e&&t.push(new o.TextContent({text:"<small>"+i.tooManyFields+"</small>"})),t}function d(e){return"name"===(e.name&&e.name.toLowerCase())||"name"===(e.alias&&e.alias.toLowerCase())||void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.createPopupTemplate=function(e,t){var i=e.fields,o=e.title;if(!i)return null;var s=u(i,r({},f,t));if(!s)return null;var a=function(e,t){for(var r=0,i=t;r<i.length;r++){var n=i[r];if(d(n))return e+": {"+n.name+"}"}return e}(o,s.fields),l=c(s.limitExceeded),y=p(s.fields);return new n({title:a,content:l,fieldInfos:y})};var f={ignoreFieldTypes:["geometry","blob","raster","guid","xml"],maximumFields:75}}.apply(null,i))||(e.exports=n)},1540:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(206),r(6),r(0),r(1541),r(106)],void 0===(n=function(e,t,r,i,n,o,s,a,u){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeExtent=null,t.useViewTime=!0,t}return r(t,e),Object.defineProperty(t.prototype,"timeInfo",{set:function(e){u.fixTimeInfoFields(e,this.fields),this._set("timeInfo",e)},enumerable:!0,configurable:!0}),i([s.property({type:n,json:{write:!1}})],t.prototype,"timeExtent",void 0),i([s.property({value:null,type:a,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),i([s.property({type:Boolean,json:{write:!1}})],t.prototype,"useViewTime",void 0),i([s.subclass("esri.layers.mixins.TemporalLayer")],t)}(s.declared(o))}.apply(null,i))||(e.exports=n)},1541:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(206),r(1542),r(9),r(13),r(0),r(1543),r(557)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,p){return function(e){function t(t){var r=e.call(this)||this;return r.cumulative=!1,r.endField=null,r.hasLiveData=!1,r.interval=null,r.offset=null,r.startField=null,r.timeReference=null,r.fullTimeExtent=null,r.trackIdField=null,r.useTime=!0,r}var s;return r(t,e),s=t,t.prototype.readInterval=function(e,t){return t.timeInterval&&t.timeIntervalUnits?new o({value:t.timeInterval,unit:p.timeUnitKebabDictionary.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new o({value:t.defaultTimeInterval,unit:p.timeUnitKebabDictionary.fromJSON(t.defaultTimeIntervalUnits)}):null},t.prototype.writeInterval=function(e,t){if(e){var r=e.toJSON();t.timeInterval=r.value,t.timeIntervalUnits=r.unit}else t.timeInterval=null,t.timeIntervalUnits=null},t.prototype.readOffset=function(e,t){var r=t.exportOptions.timeOffset,i=p.timeUnitKebabDictionary.fromJSON(t.exportOptions.timeOffsetUnits);return r&&i?new o({value:r,unit:i}):null},t.prototype.writeOffset=function(e,t){if(t.exportOptions||(t.exportOptions={}),e){var r=e.toJSON();t.exportOptions.timeOffset=r.value,t.exportOptions.timeOffsetUnits=r.unit}else t.exportOptions.timeOffset=null,t.exportOptions.timeOffsetUnits=null},t.prototype.readFullTimeExtent=function(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;var r=t.timeExtent[0],i=t.timeExtent[1];return new n({start:r,end:i})},t.prototype.writeFullTimeExtent=function(e,t,r){e&&e.start&&e.end?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null},t.prototype.clone=function(){var e=this,t=e.cumulative,r=e.endField,i=e.hasLiveData,n=e.interval,o=e.offset,u=e.startField,l=e.timeReference,p=e.fullTimeExtent,c=e.trackIdField,d=e.useTime;return new s({cumulative:t,endField:r,hasLiveData:i,interval:n,offset:o,startField:u,timeReference:a.clone(l),fullTimeExtent:a.clone(p),trackIdField:c,useTime:d})},i([u.property({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],t.prototype,"cumulative",void 0),i([u.property({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],t.prototype,"endField",void 0),i([u.property({type:Boolean,json:{write:!0}})],t.prototype,"hasLiveData",void 0),i([u.property({type:o,json:{write:{enabled:!0,allowNull:!0}}})],t.prototype,"interval",void 0),i([u.reader("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],t.prototype,"readInterval",null),i([u.writer("interval")],t.prototype,"writeInterval",null),i([u.property({type:o,json:{write:{enabled:!0,allowNull:!0}}})],t.prototype,"offset",void 0),i([u.reader("offset",["exportOptions.timeOffset","exportOptions.timeOffset"])],t.prototype,"readOffset",null),i([u.writer("offset")],t.prototype,"writeOffset",null),i([u.property({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],t.prototype,"startField",void 0),i([u.property({type:l,json:{write:{enabled:!0,allowNull:!0}}})],t.prototype,"timeReference",void 0),i([u.property({type:n,json:{write:{enabled:!0,allowNull:!0}}})],t.prototype,"fullTimeExtent",void 0),i([u.reader("fullTimeExtent",["timeExtent"])],t.prototype,"readFullTimeExtent",null),i([u.writer("fullTimeExtent")],t.prototype,"writeFullTimeExtent",null),i([u.property({type:String,json:{write:{enabled:!0,allowNull:!0}}})],t.prototype,"trackIdField",void 0),i([u.property({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],t.prototype,"useTime",void 0),s=i([u.subclass("esri.layers.support.TimeInfo")],t)}(u.declared(s))}.apply(null,i))||(e.exports=n)},1542:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(9),r(0),r(557)],void 0===(n=function(e,t,r,i,n,o,s){return function(e){function t(t){var r=e.call(this)||this;return r.value=0,r.unit="milliseconds",r}var n;return r(t,e),n=t,t.prototype.toMilliseconds=function(){return this.value*s.millisecondsPerTimeUnit[this.unit]},t.prototype.clone=function(){return new n({value:this.value,unit:this.unit})},i([o.property({type:Number,json:{write:!0},nonNullable:!0})],t.prototype,"value",void 0),i([o.property({type:s.timeUnitKebabDictionary.apiValues,json:{type:s.timeUnitKebabDictionary.jsonValues,read:s.timeUnitKebabDictionary.read,write:s.timeUnitKebabDictionary.write},nonNullable:!0})],t.prototype,"unit",void 0),n=i([o.subclass("esri.TimeInterval")],t)}(o.declared(n))}.apply(null,i))||(e.exports=n)},1543:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(9),r(0)],void 0===(n=function(e,t,r,i,n,o){return function(e){function t(t){var r=e.call(this)||this;return r.respectsDaylightSaving=!1,r.timezone=null,r}var n;return r(t,e),n=t,t.prototype.readRespectsDaylightSaving=function(e,t){return void 0!==t.respectsDaylightSaving?t.respectsDaylightSaving:void 0!==t.respectDaylightSaving&&t.respectDaylightSaving},t.prototype.clone=function(){var e=this.respectsDaylightSaving,t=this.timezone;return new n({respectsDaylightSaving:e,timezone:t})},i([o.property({type:Boolean,json:{write:!0}})],t.prototype,"respectsDaylightSaving",void 0),i([o.reader("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],t.prototype,"readRespectsDaylightSaving",null),i([o.property({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],t.prototype,"timezone",void 0),n=i([o.subclass("esri.layers.support.TimeReference")],t)}(o.declared(n))}.apply(null,i))||(e.exports=n)},1546:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(12),r(15),r(22),r(11),r(24),r(14),r(8),r(553),r(169),r(546),r(1462),r(1545),r(1517),r(551),r(153)],void 0===(n=function(e,t,i,n,o,s,a,u,l,p,c,d,f,y,h,m){Object.defineProperty(t,"__esModule",{value:!0});var v=(f.enums.PixelType,a.getLogger("esri.views.layers.2d.features.support.AttributeStore")),g=y.debug.createDebugLogger(y.debug.DEBUG_ATTR_UPDATES,v),b=function(e,t){return function(r,i,n){var o;try{o=t(r,i,n)}catch(e){o=NaN}return(null===o||isNaN(o)||o===1/0)&&e||o}},_={sharedArrayBuffer:s("esri-shared-array-buffer"),oesTextureFloat:s("esri-webgl-texture-float"),maxTextureSize:s("esri-webgl-max-texture-size")},w=function(){function e(e,t,r,i){this.texelSize=4,this.descriptors=[];var n=i.pixelType,o=i.layout;this.data=this._initData(n,r,e,t),this.pixelType=n,this.layout=o,this._resetRange(),this._shared=e,this._ctype=t}return Object.defineProperty(e.prototype,"buffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),e.prototype.getData=function(e,t){return this.data[e*this.texelSize+t]},e.prototype.setData=function(e,t,r){var i=1<<t;0!=(this.layout&i)?(this.data[e*this.texelSize+t]=r,this.dirtyStart=Math.min(this.dirtyStart,e),this.dirtyEnd=Math.max(this.dirtyEnd,e)):v.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")},e.prototype.expand=function(e){var t=this._initData(this.pixelType,e,this._shared,this._ctype);t.set(this.data),this.data=t},e.prototype.toMessage=function(){var e=this.dirtyStart,t=this.dirtyEnd,r=this.texelSize;if(e>t)return null;this._resetRange();var i=!(this._shared||"local"===this._ctype),n=this.pixelType,o=this.layout;return this.data.slice?{start:e,end:t,data:i&&this.data.slice(e*r,(t+1)*r)||null,pixelType:n,layout:o}:i?{start:e,end:t,data:new(y.Utils.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,e*r,(t+1)*r)),pixelType:n,layout:o}:{start:e,end:t,data:null,pixelType:n,layout:o}},e.prototype._initData=function(e,t,r,i){for(var n=r&&"local"!==i?SharedArrayBuffer:ArrayBuffer,o=y.Utils.getPixelArrayCtor(e),s=new o(new n(t*t*4*o.BYTES_PER_ELEMENT)),a=0;a<s.length;a+=4)s[a+1]=255;return s},e.prototype._resetRange=function(){this.dirtyStart=this.data.length/4,this.dirtyEnd=0},e}(),x=function(){function e(e){this._attributeComputeMap=new Map,this._blocks=new Array,this._idMap=new Map,this._localToObjectId=new Map,this._filters=new Array(y.definitions.MAX_FILTERS),this._freeList=[],this._abortController=p.createAbortController(),this._hasScaleExpr=!1,this._size=32,this._idCounter=0;var t=_.oesTextureFloat?5126:5121;g("Creating AttributeStore "+(_.sharedArrayBuffer?"with":"without")+" shared memory"),this._client=e,this._blockDescriptors=[{pixelType:5121,layout:7},{pixelType:t,layout:15},{pixelType:t,layout:15}],this._blocks=this._blockDescriptors.map(function(e){return null})}return e.prototype.destroy=function(){this._abortController.abort()},Object.defineProperty(e.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!0,configurable:!0}),e.prototype.createLocalId=function(e){if(!this._idMap.has(e)){var t=this._getFreeId();this._idMap.set(e,-1===t?0:t),this._localToObjectId.set(t,e)}return this._idMap.get(e)},e.prototype.freeLocalId=function(e){var t=this._idMap.get(e);this._idMap.delete(e),this._localToObjectId.delete(t),this._freeList.push(t)},e.prototype.getFeatureId=function(e){return this._localToObjectId.get(e)},e.prototype.getLocalId=function(e){return this._idMap.has(e)?this._idMap.get(e):null},e.prototype.updateFilters=function(e){return n(this,void 0,void 0,function(){var t,r,n,o,s,a,u=this;return i(this,function(i){switch(i.label){case 0:return t=e.config,r=e.service,n=e.spatialReference,o=t.filters,s=t.definitionExpression,a=o.map(function(t,i){return u._updateFilter(e,t,i,r,s,n)}),[4,p.all(a)];case 1:return i.sent(),[2]}})})},e.prototype.setAttributeBindings=function(e,t){return n(this,void 0,void 0,function(){return i(this,function(r){switch(this._hasScaleExpr=!1,e.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":return[2,this._bindVVEvaluators(e.visualVariables,t)];case"dot-density":return[2,this._bindDDEvaluators(e.attributes,t)];case"heatmap":break;default:v.error(new o("attribute-store","Found invalid renderer type: "+e))}return[2]})})},e.prototype.setData=function(e,t,r,i){this._getBlock(t).setData(e,r,i)},e.prototype.setAttributeData=function(e,t,r,i){var n=this,o=e;this._getBlock(0).setData(o,0,this._getFilterFlags(t));var s=this._attributeComputeMap,a=_.oesTextureFloat?1:2;s.forEach(function(e,s){var l=s*a%4,p=Math.floor(s*a/4),c=n._getBlock(p+1),d=e(t,{$view:i},r);if(_.oesTextureFloat)c.setData(o,l,d);else if(d===y.definitions.NAN_MAGIC_NUMBER)c.setData(o,l,255),c.setData(o,l+1,255);else{var f=u.clamp(Math.round(d),-32767,32766)+32768,h=255&f,m=(65280&f)>>8;c.setData(o,l,h),c.setData(o,l+1,m)}})},e.prototype.sendUpdates=function(){var e=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=p.createResolver(),this._nextUpdate.promise;var t={blocks:this._blocks.map(function(e){return l.isSome(e)?e.toMessage():null})};return this._currUpdate=this._createResources().then(function(){var r=e._client.update(t,e._signal).then(function(){if(e._currUpdate=null,e._nextUpdate){var t=e._nextUpdate;e._nextUpdate=null,e.sendUpdates().then(function(){return t.resolve()})}});return e._client.render(),r}),this._currUpdate},e.prototype._createResources=function(){var e=this;if(l.isSome(this._createResourcesPromise))return this._createResourcesPromise;g("Initializing AttributeStore");var t={shared:_.sharedArrayBuffer||"local"===this._client.type,size:this._size,blocks:l.mapMany(this._blocks,function(e){return{buffer:e.buffer,pixelType:e.pixelType}})},r=this._client.initialize(t,this._signal);return this._createResourcesPromise=r,r.then(function(){if(l.isNone(e._createResourcesPromise))return e._createResources()}),r},e.prototype._getBlock=function(e){var t=this._blocks[e];if(l.isSome(t))return t;g("Initializing AttributeBlock at index "+e);var r=_.sharedArrayBuffer,i=this._client.type,n=new w(r,i,this._size,this._blockDescriptors[e]);return this._blocks[e]=n,this._createResourcesPromise=null,n},e.prototype._expand=function(){if(this._size<_.maxTextureSize){var e=this._size<<=1;return g("Expanding block size to",e,this._blocks),l.forEachSome(this._blocks,function(t){return t.expand(e)}),this._createResourcesPromise=null,this._size=e,0}return v.error(new o("mapview-limitations","Maximum number of onscreen features exceeded.")),-1},e.prototype._getFreeId=function(){return this._freeList.length?this._freeList.pop():this._idCounter>=this._size*this._size&&this._expand()?-1:this._idCounter++},e.prototype._updateFilter=function(e,t,r,o,s,a){return n(this,void 0,void 0,function(){var n,u,p,c,d,f,y,h=this;return i(this,function(i){switch(i.label){case 0:return n=this._filters[r],(l.isSome(n)&&n.hash)===JSON.stringify(t)?[2]:(u=1<<r,l.isNone(t)?(this._filters[r]=null,this._idMap.forEach(function(e){var t=h._getBlock(0).getData(e,0);h._getBlock(0).setData(e,0,t|u)}),[2]):[4,e.queryObjectIds(t)]);case 1:return p=i.sent(),t.hiddenIds&&t.hiddenIds.length&&(p=p.filter(function(e){return-1===t.hiddenIds.indexOf(e)})),c=p.map(function(e){return h._idMap.get(e)}),[4,this._getFilter(r,o)];case 2:for(i.sent().update(t,s,a),this._idMap.forEach(function(e){var t=h._getBlock(0).getData(e,0);h._getBlock(0).setData(e,0,t&~u)}),d=0;d<c.length;d++)null!=(f=c[d])&&(y=this._getBlock(0).getData(f,0),this._getBlock(0).setData(f,0,y|u));return[2]}})})},e.prototype._getFilter=function(e,t){return n(this,void 0,void 0,function(){var n,o,s;return i(this,function(i){switch(i.label){case 0:return n=this._filters[e],l.isSome(n)?[2,n]:[4,new Promise(function(e,t){Promise.all([r.e(2),r.e(65)]).then(function(){var t=[r(1645)];e.apply(null,t)}.bind(this)).catch(t.bind(this))})];case 1:return o=i.sent().default,s=new o({geometryType:t.geometryType,hasM:!1,hasZ:!1,timeInfo:t.timeInfo,fieldsIndex:new c(t.fields)}),this._filters[e]=s,[2,s]}})})},e.prototype._getFilterFlags=function(e){for(var t=0,r=0;r<this._filters.length;r++){var i=this._filters[r];t|=(l.isNone(i)||i.check(e)?1:0)<<r}return t},e.prototype._bindVVEvaluators=function(e,t){return n(this,void 0,void 0,function(){var r=this;return i(this,function(o){switch(o.label){case 0:return this._attributeComputeMap.clear(),l.isSome(e)?[4,p.all(e.map(function(e){return n(r,void 0,void 0,function(){var r,n;return i(this,function(i){switch(i.label){case 0:return r=y.Utils.getVVType(e.type),[4,this._createGetValueFunction(e,t)];case 1:return n=i.sent(),l.isSome(n)&&this._attributeComputeMap.set(r,n),[2]}})})}))]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},e.prototype._bindDDEvaluators=function(e,t){return n(this,void 0,void 0,function(){var r,n,o,s=this;return i(this,function(i){switch(i.label){case 0:return this._attributeComputeMap.clear(),e.length>y.definitions.DOT_DENSITY_MAX_FIELDS&&v.warn("mapview-invalid-value","DotDensityRenderer supports a maximum of "+y.definitions.DOT_DENSITY_MAX_FIELDS+" attribtues, but found "+e.length),[4,p.all(e.map(function(e){return s._createNormalizedFunction(e,t)}))];case 1:for(r=i.sent().map(function(e){return b(0,e)}),n=0;n<y.definitions.DOT_DENSITY_MAX_FIELDS;n++)(o=n<e.length&&r[n])?this._attributeComputeMap.set(n,o):this._attributeComputeMap.has(n)&&this._attributeComputeMap.delete(n);return[2]}})})},e.prototype._createGetValueFunction=function(e,t){return n(this,void 0,void 0,function(){var r,n,o,s,a,u,l;return i(this,function(i){switch(i.label){case 0:return"size"!==e.type?[3,2]:(r=y.getTypeOfSizeVisualVariable(e))===y.enums.WGLVVFlag.SIZE_SCALE_STOPS?[2,null]:(n=r===y.enums.WGLVVFlag.SIZE_UNIT_VALUE,o=n&&function(t){return m.getVisualVariableSizeValueRepresentationRatio(t,e.valueRepresentation)},s=b,a=[y.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(e,t,o)]);case 1:return[2,s.apply(void 0,a.concat([i.sent()]))];case 2:return u=b,l=[y.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(e,t)];case 3:return[2,u.apply(void 0,l.concat([i.sent()]))]}})})},e.prototype._createNormalizedFunction=function(e,t,r){return n(this,void 0,void 0,function(){var n,s,a;return i(this,function(i){switch(i.label){case 0:return(n=e.field)?"string"==typeof n?(s=e.normalizationField)?[2,function(e){if(e.attributes[n]&&e.attributes[s]){var t=e.attributes[n]/e.attributes[s];return r?r(t):t}}]:[2,r?function(e){return r(e.attributes[n])}:function(e){return e.attributes[n]}]:(v.error(new o("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof n)),[2,function(e){}]):e.valueExpression?(this._hasScaleExpr=this._hasScaleExpr||-1!==e.valueExpression.indexOf("scale"),[4,d.createVVExpression(e.valueExpression,t.spatialReference,t.fields)]):[3,2];case 1:return a=i.sent(),[2,h.callWithOptimizedFeature.bind(null,a)];case 2:return v.error("Unable to create a normalized function for visual variable: "+e),[2,function(e){}]}})})},e}();t.default=x}.apply(null,i))||(e.exports=n)},1571:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(9),r(0)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=null,t}return r(t,e),i([o.property({type:["selection"],readOnly:!0,json:{read:!1,write:!0}})],t.prototype,"type",void 0),i([o.subclass("esri.layers.support.FeatureReduction")],t)}(o.declared(n));t.FeatureReduction=s,t.default=s}.apply(null,i))||(e.exports=n)},1572:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(151),r(11),r(548),r(106)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var s=i.getLogger("esri.layers.support.fieldProperties");t.defineFieldProperties=function(){return{fields:{type:[n],value:null},outFields:{type:[String],dependsOn:["fields"],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){var e=this._userOutFields;if(!e||!e.length)return null;if(r.includes(e,"*"))return["*"];if(!this.fields)return e;for(var t=0,i=e;t<i.length;t++){var n=i[t];o.hasField(this.fields,n)||s.error("field-attributes-layer:invalid-field","Invalid field "+n+" found in outFields",{layer:this,outFields:e})}return o.fixFields(this.fields,e)}}}}}.apply(null,i))||(e.exports=n)},1592:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(26),r(9),r(13),r(0)],void 0===(n=function(e,t,r,i,n,o,s,a){var u=new n.default({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});return function(e){function t(t){var r=e.call(this,t)||this;return r.name=null,r.description=null,r.drawingTool=null,r.prototype=null,r.thumbnail=null,r}return r(t,e),t.prototype.writeDrawingTool=function(e,t){t.drawingTool=u.toJSON(e)},t.prototype.writePrototype=function(e,t){t.prototype=s.fixJson(s.clone(e),!0)},t.prototype.writeThumbnail=function(e,t){t.thumbnail=s.fixJson(s.clone(e))},i([a.property({json:{write:!0}})],t.prototype,"name",void 0),i([a.property({json:{write:!0}})],t.prototype,"description",void 0),i([a.property({json:{read:u.read,write:u.write}})],t.prototype,"drawingTool",void 0),i([a.writer("drawingTool")],t.prototype,"writeDrawingTool",null),i([a.property({json:{write:!0}})],t.prototype,"prototype",void 0),i([a.writer("prototype")],t.prototype,"writePrototype",null),i([a.property({json:{write:!0}})],t.prototype,"thumbnail",void 0),i([a.writer("thumbnail")],t.prototype,"writeThumbnail",null),i([a.subclass("esri.layers.support.FeatureTemplate")],t)}(a.declared(o))}.apply(null,i))||(e.exports=n)},1611:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(10),r(12),r(2),r(7),r(6),r(15),r(345),r(22),r(11),r(14),r(8),r(0),r(1532),r(1504),r(1505),r(1528),r(553),r(356),r(565),r(344),r(1462),r(1546),r(1612)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,p,c,d,f,y,h,m,v,g,b,_,w,x,F,S,I){Object.defineProperty(t,"__esModule",{value:!0});var T=c.getLogger("esri.views.2d.layers.features.controllers.BaseController");t.needsGeometry=function(e,t){switch(e){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryMultipoint":return!0;case"esriGeometryPolygon":return function(e){var t=e&&e.getSymbols();return"backgroundFillSymbol"in e&&null!=e.backgroundFillSymbol||t.some(function(e){return"simple-fill"===e.type||"picture-fill"===e.type})}(t);default:return T.error(new u("mapview-invalid-type",e+" is not supported")),!1}};var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._processingInMainThread=!1,t._availableFields=[],t._pixelBuffer=0,t.config=null,t.processor=null,t.remoteClient=null,t.service=null,t.tileStore=null,t.filters=new Array(F.definitions.MAX_FILTERS),t}return o(t,e),t.prototype.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])},t.prototype.startup=function(){return n(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return this._initAttributeStore(),[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)];case 1:return e.sent(),[4,f.all([this.attributeStore.updateFilters(this),this.updatePixelBuffer()])];case 2:return e.sent(),[2]}})})},t.prototype.destroy=function(){this.attributeStore.destroy()},Object.defineProperty(t.prototype,"arcadeInfo",{get:function(){return{geometryType:this.service.geometryType,fields:this.service.fields,spatialReference:this.spatialReference}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldsIndex",{get:function(){return new b(this.service.fields)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geometryInfo",{get:function(){return{geometryType:this.service.geometryType,hasZ:!1,hasM:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"returnCentroid",{get:function(){return this._get("returnCentroid")||function(e,t,r){function i(e){if(!e)return!1;var t=e.type;return"simple-marker"===t||"picture-marker"===t||"text"===t||"web-style"===t}if("esriGeometryPolygon"===t&&e.labelingInfo)return!0;if("esriGeometryPolygon"!==t)return!1;switch(r.type){case"simple":return i(r.symbol);case"unique-value":return i(r.defaultSymbol)||r.uniqueValueInfos.some(function(e){return i(e.symbol)});case"class-breaks":return i(r.defaultSymbol)||r.classBreakInfos.some(function(e){return i(e.symbol)});default:return!0}}(this.config,this.service.geometryType,this.renderer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryInfo",{get:function(){var e=null;if("heatmap"!==this.renderer.type){var t=this.renderer.visualVariables;t&&t.some(function(t){if("size"===t.type&&t.field&&!t.normalizationField)return e=[t.field+" DESC"],!0})}return{returnCentroid:this.returnCentroid,returnGeometry:!0,outFields:this.availableFields,orderByFields:e,definitionExpression:this.config.definitionExpression,gdbVersion:this.config.gdbVersion,historicMoment:this.config.historicMoment}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this.config?_.fromJSON(this.config.renderer):(T.error("mapview-controller","Unable to create renderer for undefined configuration"),null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return g.fromWorker(this.config.processing)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availableFields",{get:function(){var e=this,t=this.config.availableFields.filter(function(t){return-1===e._availableFields.indexOf(t)});return this._availableFields=this._availableFields.concat(t),this._availableFields},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spatialReference",{get:function(){return this.tileStore.tileScheme.spatialReference},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewParams",{get:function(){return{viewingMode:"",scale:this.viewState&&this.viewState.scale||1}},enumerable:!0,configurable:!0}),t.prototype.getObjectId=function(e){return this.attributeStore.getFeatureId(e)},t.prototype.getLocalId=function(e){return this.attributeStore.getLocalId(e)},t.prototype.mapValidLocalIds=function(e){var t=this;return e.map(function(e){return t.attributeStore.getLocalId(e)}).filter(function(e){return null!=e})},t.prototype.setViewState=function(e){this._set("viewState",e)},t.prototype.updatePixelBuffer=function(){return n(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,I.computePxBuffer(this.renderer,this.service.geometryType)];case 1:return e=t.sent(),this._pixelBuffer=Math.max(this._pixelBuffer,e),[2]}})})},t.prototype.validateConfig=function(e,t){for(var r=0,i=e.filters;r<i.length;r++){var n=i[r];if(d.isSome(n)&&n.where)try{h.validateWhere(this.fieldsIndex,n.where)}catch(e){throw new u("mapview-bad-filter",e.message,{filter:n,missingFields:e.details})}}},t.prototype.onFeatureAdd=function(e){e.localId=this.attributeStore.createLocalId(e.objectId),this.attributeStore.setAttributeData(e.localId,e,this.geometryInfo,this.viewParams)},t.prototype.onFeatureRemove=function(e){!e.localId&&p("esri-2d-debug")&&console.debug("Feature must have localId"),this.attributeStore.freeLocalId(e.objectId)},t.prototype.enableEvent=function(e){},t.prototype._initAttributeStore=function(){var e=this;this.attributeStore=new S.default(s({type:"remote"},"heatmap"===this.renderer.type?{initialize:function(e,t){return f.resolve()},update:function(e,t){return f.resolve()},render:function(){return f.resolve()}}:{initialize:function(t,r){return e.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",t,{signal:r})},update:function(t,r){return e.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",t,{signal:r})},render:function(){return e.remoteClient.invoke("tileRenderer.featuresView.requestRender")}}))},t.prototype._createQueryEngine=function(e){void 0===e&&(e=this._createFeatureStore());var t=this.queryInfo,r=t.definitionExpression,i=t.gdbVersion,n=t.historicMoment;return new v.default({definitionExpression:r,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,gdbVersion:i,historicMoment:null!=n&&new Date(n),featureStore:e,timeInfo:this.service.timeInfo})},t.prototype._createTempQueryEngine=function(e){return void 0===e&&(e=this._createFeatureStore(!1)),this._createQueryEngine(e)},t.prototype._createFeatureStore=function(e){void 0===e&&(e=!0);var t={geometryType:this.service.geometryType,hasM:!1,hasZ:!1};if(e){var r=this.onFeatureAdd.bind(this),i=this.onFeatureRemove.bind(this);return new m.default(t,r,i)}return new m.default(t)},t.prototype._createDefaultQuery=function(e){var t=this,r=new x;r.outSpatialReference=this.spatialReference;var i=e.outFields,n=e.orderByFields,o=this.config,s=o.gdbVersion,a=o.historicMoment,u=o.definitionExpression;return this.processing&&(i=i&&i.filter(function(e){return!t.processing.getField(e)}),n=n&&n.filter(function(e){return!t.processing.getField(e)})),i=i.length/this.service.fields.length>=.75?["*"]:i,r.gdbVersion=s,r.historicMoment=null!=a?new Date(a):null,r.outFields=i,r.where=u||"1=1",r.returnGeometry=e.returnGeometry,r.returnCentroid=e.returnCentroid,r.orderByFields=n,r.start=e.resultOffset,r.num=e.num,r},t.prototype._createQuery=function(e,t,r,i,n,o){var s=this.service.geometryType,a=this._createDefaultQuery(i);return a.maxRecordCountFactor=n,a.returnExceededLimitFeatures=o,a.resultType="tile",a.geometry=e,this.service.capabilities.query.supportsQuantization?(a.quantizationParameters=new w.default({mode:"view",originPosition:"upper-left",tolerance:r,extent:t}),"esriGeometryPolyline"===s&&(a.maxAllowableOffset=r)):"esriGeometryPolyline"!==s&&"esriGeometryPolygon"!==s||(a.maxAllowableOffset=r),a},t.prototype._applyProcessing=function(e,t){var r=this.processing;if(!r)return f.resolve(e);if(this._processingInMainThread)return this.remoteClient.invoke("executeProcessing",{featureSet:e},t);try{var i=r.process(e,r.options);return i?"then"in i?i:f.resolve(i):f.reject(new u("FeatureLayer","invalid processing.process() method, returns nothing"))}catch(r){return this._processingInMainThread=!0,this.remoteClient.invoke("executeProcessing",{featureSet:e},t)}},t.prototype.hasGeometryFilter=function(){return this.filters.some(function(e){return d.isSome(e)&&!!e.geometry})},r([y.property({readOnly:!0,dependsOn:["config","service","spatialReference"]})],t.prototype,"arcadeInfo",null),r([y.property()],t.prototype,"config",void 0),r([y.property({readOnly:!0,dependsOn:["service"]})],t.prototype,"fieldsIndex",null),r([y.property({readOnly:!0,dependsOn:["service"]})],t.prototype,"geometryInfo",null),r([y.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"returnCentroid",null),r([y.property({readOnly:!0,dependsOn:["config","availableFields"]})],t.prototype,"queryInfo",null),r([y.property({dependsOn:["config"],readOnly:!0})],t.prototype,"renderer",null),r([y.property()],t.prototype,"processor",void 0),r([y.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"processing",null),r([y.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"availableFields",null),r([y.property({constructOnly:!0})],t.prototype,"remoteClient",void 0),r([y.property({constructOnly:!0})],t.prototype,"service",void 0),r([y.property({dependsOn:["tileStore"]})],t.prototype,"spatialReference",null),r([y.property({constructOnly:!0})],t.prototype,"tileInfo",void 0),r([y.property({constructOnly:!0})],t.prototype,"tileStore",void 0),r([y.property()],t.prototype,"filters",void 0),r([y.property({readOnly:!0})],t.prototype,"viewState",void 0),r([y.property({readOnly:!0,dependsOn:["viewState"]})],t.prototype,"viewParams",null),r([y.subclass("esri.views.2d.layers.features.controllers.BaseController")],t)}(y.declared(a,l));t.default=O}.apply(null,i))||(e.exports=n)},1612:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(12),r(8),r(17),r(1462),r(1518)],void 0===(n=function(e,t,r,i,n,o,s,a){function u(e,t){return null==e?t:e}function l(e,t){return i(this,void 0,void 0,function(){var i,n,o,p,d,f,g,b,_,w,x;return r(this,function(r){switch(r.label){case 0:return"simple-marker"===e.type?(i=Math.max(u(e.size,12),t),[2,c(e)+i*y]):"picture-marker"===e.type?(n=Math.max(u(e.height,12),t),o=u(e.width,12)*(n/u(e.height,12)),p=o/2,d=n/2,[2,c(e)+Math.sqrt(p*p+d*d)]):"text"===e.type?(a.getTextSymbolEstimatedSize(h,e,s.definitions.AVERAGE_GLYPH_MOSAIC_ITEM),f=h[2]*(u(e.horizontalAlignment,"top")in m?1:.5),g=h[3]*(u(e.horizontalAlignment,"center")in v?1:.5),b=function(e,t){return null==e.font?t:u(e.font.size,t)}(e,9),_=Math.max(b,t)/b,[2,c(e)+Math.sqrt(f*f+g*g)*_]):"simple-line"===e.type?[2,Math.max(u(e.width,.75),t)/2]:"simple-fill"===e.type||"picture-fill"===e.type?[2,Math.max(function(e,t){return null==e.outline?t:u(e.outline.width,t)}(e,.75),t)/2]:"cim"===e.type?(w=s.CIMSymbolHelper.getEnvelope(e.data))?[2,Math.sqrt(w.width*w.width+w.height*w.height)]:[2,0]:"web-style"!==e.type?[3,2]:(x=l,[4,e.fetchCIMSymbol()]);case 1:return[2,x.apply(void 0,[r.sent(),t])];case 2:return[2]}})})}function p(e,t){return i(this,void 0,void 0,function(){var i,n,o,s,a;return r(this,function(r){switch(r.label){case 0:return function(e){return e.type in f}(e)?(n=(i=Math).min,s=(o=Math).max,a=[5],[4,l(e,t)]):[2,0];case 1:return[2,n.apply(i,[s.apply(o,a.concat([r.sent()])),75])]}})})}function c(e){var t=u(e.xoffset,0),r=u(e.yoffset,0);return Math.sqrt(t*t+r*r)}function d(e,t){return Math.max(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var f={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,"picture-fill":1,cim:1,"web-style":1},y=.707;t.computePxBuffer=function(e,t){return i(this,void 0,void 0,function(){var i,s,a,u,l,c,f;return r(this,function(r){switch(r.label){case 0:if("heatmap"===e.type)return[2,Math.round(3*e.blurRadius)];if("dot-density"===e.type)return[2,0];if("dictionary"===e.type)return"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?[2,100]:[2,50];for(i=e.getSymbols(),s=function(e){if(!("visualVariables"in e))return 0;if(!e.hasVisualVariables("size"))return 0;var t=e.getVisualVariablesForType("size");if(!t[0])return 0;var r=t[0];return"stops"===r.transformationType?r.stops.map(function(e){return e.size}).reduce(d,0):"clamped-linear"===r.transformationType?"number"==typeof r.maxSize?r.maxSize:r.maxSize.stops.map(function(e){return e.size}).reduce(d,0):"real-world-size"===r.transformationType?30:void 0}(e),a=[],u=0,l=i;u<l.length;u++)c=l[u],a.push(p(c,s));return[4,n.all(a)];case 1:return f=r.sent(),[2,o.pt2px(f.reduce(d,0))]}})})};var h=[0,0,0,0],m={left:1,right:1},v={top:1,bottom:1,baseline:1}}.apply(null,i))||(e.exports=n)},1636:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(0),r(1571)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="selection",t}return r(t,e),i([n.property({type:["selection"]})],t.prototype,"type",void 0),i([n.subclass("esri.layers.support.FeatureReductionSelection")],t)}(n.declared(o.default));t.FeatureReductionSelection=s,t.default=s}.apply(null,i))||(e.exports=n)},1637:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(567)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=/\[([^\[\]]+)\]/gi;t.reader=function(e,t,n){var o=this;return e?e.map(function(e){var s=new r;if(s.read(e,n),s.labelExpression){var a=t.fields||t.layerDefinition&&t.layerDefinition.fields||o.fields;s.labelExpression=s.labelExpression.replace(i,function(e,t){return"["+function(e,t){if(!t)return e;for(var r=e.toLowerCase(),i=0;i<t.length;i++){var n=t[i].name;if(n.toLowerCase()===r)return n}return e}(t,a)+"]"})}return s}):null}}.apply(null,i))||(e.exports=n)},1691:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(12),r(7),r(84),r(15),r(13),r(8),r(1463)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l){function p(e,t){return i(this,void 0,void 0,function(){var i;return r(this,function(r){return i="'addFeatures', 'updateFeatures' or 'deleteFeatures' parameter is required",t&&(t.addFeatures||t.deleteFeatures||t.updateFeatures||t.addFeatures.length||t.deleteFeatures.length||t.updateFeatures.length)?((t=n({},t)).addFeatures=t.addFeatures||[],t.updateFeatures=t.updateFeatures||[],t.deleteFeatures=t.deleteFeatures||[],t.addFeatures=t.addFeatures.map(d),t.updateFeatures=t.updateFeatures.map(d),[2,c(t)]):[2,u.reject(new s(e.type+"-layer:missing-parameters",i))]})})}function c(e){return i(this,void 0,void 0,function(){var t,i,n,o,s,a;return r(this,function(r){switch(r.label){case 0:return t=e.addFeatures,i=e.updateFeatures,n=t.concat(i).map(function(e){return e.geometry}),[4,l.normalizeCentralMeridian(n)];case 1:return o=r.sent(),s=t.length,a=i.length,o.slice(0,s).forEach(function(t,r){e.addFeatures[r].geometry=t}),o.slice(s,s+a).forEach(function(t,r){e.updateFeatures[r].geometry=t}),[2,e]}})})}function d(e){var t=new o;return e.attributes||(e.attributes={}),t.geometry=e.geometry,t.attributes=e.attributes,t}Object.defineProperty(t,"__esModule",{value:!0}),t.isEditableLayer=function(e){return!0===e.get("capabilities.operations.supportsEditing")},t.applyEdits=function(e,t){return i(this,void 0,void 0,function(){var i,n,o,l,c,d,f,y,h;return r(this,function(r){switch(r.label){case 0:return o={edits:t,result:u.create(function(e,t){i=e,n=t})},e.emit("apply-edits",o),[4,e.load()];case 1:return r.sent(),function(e){return e&&null!=e.applyEdits}(l=e.source)?e.editingEnabled?[4,p(e,t)]:[2,u.reject(new s(e.type+"-layer:editing-disabled","Editing is disabled for layer",{layer:e}))]:[2,u.reject(new s(e.type+"-layer:no-editing-support","Layer source does not support applyEdits capability",{layer:e}))];case 2:c=r.sent(),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,l.applyEdits(c)];case 4:return d=r.sent(),((y={addedFeatures:(f=function(e){return e.filter(function(e){return!e.error}).map(a.clone)})(d.addFeatureResults),updatedFeatures:f(d.updateFeatureResults),deletedFeatures:f(d.deleteFeatureResults)}).addedFeatures.length||y.updatedFeatures.length||y.deletedFeatures.length)&&e.emit("edits",y),i(y),[2,d];case 5:throw h=r.sent(),n(h),h;case 6:return[2]}})})}}.apply(null,i))||(e.exports=n)},1692:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(7),r(10),r(12),r(42),r(84),r(6),r(29),r(15),r(22),r(135),r(11),r(14),r(8),r(350),r(349),r(0),r(27),r(592),r(1406),r.dj.m(e)],void 0===(n=function(e,t,i,n,o,s,a,u,l,p,c,d,f,y,h,m,v,g,b,_,w,x,F,S){Object.defineProperty(t,"__esModule",{value:!0});var I=0,T=h.getLogger("esri.layers.graphics.sources.MemorySource"),O=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e._idToClientGraphic=null,e.type="memory",e}return i(o,t),o.prototype.load=function(e){var t=m.isSome(e)?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),this.when()},Object.defineProperty(o.prototype,"workerGeometryType",{get:function(){var e=this.layer&&this.layer.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null},enumerable:!0,configurable:!0}),o.prototype.applyEdits=function(e){var t=this;return this.load().then(function(){return t._applyEdits(e)})},o.prototype.openPorts=function(){var e=this;return this.load().then(function(){return e._connection.openPorts()})},o.prototype.queryFeatures=function(e,t){var r=this;return void 0===t&&(t={}),this.load(t).then(function(){return r._connection.invoke("queryFeatures",e?e.toJSON():null,t)}).then(function(e){var t=F.fromJSON(e);if(!r._requiresClientGraphicMapping())return t;for(var i=r.layer.objectIdField,n=0,o=t.features;n<o.length;n++){var s=o[n],a=s.attributes[i],u=r._idToClientGraphic.get(a);u&&(s.geometry=u.geometry)}return t.geometryType=r.layer.geometryType,t})},o.prototype.queryFeaturesJSON=function(e,t){var r=this;return void 0===t&&(t={}),this._requiresClientGraphicMapping()?v.reject(new d("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)")):this.load(t).then(function(){return r._connection.invoke("queryFeatures",e?e.toJSON():null,t)})},o.prototype.queryFeatureCount=function(e,t){var r=this;return void 0===t&&(t={}),this.load(t).then(function(){return r._connection.invoke("queryFeatureCount",e?e.toJSON():null,t)})},o.prototype.queryObjectIds=function(e,t){var r=this;return void 0===t&&(t={}),this.load(t).then(function(){return r._connection.invoke("queryObjectIds",e?e.toJSON():null,t)})},o.prototype.queryExtent=function(e,t){var r=this;return void 0===t&&(t={}),this.load(t).then(function(){return r._connection.invoke("queryExtent",e?e.toJSON():null,t)}).then(function(e){return{count:e.count,extent:u.Extent.fromJSON(e.extent)}})},o.prototype._applyEdits=function(e){var t=this;if(!this._connection)throw new d("feature-layer-source:edit-failure","Memory source not loaded");var r=this.layer.objectIdField,i=null,n=[],o=[];if(e.addFeatures&&(i=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(var s=0,a=e.deleteFeatures;s<a.length;s++){"objectId"in(p=a[s])&&null!=p.objectId?n.push(p.objectId):"attributes"in p&&null!=p.attributes[r]&&n.push(p.attributes[r])}if(e.updateFeatures)for(var u=0,l=e.updateFeatures;u<l.length;u++){var p=l[u];o.push(this._serializeFeature(p))}return this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:o,deletes:n}).then(function(e){var r=e.fullExtent,n=e.featureEditResults;if(t.fullExtent=r,i&&i.finish(n.uidToObjectId),t._idToClientGraphic)for(var o=0,s=n.deleteResults;o<s.length;o++){var a=s[o];a.success&&t._idToClientGraphic.delete(a.objectId)}return t._createEditsResult(n)})},o.prototype._createEditsResult=function(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[]}},o.prototype._createFeatureEditResult=function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new d("feature-layer-source:edit-failure",t.description,{code:t.code}):null}},o.prototype._prepareAddFeatures=function(e){for(var t=new Map,r=new Array(e.length),i=null,n=0;n<e.length;n++){var o=e[n],s=this._serializeFeature(o);!i&&m.isSome(o.geometry)&&(i=o.geometry.type),r[n]=s,t.set(""+s.uid,o)}var a=this;return{features:r,inferredGeometryType:i,finish:function(e){var r=a.layerDefinition.objectIdField;for(var i in e){var n=e[i],o=t.get(i);o&&(o.attributes||(o.attributes={}),-1===n?delete o.attributes[r]:o.attributes[r]=n,a._addIdToClientGraphic(o))}}}},o.prototype._addIdToClientGraphic=function(e){if(this._idToClientGraphic){var t=this.layerDefinition.objectIdField,r=e.attributes&&e.attributes[t];null!=r&&this._idToClientGraphic.set(r,e)}},o.prototype._requiresClientGraphicMapping=function(){var e=this.layer.geometryType||this.layerDefinition.geometryType;return this._geometryTypeRequiresClientGraphicMapping(e)},o.prototype._geometryRequiresClientGraphicMapping=function(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)},o.prototype._geometryTypeRequiresClientGraphicMapping=function(e){return"mesh"===e||"multipatch"===e||"extent"===e},o.prototype._serializeFeature=function(e){var t=e.attributes,r=this._geometryForSerialization(e),i=(I++).toString();return r?{uid:i,geometry:r.toJSON(),attributes:t}:{uid:i,attributes:t}},o.prototype._geometryForSerialization=function(e){var t=e.geometry;return m.isNone(t)?null:this._geometryRequiresClientGraphicMapping(t)?u.Polygon.fromExtent(t.extent):t},o.prototype._startWorker=function(t){return a(this,void 0,void 0,function(){var i,n,o,a,l,p,c,d,y,h,m,_,w,x,F,I;return s(this,function(s){switch(s.label){case 0:return f("esri-webpack")?[4,v.create(function(e){return Promise.all([r.e(2),r.e(5),r.e(69)]).then(function(){var t=[r(1856)];e.apply(null,t)}.bind(this)).catch(r.oe)})]:[3,2];case 1:s.sent(),s.label=2;case 2:return i=this,[4,b.open(g.getAbsMid("./support/MemorySourceWorker",e,S),{strategy:f("esri-workers-for-memory-layers")?"dedicated":"local",signal:t})];case 3:return i._connection=s.sent(),n=this.layer,o=n.fields,a=n.spatialReference,l=n.objectIdField,p=n.hasM,c=n.hasZ,d=n.timeInfo,y="defaults"===this.layer.originOf("spatialReference"),h=this._prepareAddFeatures(this.items),this.on("before-changes",function(e){T.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),e.preventDefault()}),m={features:h.features,fields:o&&o.map(function(e){return e.toJSON()}),geometryType:u.typeKebabDictionary.toJSON(this.workerGeometryType),hasM:p,hasZ:c,objectIdField:l,spatialReference:y?null:a&&a.toJSON(),timeInfo:d?d.toJSON():null},[4,this._connection.invoke("load",m,{signal:t})];case 4:for(_=s.sent(),w=0,x=_.warnings;w<x.length;w++)F=x[w],T.warn(F.message,{layer:this.layer});return _.featureErrors.length&&T.warn("Encountered "+_.featureErrors.length+" validation errors while loading features",_.featureErrors),I=_.layerDefinition,this._geometryTypeRequiresClientGraphicMapping(h.inferredGeometryType)&&(I.geometryType=u.typeKebabDictionary.toJSON(h.inferredGeometryType)),this.layerDefinition=I,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),h.finish(_.assignedObjectIds),[2]}})})},n([x.shared({Type:l,ensureType:w.ensureType(l)})],o.prototype,"itemType",void 0),n([_.property()],o.prototype,"type",void 0),n([_.property({constructOnly:!0})],o.prototype,"layer",void 0),n([_.property({readOnly:!0,dependsOn:["layer.geometryType"]})],o.prototype,"workerGeometryType",null),n([_.property()],o.prototype,"layerDefinition",void 0),n([_.subclass("esri.layers.graphics.sources.MemorySource")],o)}(_.declared(p,c,y));t.MemorySource=O,t.default=O}.apply(null,i))||(e.exports=n)},1693:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(9),r(0)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){return e.call(this,t)||this}var n;return r(t,e),n=t,t.prototype.clone=function(){var e=this,t=e.name,r=e.fields,i=e.isAscending,o=e.isUnique,s=e.description;return new n({name:t,fields:r,isAscending:i,isUnique:o,description:s})},i([o.property({constructOnly:!0})],t.prototype,"name",void 0),i([o.property({constructOnly:!0})],t.prototype,"fields",void 0),i([o.property({constructOnly:!0})],t.prototype,"isAscending",void 0),i([o.property({constructOnly:!0})],t.prototype,"isUnique",void 0),i([o.property({constructOnly:!0})],t.prototype,"description",void 0),n=i([o.subclass("esri.layers.support.FeatureIndex")],t)}(o.declared(n));t.FeatureIndex=s,t.default=s}.apply(null,i))||(e.exports=n)},1694:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(9),r(13),r(0),r(380),r(1592)],void 0===(n=function(e,t,r,i,n,o,s,a,u){return function(e){function t(t){var r=e.call(this,t)||this;return r.id=null,r.name=null,r.domains=null,r.templates=null,r}return r(t,e),t.prototype.readDomains=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];switch(i.type){case"range":t[r]=a.RangeDomain.fromJSON(i);break;case"codedValue":t[r]=a.CodedValueDomain.fromJSON(i);break;case"inherited":t[r]=a.InheritedDomain.fromJSON(i)}}return t},t.prototype.writeDomains=function(e,t){var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]&&e[i].toJSON());o.fixJson(r),t.domains=r},t.prototype.readTemplates=function(e){return e&&e.map(function(e){return new u(e)})},t.prototype.writeTemplates=function(e,t){t.templates=e&&e.map(function(e){return e.toJSON()})},i([s.property({json:{write:!0}})],t.prototype,"id",void 0),i([s.property({json:{write:!0}})],t.prototype,"name",void 0),i([s.property({json:{write:!0}})],t.prototype,"domains",void 0),i([s.reader("domains")],t.prototype,"readDomains",null),i([s.writer("domains")],t.prototype,"writeDomains",null),i([s.property({json:{write:!0}})],t.prototype,"templates",void 0),i([s.reader("templates")],t.prototype,"readTemplates",null),i([s.writer("templates")],t.prototype,"writeTemplates",null),i([s.subclass("esri.layers.support.FeatureType")],t)}(s.declared(n))}.apply(null,i))||(e.exports=n)},1695:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(26),r(9),r(0)],void 0===(n=function(e,t,r,i,n,o,s){var a=new n.default({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"});return function(e){function t(t){var r=e.call(this,t)||this;return r.cardinality=null,r.id=null,r.keyField=null,r.name=null,r.relatedTableId=null,r}return r(t,e),i([s.property({json:{read:a.read,write:a.write}})],t.prototype,"cardinality",void 0),i([s.property({json:{read:!0,write:!0}})],t.prototype,"id",void 0),i([s.property({json:{read:!0,write:!0}})],t.prototype,"keyField",void 0),i([s.property({json:{read:!0,write:!0}})],t.prototype,"name",void 0),i([s.property({json:{read:!0,write:!0}})],t.prototype,"relatedTableId",void 0),i([s.subclass("esri.layers.support.Relationship")],t)}(s.declared(o))}.apply(null,i))||(e.exports=n)},1723:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(10),r(12),r(133),r(35),r(94),r(1505),r(1533)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l){function p(e,t,r,i,n,o,s,a){s&&!o?i.forEachInBounds(n,function(i){if(!t.has(i.objectId)){var n=l.getCentroid(r,i,a),o=i.attributes;n&&(t.add(i.objectId),e.push(new u.Feature(o,i.localId,null,n)))}}):o&&!s?i.forEachInBounds(n,function(i){if(!t.has(i.objectId)){var n=i.attributes,o=l.getGeometry(r,i,0,a);o&&(t.add(i.objectId),e.push(new u.Feature(n,i.localId,o,null)))}}):i.forEachInBounds(n,function(i){if(!t.has(i.objectId)){var n=i.attributes,o=l.getGeometry(r,i,0,a),s=l.getCentroid(r,i,a);o&&s&&(t.add(i.objectId),e.push(new u.Feature(n,i.localId,o,s)))}})}Object.defineProperty(t,"__esModule",{value:!0}),t.executeTileQueryForIds=function(e,t,r){var i=r.pixelBuffer*t.resolution,n=s.pad(t.bounds,i,s.create()),o=[];return e.featureStore.forEachInBounds(n,function(t){return o.push(e.featureAdapter.getObjectId(t))}),o},t.executeTileQuery=function(e,t,r){var i=r.returnGeometry,n=r.returnCentroid,u=r.pixelBuffer,l=new o.default,c=[],d=u*t.resolution,f=s.pad(t.bounds,d,s.create());if(p(c,l,e,e.featureStore,f,i,n,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]}),"esriGeometryPoint"===e.geometryType||n){var y=a.getInfo(e.spatialReference);if(y){var h=y.valid,m=h[0],v=h[1];if(f[0]<m){var g=s.fromValues(v-d,f[1],v,f[3]);p(c,l,e,e.featureStore,g,i,n,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[v,t.bounds[3]]})}if(f[2]>v){var b=s.fromValues(m,f[1],m+d,f[3]);p(c,l,e,e.featureStore,b,i,n,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[m-v+t.bounds[0],t.bounds[3]]})}}}return c.sort(function(t,r){return t.attributes[e.objectIdField]-r.attributes[e.objectIdField]}),{features:c,objectIds:l}}}.apply(null,i))||(e.exports=n)},2423:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(7),r(10),r(12),r(151),r(551),r(52),r(22),r(14),r(0),r(352),r(1723),r(2424),r(2426),r(1611),r(2428)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,p,c,d,f,y,h,m,v,g){Object.defineProperty(t,"__esModule",{value:!0});var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="stream",t._tileDispatchMap=new u.default,t._updateIntervalId=0,t}return r(t,e),t.prototype.initialize=function(){var e=this,t=this.service,r=t.source,i=t.objectIdField,n=t.timeInfo,o=t.maximumTrackPoints,s=t.purgeOptions,a=t.serviceFilter;this.connection=new m.default(r,this.spatialReference,a),this._set("store",new h.default(i,n,this.geometryInfo,o,s)),this.connection.on("feature",function(t){return e._onFeature(t)}),this.store.events.on("update",function(t){var r=t.addOrUpdated,i=t.removed;return e._onUpdate(r,i)}),["connectionStatus","errorString"].forEach(function(t){e.watch("connection."+t,function(r){return e.remoteClient.invoke("setProperty",{propertyName:t,value:r})})}),this._updateIntervalId=setInterval(function(){return e.store.checkForUpdates()},64),this._set("queryEngine",this._createQueryEngine(this.store)),this._shouldPushDataReceived=this.service.enableDataRecieved},t.prototype.destroy=function(){clearInterval(this._updateIntervalId),this.connection.destroy(),this.queryEngine.destroy(),this._tileDispatchMap.forEach(function(e){return e.destroy()})},Object.defineProperty(t.prototype,"updating",{get:function(){return this._tempQueryEngine&&!!this._tempQueryEngine.featureStore.numFeatures||this._anyUpdatesQueued()},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t){return s(this,void 0,void 0,function(){var r,i,n=this;return o(this,function(o){switch(o.label){case 0:return this.validateConfig(e,t),r=this.renderer.getAttributeHash(),this._set("config",e),[4,this.updatePixelBuffer()];case 1:return o.sent(),"heatmap"===this.renderer.type?[2]:r===this.renderer.getAttributeHash()?[3,3]:(i=this.queryEngine.featureStore,[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]);case 2:o.sent(),i.forEach(function(e){return n.attributeStore.setAttributeData(e.localId,e,n.geometryInfo,n.viewParams)}),o.label=3;case 3:return[4,this.attributeStore.updateFilters(this)];case 4:return o.sent(),[4,this.attributeStore.sendUpdates()];case 5:return o.sent(),[2]}})})},t.prototype.invalidate=function(){this._repushActiveTiles()},t.prototype.onEdits=function(e){},t.prototype.queryFeatures=function(e){return l.safeCast(this.queryEngine.executeQuery(e))},t.prototype.queryFeatureCount=function(e){return l.safeCast(this.queryEngine.executeQueryForCount(e))},t.prototype.queryObjectIds=function(e){return l.safeCast(this.queryEngine.executeQueryForIds(e))},t.prototype.queryExtent=function(e){return l.safeCast(this.queryEngine.executeQueryForExtent(e))},t.prototype.queryLatestObservations=function(e){return l.safeCast(this.queryEngine.executeQueryForLatestObservations(e))},t.prototype.redraw=function(){},t.prototype.refresh=function(){},t.prototype.setViewState=function(e){var t=this,r=this.viewState&&this.viewState.scale;this.inherited(arguments),r!==this.viewState.scale&&this.attributeStore.hasScaleExpr&&(this.queryEngine.featureStore.forEach(function(e){return t.attributeStore.setAttributeData(e.localId,e,t.geometryInfo,t.viewParams)}),this.attributeStore.sendUpdates())},t.prototype.onTileUpdate=function(e){var t=this,r=e.added;e.removed.forEach(function(e){return t._handleTileRemove(e)}),r.forEach(function(e){return t._handleTileAdd(e)})},t.prototype.enableEvent=function(e){"data-received"===e.name&&(this._shouldPushDataReceived=e.value)},t.prototype._onFeature=function(e){this._shouldPushDataReceived&&this.remoteClient.invoke("emitEvent",{name:"data-received",event:{attributes:e.attributes,centroid:e.centroid,geometry:e.geometry}});try{var t=this.geometryInfo,r=t.geometryType,i=t.hasM,n=t.hasZ,o=f.convertFromFeature(e,r,n,i,this.store.objectIdField);this.store.add(o)}catch(e){p("esri-2d-debug")&&console.debug(e)}},t.prototype._createStoreWithFeatures=function(e){if(c.isNone(e))return null;var t=this._createFeatureStore(!1);return t.addMany(e),t},t.prototype._onUpdate=function(e,t){var r=this;c.isSome(e)&&e.forEach(function(e){return r.onFeatureAdd(e)});var i=this._createStoreWithFeatures(e),n=this._createStoreWithFeatures(t);this.attributeStore.sendUpdates(),this.processor.supportsTileUpdates?this._updateActiveTiles(i,n):this._repushActiveTiles(),c.isSome(t)&&t.forEach(function(e){return r.onFeatureRemove(e)})},t.prototype._handleTileAdd=function(e){if(this._tileDispatchMap.has(e.id)){(t=this._tileDispatchMap.get(e.id)).up()}else{var t=new g.default;this._tileDispatchMap.set(e.id,t)}this._queryTileFeatures(e,!0,this.queryEngine)},t.prototype._handleTileRemove=function(e){this._tileDispatchMap.get(e.id).destroy(),this._tileDispatchMap.delete(e.id)},t.prototype._anyUpdatesQueued=function(){return a.from(this._tileDispatchMap).some(function(e){return e[0],e[1].hasAction()})},t.prototype._updateActiveTiles=function(e,t){for(var r=this,i=c.applySome(e,function(e){return r._createQueryEngine(e)}),n=c.applySome(t,function(e){return r._createQueryEngine(e)}),o=0,s=this.tileStore.tiles;o<s.length;o++){var a=s[o];this._queryTileFeatures(a,!1,i,n)}},t.prototype._repushActiveTiles=function(){for(var e=0,t=this.tileStore.tiles;e<t.length;e++){var r=t[e];this._queryTileFeatures(r,!0,this.queryEngine)}},t.prototype._queryTileFeatures=function(e,t,r,i){var n=this,o={hasZ:!1,hasM:!1,transform:{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]}},s=this.queryInfo,a={returnCentroid:s.returnCentroid,returnGeometry:s.returnGeometry,pixelBuffer:this._pixelBuffer},u=this._tileDispatchMap.get(e.id),l=c.applySome(r,function(t){return y.executeTileQuery(t,e,a)}),p=c.mapOr(l,[],function(e){return e.features}),d=c.mapOr(i,[],function(t){return y.executeTileQueryForIds(t,e,a)}).map(function(e){return n.attributeStore.getLocalId(e)});u.enqueue(function(r){return n.processor.onTileData(e,{addOrUpdate:p,remove:d,clear:t,transformParams:o},{signal:r})})},i([d.property()],t.prototype,"connection",void 0),i([d.property()],t.prototype,"service",void 0),i([d.property({readOnly:!0})],t.prototype,"store",void 0),i([d.property({readOnly:!0})],t.prototype,"queryEngine",void 0),i([d.property()],t.prototype,"updating",null),i([d.subclass("esri.views.2d.layers.features.controllers.StreamController")],t)}(d.declared(v.default));t.default=b}.apply(null,i))||(e.exports=n)},2424:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(5),r(2425),r(14),r(1504)],void 0===(n=function(e,t,r,i,n,o,s){Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_STREAM_ID_FIELD="__esri_stream_id__";var a=function(e){function r(r,i,n,s,a,u){void 0===u&&(u=128);var l=e.call(this,n)||this;return l._trackIdToObservations=new Map,l._idCounter=0,l._lastPurge=Date.now(),l._addOrUpdated=new Map,l._removed=[],l._maxAge=0,l._timeInfo=i,l._maximumTrackCount=s,l._purgeOptions=a,l.purgeInterval=u,l.objectIdField=o.unwrapOr(r,t.DEFAULT_STREAM_ID_FIELD),l._useGeneratedIds=l.objectIdField===t.DEFAULT_STREAM_ID_FIELD,l}return i(r,e),r.prototype.add=function(t){this._useGeneratedIds&&(t.attributes[this.objectIdField]=this._nextId(),t.objectId=t.attributes[this.objectIdField]),e.prototype.add.call(this,t),this._addOrUpdated.set(t.objectId,t);var r=t.attributes[this._timeInfo.trackIdField];this._trackIdToObservations.has(r)||this._trackIdToObservations.set(r,new n.default(this._maximumTrackCount)),this._maxAge=Math.max(this._maxAge,t.attributes[this._timeInfo.startTimeField]);var i=this._trackIdToObservations.get(r),s=t.attributes[this.objectIdField],a=i.enqueue(s);if(o.isSome(a)){var u=this.removeById(a);o.isSome(u)&&(this._addOrUpdated.has(a)?this._addOrUpdated.delete(a):this._removed.push(u))}},r.prototype.checkForUpdates=function(){var e=this._getToAdd(),t=this._getToRemove(),r=Date.now();r-this._lastPurge>=this.purgeInterval&&(this._purge(),this._lastPurge=r),(e||t)&&this.events.emit("update",{addOrUpdated:e,removed:t})},r.prototype._getToAdd=function(){if(!this._addOrUpdated.size)return null;var e=new Array(this._addOrUpdated.size),t=0;return this._addOrUpdated.forEach(function(r){return e[t++]=r}),this._addOrUpdated.clear(),e},r.prototype._getToRemove=function(){var e=this._removed;return this._removed.length?(this._removed=[],e):null},r.prototype._nextId=function(){var e=this._idCounter;return this._idCounter=(this._idCounter+1)%4294967294+1,e},r.prototype._purge=function(){var e=this._purgeOptions;o.isSome(e)&&(this._purgeSomeByDisplayCount(e),this._purgeByAge(e))},r.prototype._purgeSomeByDisplayCount=function(e){var t=this;if(e.displayCount){var r=this.numFeatures;r>e.displayCount&&this._trackIdToObservations.forEach(function(i,n){if(r>e.displayCount&&i.size){var s=t.removeById(i.dequeue());o.isSome(s)&&t._removed.push(s),r--}})}},r.prototype._purgeByAge=function(e){if(e.age){var t=60*e.age*1e3,r=this._maxAge-t,i=this._timeInfo.startTimeField;this.removeIf(this._removed,function(e){return e.attributes[i]<r})}},r}(s.default);t.default=a}.apply(null,i))||(e.exports=n)},2425:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.size=0,this._start=0,this.maxSize=e,this._buffer=new Array(e)}return e.prototype.enqueue=function(e){if(this.size===this.maxSize){var t=this._buffer[this._start];return this._buffer[this._start]=e,this._start=(this._start+1)%this.maxSize,t}return this._buffer[(this._start+this.size++)%this.maxSize]=e,null},e.prototype.dequeue=function(){if(0===this.size)throw new Error("Cannot dequeue from empty buffer");var e=this._buffer[this._start];return this.size--,this._start=(this._start+1)%this.maxSize,e},e}();t.default=r}.apply(null,i))||(e.exports=n)},2426:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(1),r(12),r(2),r(48),r(15),r(11),r(14),r(8),r(0),r(556),r(2427),r(1408),r(344)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,p,c,d,f,y,h){Object.defineProperty(t,"__esModule",{value:!0});var m,v=u.getLogger("esri.layers.graphics.sources.connections.GeoEventConnection");!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(m=t.ReadyState||(t.ReadyState={}));var g=function(e){function t(t,r,i,n,o,s){void 0===n&&(n=5),void 0===o&&(o=3);var a=e.call(this)||this;return a.errorString=null,a._source=t,a._spatialReference=r,a._filter=i,a._outFields=s,a._maxQueryDepth=n,a._maxRecordCountFactor=o,a._open(),a}return o(t,e),t.prototype._open=function(){return n(this,void 0,void 0,function(){var e,t,i,n;return r(this,function(r){switch(r.label){case 0:return[4,this._fetchServiceDefinition(this._source)];case 1:return(e=r.sent()).timeInfo.trackIdField?[4,this._fetchWebSocketUrl(e.streamUrls,this._spatialReference)]:(v.error(new a("geoevent-connection","Found an invalid GeoEvent service configuration. No TrackIdField found. Unable to establish WebSocket connection.")),[2]);case 2:return t=r.sent(),this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices()),[4,this._buddyServicesQuery];case 3:return r.sent(),[4,this._tryCreateWebSocket(t)];case 4:return r.sent(),i=this._filter,n=this._outFields,this._setFilter(i,n),[2]}})})},t.prototype.destroy=function(){l.isSome(this._websocket)&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close()),this._websocket=null},Object.defineProperty(t.prototype,"connectionStatus",{get:function(){if(l.isNone(this._websocket))return"disconnected";switch(this._websocket.readyState){case m.CONNECTING:case m.OPEN:return"connected";case m.CLOSING:case m.CLOSED:return"disconnected"}},enumerable:!0,configurable:!0}),t.prototype._tryCreateWebSocket=function(e,t){return void 0===t&&(t=1e3),n(this,void 0,void 0,function(){var i,n,o;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,4]),i=this,[4,this._createWebSocket(e)];case 1:return i._websocket=r.sent(),this.notifyChange("connectionStatus"),[3,4];case 2:return n=r.sent(),o=t/1e3,v.error(new a("geoevent-connection","Failed to connect. Attempting to reconnect in "+o+"s",n)),[4,p.after(t)];case 3:return r.sent(),[2,this._tryCreateWebSocket(e,1.5*t)];case 4:return[2]}})})},t.prototype._createWebSocket=function(e){var t=this,r=new WebSocket(e),i=p.create(function(e,t){r.onopen=function(){return e(r)},r.onclose=function(e){return t(e)}});return i.then(function(){r.onclose=function(e){return t._onClose(e)},r.onerror=function(e){return t._onError(e)},r.onmessage=function(e){return t._onMessage(e)}}),i},t.prototype._onMessage=function(e){var t;try{t=this._enrich(JSON.parse(e.data))}catch(e){return void v.error(new a("geoevent-connection","Failed to parse message",e))}this.onFeature(t)},t.prototype._onError=function(e){var t="Encountered an error over WebSocket connection";this._set("errorString",t),v.error("geoevent-connection",t)},t.prototype._onClose=function(e){this._websocket=null,this.notifyChange("connectionStatus"),1e3!==e.code&&v.error("geoevent-connection","WebSocket closed unexpectedly with error code "+e.code),this._open()},t.prototype._fetchServiceDefinition=function(e){return n(this,void 0,void 0,function(){var t,i;return r(this,function(r){switch(r.label){case 0:return[4,s(e,{query:{f:"json"},responseType:"json"})];case 1:return t=r.sent(),i=t.data,this._serviceDefinition=i,[2,i]}})})},t.prototype._fetchWebSocketUrl=function(e,t){return n(this,void 0,void 0,function(){var i,n,o;return r(this,function(r){return i=e[0],n=i.urls,o=i.token,[2,this._inferWebSocketBaseUrl(n)+"/subscribe?outSR="+t.wkid+(o?"&token="+o:"")]})})},t.prototype._inferWebSocketBaseUrl=function(e){if(1===e.length)return e[0];for(var t=0,r=e;t<r.length;t++){var i=r[t];if(-1!==i.indexOf("wss"))return i}return v.error(new a("geoevent-connection","Unable to infer WebSocket url",e)),null},t.prototype._setFilter=function(e,t){return n(this,void 0,void 0,function(){var i,n,o,s,u,c,d=this;return r(this,function(r){return i=this._websocket,this._filter=e,this._outFields=t,l.isNone(i)||l.isNone(e)&&l.isNone(t)?[2]:(n=JSON.stringify({filter:this._serializeFilter(e,t)}),o=!1,s=p.createResolver(),u=function(){o||(d._websocket===i&&v.error(new a("geoevent-connection","Server timed out when setting filter")),s.reject())},c=function(e){var t=JSON.parse(e.data);t.filter&&(t.error&&(v.error(new a("geoevent-connection","Failed to set service filter",t.error)),d._set("errorString","Could not set service filter - "+t.error),s.reject(t.error)),i.onmessage=d._onMessage.bind(d),o=!0,s.resolve())},i.onmessage=c,i.send(n),setTimeout(u,1e4),[2,s.promise])})})},t.prototype._serializeFilter=function(e,t){var r={};return l.isNone(e)&&l.isNone(t)?r:(l.isSome(e)&&e.geometry&&(r.geometry=JSON.stringify(e.geometry)),l.isSome(e)&&e.where&&(r.where=e.where),l.isSome(t)&&(r.outFields=t.join(",")),r)},t.prototype._enrich=function(e){if(!this._relatedFeatures)return e;var t=this._serviceDefinition.relatedFeatures.joinField,r=e.attributes[t];if(!this._relatedFeatures.has(r))return v.warn("geoevent-connection","Feature join failed. Is the join field configured correctly?",e),e;var i=this._relatedFeatures.get(r),n=i.attributes,o=i.geometry;for(var s in n)e.attributes[s]=n[s];return o&&(e.geometry=o),e.geometry||e.centroid||v.error(new a("geoevent-connection","Found malformed feature - no geometry found",e)),e},t.prototype._queryBuddyServices=function(){return n(this,void 0,void 0,function(){var e,t,i,n,o,s,u,l,p,c;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=this._serviceDefinition,t=e.relatedFeatures,i=e.keepLatestArchive,n=this._queryRelatedFeatures(t),o=this._queryArchive(i),[4,n];case 1:return r.sent(),[4,o];case 2:if(!(s=r.sent()))return[2];for(u=0,l=s.features;u<l.length;u++)p=l[u],this.onFeature(this._enrich(p));return[3,4];case 3:return c=r.sent(),v.error(new a("geoevent-connection","Encountered an error when querying buddy services",{error:c})),[3,4];case 4:return[2]}})})},t.prototype._queryRelatedFeatures=function(e){return n(this,void 0,void 0,function(){var t;return r(this,function(r){switch(r.label){case 0:return e?[4,this._queryBuddy(e.featuresUrl)]:[2];case 1:return t=r.sent(),this._addRelatedFeatures(t),[2]}})})},t.prototype._queryArchive=function(e){return n(this,void 0,void 0,function(){return r(this,function(t){return e?[2,this._queryBuddy(e.featuresUrl)]:[2]})})},t.prototype._queryBuddy=function(e){return n(this,void 0,void 0,function(){var t,i,n,o,s,a,u,p,c;return r(this,function(r){switch(r.label){case 0:return[4,(t=new d({url:e})).load()];case 1:return i=r.sent().capabilities,n=i.query.supportsMaxRecordCountFactor,o=i.query.supportsPagination,s=i.query.supportsCentroid,a=this._maxRecordCountFactor,u=n?t.maxRecordCount*a:t.maxRecordCount,(p=new h).outFields=l.unwrapOr(this._outFields,["*"]),p.where=l.unwrapOr(l.get(this._filter,"where"),"1=1"),p.returnGeometry=!0,p.returnExceededLimitFeatures=!0,p.outSpatialReference=this._spatialReference,s&&(p.returnCentroid=!0),n&&(p.maxRecordCountFactor=a),o?(p.num=u,t.destroy(),[2,this._queryPages(e,p)]):[4,y.executeQuery(e,p)];case 2:return c=r.sent(),t.destroy(),[2,c.data]}})})},t.prototype._queryPages=function(e,t,i,o){return void 0===i&&(i=[]),void 0===o&&(o=0),n(this,void 0,void 0,function(){var n;return r(this,function(r){switch(r.label){case 0:return t.start=o*t.num,[4,y.executeQuery(e,t)];case 1:return(n=r.sent().data).exceededTransferLimit&&o<this._maxQueryDepth?(n.features.forEach(function(e){return i.push(e)}),[2,this._queryPages(e,t,i,o+1)]):(i.forEach(function(e){return n.features.push(e)}),[2,n])}})})},t.prototype._addRelatedFeatures=function(e){for(var t=new Map,r=e.features,i=this._serviceDefinition.relatedFeatures.joinField,n=0,o=r;n<o.length;n++){var s=o[n],a=s.attributes[i];t.set(a,s)}this._relatedFeatures=t},i([c.property()],t.prototype,"connectionStatus",null),i([c.property()],t.prototype,"errorString",void 0),i([c.subclass("esri.layers.graphics.sources.connections.GeoEventConnection")],t)}(c.declared(f.default));t.default=g}.apply(null,i))||(e.exports=n)},2427:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(2),r(37),r(345),r(0)],void 0===(n=function(e,t,r,i,n,o,s){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onFeature=function(e){this.emit("feature",e)},r([s.subclass("esri.layers.graphics.sources.connections.StreamConnection")],t)}(s.declared(o,n));t.default=a}.apply(null,i))||(e.exports=n)},2428:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(8)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._action=null,this._queue=[],this._abortController=r.createAbortController(),this._refs=1}return e.prototype.up=function(){this._refs++},e.prototype.down=function(){return 0==--this._refs},e.prototype.clear=function(){this._abortController.abort(),this._abortController=r.createAbortController()},e.prototype.destroy=function(){this._queue.length=0,this._action&&(this._action=null)},e.prototype.enqueue=function(e){this._action?this._queue.push(e):this._setAction(e)},e.prototype.flush=function(){var e=this._action;if(!e)return r.resolve();var t=this._abortController.signal,i=this._queue.reduce(function(e,r){return e.then(function(){return r(t)})},e);return this._action=i.then(this._handleNext.bind(this)),this._queue.length=0,i},e.prototype.hasAction=function(){return!!this._action},e.prototype._setAction=function(e){var t=this._abortController.signal;this._action=e(t).then(this._handleNext.bind(this))},e.prototype._handleNext=function(){this._queue.length?this._setAction(this._queue.shift()):this._action=null},e}();t.default=i}.apply(null,i))||(e.exports=n)},556:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(2),r(1),r(119),r(10),r(12),r(354),r(358),r(48),r(69),r(52),r(29),r(15),r(20),r(26),r(11),r(14),r(203),r(8),r(31),r(0),r(36),r(170),r(39),r(118),r(1691),r(1692),r(361),r(258),r(257),r(558),r(259),r(1540),r(205),r(202),r(1693),r(1528),r(1571),r(1636),r(1592),r(1694),r(1572),r(553),r(106),r(567),r(1637),r(387),r(1695),r(356),r(1527),r(1529),r(100),r(1496),r(1406),r(344),r(1501)],void 0===(n=function(e,t,i,n,o,s,a,u,l,p,c,d,f,y,h,m,v,g,b,_,w,x,F,S,I,T,O,M,j,E,C,P,R,k,D,A,B,q,N,z,L,G,U,V,Q,J,W,Z,X,H,Y,K,$,ee,te,re,ie,ne){function oe(e){return e&&se(e)}function se(e){return e&&e.isInstanceOf&&e.isInstanceOf(y)}function ae(e,t,r){return!!(e&&e.hasOwnProperty(t)?e[t]:r)}var ue=new v.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),le={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"},pe="FeatureLayer",ce=g.getLogger("esri.layers.FeatureLayer"),de=V.defineFieldProperties();return function(e){function t(t){var r=e.call(this)||this;return r._handles=new m,r.capabilities=null,r.copyright=null,r.displayField=null,r.definitionExpression=null,r.dynamicDataSource=null,r.editFieldsInfo=null,r.editingEnabled=!0,r.editingInfo=null,r.elevationInfo=null,r.featureReduction=null,r.fields=null,r.fullExtent=null,r.gdbVersion=null,r.geometryProperties=null,r.geometryType=null,r.hasM=void 0,r.hasZ=void 0,r.heightModelInfo=null,r.historicMoment=null,r.isTable=!1,r.labelsVisible=!0,r.labelingInfo=null,r.layerId=void 0,r.legendEnabled=!0,r.maxRecordCount=void 0,r.tileMaxRecordCount=void 0,r.minScale=0,r.maxScale=0,r.objectIdField=null,r.outFields=null,r.path=null,r.popupEnabled=!0,r.popupTemplate=null,r.relationships=null,r.returnM=void 0,r.returnZ=void 0,r.screenSizePerspectiveEnabled=!0,r.serviceDefinitionExpression=null,r.spatialReference=T.WGS84,r.templates=null,r.timeInfo=null,r.title=null,r.sublayerTitleMode="item-title",r.trackIdField=null,r.type="feature",r.typeIdField=null,r.types=null,r.indexes=new(y.ofType(q.FeatureIndex)),r.userIsAdmin=!1,r.version=void 0,r.visible=!0,r}return n(t,e),t.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)},t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?i({url:e},t):e},t.prototype.load=function(e){var t=this,r=b.isSome(e)?e.signal:null;if(!(this.portalItem&&this.portalItem.loaded&&this.source)){var i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},e).catch(function(e){return e}).then(function(){return u(t,void 0,void 0,function(){var e,t;return a(this,function(i){switch(i.label){case 0:return this.url&&null==this.layerId&&/FeatureServer|MapServer\/*$/i.test(this.url)?[4,this._fetchFirstLayerId(r)]:[3,2];case 1:null!=(e=i.sent())&&(this.layerId=e),i.label=2;case 2:if(!this.url&&!this._hasMemorySource())throw new h("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return t=this._initLayerProperties,[4,this.createGraphicsSource(r)];case 3:return[2,t.apply(this,[i.sent()])]}})})});return this.addResolvingPromise(i),this.when()}this.addResolvingPromise(this.createGraphicsSource(r).then(function(e){return t._initLayerProperties(e)}))},t.prototype.readCapabilities=function(e,t){return t=t.layerDefinition||t,{attachment:this._readAttachmentCapabilities(t.attachmentProperties),data:this._readDataCapabilities(t),metadata:this._readMetadataCapabilities(t),operations:this._readOperationsCapabilities(t.capabilities||e,t),query:this._readQueryCapabilities(t),queryRelated:this._readQueryRelatedCapabilities(t),editing:this._readEditingCapabilities(t)}},t.prototype.readEditingEnabled=function(e,t){return"Query"!==t.capabilities},t.prototype.writeEditingEnabled=function(e,t,r,i){e||(t.capabilities="Query")},t.prototype.readEditingInfo=function(e,t){var r=t.editingInfo;return r?{lastEditDate:null!=r.lastEditDate?new Date(r.lastEditDate):null}:null},Object.defineProperty(t.prototype,"fieldsIndex",{get:function(){return new Q((this.fields?this.fields:[]).concat(this.processing&&this.processing.fields?this.processing.fields:[]))},enumerable:!0,configurable:!0}),t.prototype.readIsTable=function(e,t){return"Table"===(t=t&&t.layerDefinition||t).type},Object.defineProperty(t.prototype,"hasService",{get:function(){return!this._hasMemorySource()},enumerable:!0,configurable:!0}),t.prototype.readMinScale=function(e,t){return t.effectiveMinScale||e||0},t.prototype.readMaxScale=function(e,t){return t.effectiveMaxScale||e||0},t.prototype.readObjectIdFieldFromService=function(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields)for(var r=0,i=t.fields;r<i.length;r++){var n=i[r];if("esriFieldTypeOID"===n.type)return n.name}},Object.defineProperty(t.prototype,"parsedUrl",{get:function(){var e=this.url?x.urlToObject(this.url):null;if(null!=e)if(null!=this.layerId)e.path=x.join(e.path,this.layerId.toString());else if(null!=this.dynamicDataSource){var t={source:X.sourceToJSON(this.dynamicDataSource)};e.query={layer:JSON.stringify(t)}}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultPopupTemplate",{get:function(){return this.createPopupTemplate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{set:function(e){J.fixRendererFields(e,this.fields),this._set("renderer",e)},enumerable:!0,configurable:!0}),t.prototype.readRenderer=function(e,t,r){var i,n,o=(t=t.layerDefinition||t).drawingInfo&&t.drawingInfo.renderer||void 0;if(o)(i=Y.read(o,t,r)||void 0)||ce.error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r});else if(t.defaultSymbol)ee.read(t.defaultSymbol,t,r),t.types&&t.types.length?(i=new p.UniqueValueRenderer({defaultSymbol:n,field:t.typeIdField}),t.types.forEach(function(e){o.addUniqueValueInfo(e.id,ee.read(e.symbol,e,r))})):i=new p.SimpleRenderer({symbol:n});else if("Table"!==t.type){switch(t.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":n=new d.SimpleMarkerSymbol;break;case"esriGeometryPolyline":n=new d.SimpleLineSymbol;break;case"esriGeometryPolygon":n=new d.SimpleFillSymbol}i=n&&new p.SimpleRenderer({symbol:n})}return i},t.prototype.writeRenderer=function(e,t,r,i){Y.writeTarget(e,t,r,i)},t.prototype.writeWebSceneRenderer=function(e,t,r,i){Y.writeTarget(e,t,"layerDefinition.drawingInfo.renderer",i)},Object.defineProperty(t.prototype,"source",{set:function(e){var t=this._get("source");t!==e&&(oe(t)&&this._resetMemorySource(t),oe(e)&&this._initMemorySource(e),this._set("source",e))},enumerable:!0,configurable:!0}),t.prototype.castSource=function(e){return e?Array.isArray(e)||se(e)?new j.default({layer:this,items:e}):e:null},t.prototype.readSource=function(e,t){var r=re.fromJSON(t.featureSet);return new j.default({layer:this,items:r&&r.features||[]})},t.prototype.readTemplates=function(e,t){var r=t.editFieldsInfo,i=r&&r.creatorField,n=r&&r.editorField;return e=e&&e.map(function(e){return G.fromJSON(e)}),this._fixTemplates(e,i),this._fixTemplates(e,n),e},t.prototype.readTitle=function(e,t){var r=t.layerDefinition&&t.layerDefinition.name||t.name,i=t.title||t.layerDefinition&&t.layerDefinition.title;if(r){var n=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?A.titleFromUrlAndName(this.url,r):r;var o=r||this.url&&A.parse(this.url).title;if(!o)return;return"item-title-and-service-name"===this.sublayerTitleMode&&n&&(o=n+" - "+o),A.cleanTitle(o)}if("item-title"===this.sublayerTitleMode&&i)return i},t.prototype.readTitleFromWebMap=function(e,t){return t.title||t.layerDefinition&&t.layerDefinition.name},t.prototype.readTypeIdField=function(e,t){var r=(t=t.layerDefinition||t).typeIdField;if(r){var i=J.getField(t.fields,r);i&&(r=i.name)}return r},t.prototype.readTypes=function(e,t){var r=this;e=(t=t.layerDefinition||t).types;var i=t.editFieldsInfo,n=i&&i.creatorField,o=i&&i.editorField;return e&&e.map(function(e){return e=U.fromJSON(e),r._fixTemplates(e.templates,n),r._fixTemplates(e.templates,o),e})},Object.defineProperty(t.prototype,"url",{set:function(e){var t=A.sanitizeUrlWithLayerId(this,e,ce);this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)},enumerable:!0,configurable:!0}),t.prototype.writeUrl=function(e,t,r,i){A.writeUrlWithLayerId(this,e,null,t,i)},t.prototype.readVersion=function(e,t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3},t.prototype.readVisible=function(e,t){return t.layerDefinition&&null!=t.layerDefinition.defaultVisibility?!!t.layerDefinition.defaultVisibility:null!=t.visibility?!!t.visibility:void 0},t.prototype.addAttachment=function(e,t){var r=this;return this.load().then(function(){return r._checkAttachmentSupport(e)}).then(function(){return"addAttachment"in r.source?r.source.addAttachment(e,t):w.reject(new h(pe,"Layer source does not support addAttachment capability"))})},t.prototype.updateAttachment=function(e,t,r){var i=this;return this.load().then(function(){return i._checkAttachmentSupport(e)}).then(function(){return"updateAttachment"in i.source?i.source.updateAttachment(e,t,r):w.reject(new h(pe,"Layer source does not support updateAttachment capability"))})},t.prototype.applyEdits=function(e){return f.safeCast(M.applyEdits(this,e))},t.prototype.on=function(e,t){return this.inherited(arguments)},t.prototype.createPopupTemplate=function(e){return $.createPopupTemplate(this,e)},t.prototype.createGraphicsSource=function(e){return u(this,void 0,void 0,function(){var t,i;return a(this,function(n){switch(n.label){case 0:return this._hasMemorySource()?(this.emit("graphics-source-create",{graphicsSource:this.source}),[2,this.source.load({signal:e})]):[4,w.create(function(e){return Promise.all([r.e(3),r.e(102)]).then(function(){var t=[r(1851)];e.apply(null,t)}.bind(this)).catch(r.oe)})];case 1:return t=n.sent(),w.throwIfAborted(e),[4,new t.default({layer:this}).load({signal:e})];case 2:return i=n.sent(),this.emit("graphics-source-create",{graphicsSource:i}),[2,i]}})})},t.prototype.createQuery=function(){var e=new ie,t=this.get("capabilities.data");return e.gdbVersion=this.gdbVersion,e.historicMoment=this.historicMoment,e.returnGeometry=!0,t&&(t.supportsZ&&null!=this.returnZ&&(e.returnZ=this.returnZ),t.supportsM&&null!=this.returnM&&(e.returnM=this.returnM)),e.outFields=["*"],e.where=this.definitionExpression||"1=1",e.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,e},t.prototype.deleteAttachments=function(e,t){var r=this;return this.load().then(function(){return r._checkAttachmentSupport(e)}).then(function(){return"deleteAttachments"in r.source?r.source.deleteAttachments(e,t):w.reject(new h(pe,"Layer source does not support deleteAttachments capability"))})},t.prototype.getFeatureType=function(e){var t=this.typeIdField,r=this.types;if(!t||!e)return null;var i=e.attributes?e.attributes[t]:void 0;if(null==i)return null;var n=null;return r.some(function(e){var t=e.id;return null!=t&&(t.toString()===i.toString()&&(n=e),!!n)}),n},t.prototype.getFieldDomain=function(e,t){var r,i=this,n=!1,o=t&&t.feature,s=o&&o.attributes,a=this.typeIdField&&s&&s[this.typeIdField];return null!=a&&this.types&&(n=this.types.some(function(t){return t.id==a&&((r=t.domains&&t.domains[e])&&"inherited"===r.type&&(r=i._getLayerDomain(e)),!0)})),n||r||(r=this._getLayerDomain(e)),r},t.prototype.getField=function(e){return this.fieldsIndex.get(e)},t.prototype.queryAttachments=function(e,t){var r=this;return e=te.from(e),this.load().then(function(){if(!r.get("capabilities.data.supportsAttachment"))return w.reject(new h(pe,"this layer doesn't support attachments"));var t=e.attachmentTypes,i=e.objectIds,n=e.globalIds,o=e.num,s=e.size,a=e.start,u=e.where;if(!r.get("capabilities.operations.supportsQueryAttachments")){var l=i&&i.length>1,p=t&&t.length,c=n&&n.length,d=s&&s.length;if(l||p||c||d||o||a||u)return w.reject(new h(pe,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",e))}return i&&i.length||u?"queryAttachments"in r.source?r.source.queryAttachments(e):w.reject(new h(pe,"Layer source does not support queryAttachments capability",e)):w.reject(new h(pe,"'objectIds' or 'where' are required to perform attachment query",e))})},t.prototype.queryFeatures=function(e,t){var r=this;return this.load().then(function(){return r.source.queryFeatures(ie.from(e)||r.createQuery(),t)}).then(function(e){if(e&&e.features)for(var t=0,i=e.features;t<i.length;t++){var n=i[t];n.layer=n.sourceLayer=r}return e})},t.prototype.queryObjectIds=function(e,t){var r=this;return this.load().then(function(){return r.source.queryObjectIds?r.source.queryObjectIds(ie.from(e)||r.createQuery(),t):w.reject(new h(pe,"Layer source does not support queryObjectIds capability"))})},t.prototype.queryFeatureCount=function(e,t){var r=this;return this.load().then(function(){return r.source.queryFeatureCount?r.source.queryFeatureCount(ie.from(e)||r.createQuery(),t):w.reject(new h(pe,"Layer source does not support queryFeatureCount capability"))})},t.prototype.queryExtent=function(e,t){var r=this;return this.load().then(function(){return r.source.queryExtent?r.source.queryExtent(ie.from(e)||r.createQuery(),t):w.reject(new h(pe,"Layer source does not support queryExtent capability"))})},t.prototype.queryRelatedFeatures=function(e,t){var r=this;return this.load().then(function(){return"queryRelatedFeatures"in r.source?r.source.queryRelatedFeatures(ne.from(e),t):w.reject(new h(pe,"Layer source does not support queryRelatedFeatures capability"))})},t.prototype.read=function(e,t){var r=e.featureCollection;if(r){var i=r.layers;i&&1===i.length&&(this.inherited(arguments,[i[0],t]),null!=r.showLegend&&this.inherited(arguments,[{showLegend:r.showLegend},t]))}this.inherited(arguments,[e,t]),t&&"service"===t.origin&&this.revert(["objectIdField","fields","timeInfo"],"service")},t.prototype.write=function(e,t){return t&&("web-scene"===t.origin||"web-map"===t.origin)&&t.messages&&this.isTable?(t.messages.push(new h("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' using a Table source cannot written to web scenes",{layer:this})),null):this.inherited(arguments)},t.prototype.importLayerViewModule=function(e){return u(this,void 0,void 0,function(){return a(this,function(t){switch(e.type){case"2d":return[2,w.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(13),r.e(23)]).then(function(){var t=[r(1720)];e.apply(null,t)}.bind(this)).catch(r.oe)})];case"3d":return[2,w.create(function(e){return Promise.all([r.e(2),r.e(5),r.e(8),r.e(13),r.e(47)]).then(function(){var t=[r(1855)];e.apply(null,t)}.bind(this)).catch(r.oe)})]}return[2]})})},t.prototype._checkAttachmentSupport=function(e){var t=e.attributes,r=this.objectIdField;return this.get("capabilities.data.supportsAttachment")?e?t?t[r]?void 0:w.reject(new h(pe,"feature is missing the identifying attribute "+r)):w.reject(new h(pe,"'attributes' are required on a feature to query attachments")):w.reject(new h(pe,"A feature is required to add/delete/update attachments")):w.reject(new h(pe,"this layer doesn't support attachments"))},t.prototype._getLayerDomain=function(e){if(!this.fields)return null;var t=null;return this.fields.some(function(r){return r.name===e&&(t=r.domain),!!t}),t},t.prototype._fetchFirstLayerId=function(e){return c(this.url,{query:{f:"json"},responseType:"json",signal:e}).then(function(e){var t=e.data;if(t)return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0})},t.prototype._initLayerProperties=function(e){return u(this,void 0,void 0,function(){return a(this,function(t){return this._set("source",e),e.layerDefinition&&this.read(e.layerDefinition,{origin:"service",url:this.parsedUrl}),this._verifySource(),this._verifyFields(),J.fixRendererFields(this.renderer,this.fields),J.fixTimeInfoFields(this.timeInfo,this.fields),[2,K.loadStyleRenderer(this,{origin:"service"})]})})},t.prototype._verifyFields=function(){var e=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||-1!==e.search(/\/FeatureServer\//i)||this.fields&&this.fields.some(function(e){return"geometry"===e.type})||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")},t.prototype._fixTemplates=function(e,t){e&&e.forEach(function(e){var r=e.prototype&&e.prototype.attributes;r&&t&&delete r[t]})},t.prototype._verifySource=function(){if(this._hasMemorySource()){if(this.url)throw new h("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new h("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")},t.prototype._initMemorySource=function(e){var t=this;e.forEach(function(e){e.layer=t,e.sourceLayer=t}),this._handles.add([e.on("after-add",function(e){e.item.layer=t,e.item.sourceLayer=t}),e.on("after-remove",function(e){e.item.layer=null,e.item.sourceLayer=null})],"fl-source")},t.prototype._resetMemorySource=function(e){e.forEach(function(e){e.layer=null,e.sourceLayer=null}),this._handles.remove("fl-source")},t.prototype._hasMemorySource=function(){return!(this.url||!this.source)},t.prototype._readAttachmentCapabilities=function(e){var t={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1};return e&&Array.isArray(e)&&e.forEach(function(e){var r=le[e.name];r&&(t[r]=!!e.isEnabled)}),t},t.prototype._readDataCapabilities=function(e){return{supportsAttachment:ae(e,"hasAttachments",!1),supportsM:ae(e,"hasM",!1),supportsZ:ae(e,"hasZ",!1)}},t.prototype._readMetadataCapabilities=function(e){return{supportsAdvancedFieldProperties:ae(e,"supportsFieldDescriptionProperty",!1)}},t.prototype._readOperationsCapabilities=function(e,t){var r=e?e.toLowerCase().split(",").map(function(e){return e.trim()}):[],i=-1!==r.indexOf("editing"),n=i&&-1!==r.indexOf("create"),o=i&&-1!==r.indexOf("delete"),s=i&&-1!==r.indexOf("update");return i&&!(n||o||s)&&(n=o=s=!0),{supportsCalculate:ae(t,"supportsCalculate",!1),supportsTruncate:ae(t,"supportsTruncate",!1),supportsValidateSql:ae(t,"supportsValidateSql",!1),supportsAdd:n,supportsDelete:o,supportsEditing:i,supportsQuery:-1!==r.indexOf("query"),supportsQueryAttachments:ae(t.advancedQueryCapabilities,"supportsQueryAttachments",!1),supportsResizeAttachments:ae(t,"supportsAttachmentsResizing",!1),supportsUpdate:s,supportsExceedsLimitStatistics:ae(t,"supportsExceedsLimitStatistics",!1)}},t.prototype._readQueryCapabilities=function(e){var t=e.advancedQueryCapabilities,r=e.ownershipBasedAccessControlForFeatures,i=e.archivingInfo,n=(e.supportedQueryFormats||"").split(",").reduce(function(e,t){var r=t.toLowerCase().trim();return r&&e.add(r),e},new Set);return{supportsStatistics:ae(t,"supportsStatistics",e.supportsStatistics),supportsCentroid:ae(t,"supportsReturningGeometryCentroid",!1),supportsDistance:ae(t,"supportsQueryWithDistance",!1),supportsDistinct:ae(t,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:ae(t,"supportsReturningQueryExtent",!1),supportsGeometryProperties:ae(t,"supportsReturningGeometryProperties",!1),supportsHavingClause:ae(t,"supportsHavingClause",!1),supportsOrderBy:ae(t,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:ae(t,"supportsPagination",!1),supportsQuantization:ae(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:ae(e,"supportsQuantizationEditMode",!1),supportsQueryGeometry:ae(e,"supportsReturningQueryGeometry",!1),supportsResultType:ae(t,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:ae(t,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:ae(t,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:ae(e,"useStandardizedQueries",!1),supportsQueryByOthers:ae(r,"allowOthersToQuery",!0),supportsHistoricMoment:ae(i,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:n.has("pbf"),supportsDisjointSpatialRelationship:ae(t,"supportsDisjointSpatialRel",!1),supportsCacheHint:ae(t,"supportsQueryWithCacheHint",!1)}},t.prototype._readQueryRelatedCapabilities=function(e){var t=e.advancedQueryCapabilities,r=ae(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:ae(t,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r}},t.prototype._readEditingCapabilities=function(e){var t=e.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:ae(e,"allowGeometryUpdates",!0),supportsGlobalId:ae(e,"supportsApplyEditsWithGlobalIds",!1),supportsRollbackOnFailure:ae(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:ae(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:ae(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:ae(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:ae(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:ae(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:ae(t,"allowOthersToUpdate",!0)}},o([F.property({readOnly:!0,json:{read:!1}})],t.prototype,"capabilities",void 0),o([F.reader("service","capabilities",["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","hasAttachments","hasM","hasZ","ownershipBasedAccessControlForFeatures","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","useStandardizedQueries"])],t.prototype,"readCapabilities",null),o([F.property({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],t.prototype,"copyright",void 0),o([F.property({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],t.prototype,"displayField",void 0),o([F.property({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],t.prototype,"definitionExpression",void 0),o([F.property({readOnly:!0,json:{read:ee.read}})],t.prototype,"defaultSymbol",void 0),o([F.property()],t.prototype,"dynamicDataSource",void 0),o([F.property({readOnly:!0})],t.prototype,"editFieldsInfo",void 0),o([F.property({type:Boolean})],t.prototype,"editingEnabled",void 0),o([F.reader(["portal-item","web-map","web-scene"],"editingEnabled",["capabilities"])],t.prototype,"readEditingEnabled",null),o([F.writer(["portal-item","web-map","web-scene"],"editingEnabled",{capabilities:{type:String}})],t.prototype,"writeEditingEnabled",null),o([F.property({readOnly:!0})],t.prototype,"editingInfo",void 0),o([F.reader("editingInfo")],t.prototype,"readEditingInfo",null),o([F.property(B.elevationInfo)],t.prototype,"elevationInfo",void 0),o([F.property({types:{key:"type",base:z.default,typeMap:{selection:L.default}},json:{origins:{"web-scene":{read:{source:"layerDefinition.featureReduction"},write:{target:"layerDefinition.featureReduction"}}}}})],t.prototype,"featureReduction",void 0),o([F.property(i({},de.fields,{json:{origins:{service:{read:!0}},read:{source:"layerDefinition.fields"}}}))],t.prototype,"fields",void 0),o([F.property({readOnly:!0,dependsOn:["fields","processing"]})],t.prototype,"fieldsIndex",null),o([F.property({type:S,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],t.prototype,"fullExtent",void 0),o([F.property()],t.prototype,"gdbVersion",void 0),o([F.property({readOnly:!0})],t.prototype,"geometryProperties",void 0),o([F.property({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:ue.read}},read:{source:"layerDefinition.geometryType",reader:ue.read}}})],t.prototype,"geometryType",void 0),o([F.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],t.prototype,"hasM",void 0),o([F.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],t.prototype,"hasZ",void 0),o([F.property({readOnly:!0,type:I})],t.prototype,"heightModelInfo",void 0),o([F.property({type:Date})],t.prototype,"historicMoment",void 0),o([F.property({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],t.prototype,"id",void 0),o([F.property({readOnly:!0})],t.prototype,"isTable",void 0),o([F.reader("service","isTable",["type"]),F.reader("isTable",["layerDefinition.type"])],t.prototype,"readIsTable",null),o([F.property({dependsOn:["loaded","url","source"],readOnly:!0})],t.prototype,"hasService",null),o([F.property(B.labelsVisible)],t.prototype,"labelsVisible",void 0),o([F.property({type:[W],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:Z.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:Z.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],t.prototype,"labelingInfo",void 0),o([F.property({type:Number,json:{origins:{service:{read:{source:"id"}}},read:!1}})],t.prototype,"layerId",void 0),o([F.property(B.legendEnabled)],t.prototype,"legendEnabled",void 0),o([F.property({type:["show","hide"]})],t.prototype,"listMode",void 0),o([F.property({type:Number,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.maxRecordCount"}}})],t.prototype,"maxRecordCount",void 0),o([F.property({type:Number,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.tileMaxRecordCount"}}})],t.prototype,"tileMaxRecordCount",void 0),o([F.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}})],t.prototype,"minScale",void 0),o([F.reader("service","minScale",["minScale","effectiveMinScale"])],t.prototype,"readMinScale",null),o([F.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}})],t.prototype,"maxScale",void 0),o([F.reader("service","maxScale",["maxScale","effectiveMaxScale"])],t.prototype,"readMaxScale",null),o([F.property({type:String})],t.prototype,"objectIdField",void 0),o([F.reader("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),F.reader("service","objectIdField",["objectIdField","fields"])],t.prototype,"readObjectIdFieldFromService",null),o([F.property({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],t.prototype,"operationalLayerType",void 0),o([F.property(de.outFields)],t.prototype,"outFields",void 0),o([F.property({readOnly:!0,dependsOn:["layerId"]})],t.prototype,"parsedUrl",null),o([F.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],t.prototype,"path",void 0),o([F.property(B.popupEnabled)],t.prototype,"popupEnabled",void 0),o([F.property({type:l,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],t.prototype,"popupTemplate",void 0),o([F.property({readOnly:!0,dependsOn:["fields","title"]})],t.prototype,"defaultPopupTemplate",null),o([F.property({type:N})],t.prototype,"processing",void 0),o([F.property({type:[H],readOnly:!0})],t.prototype,"relationships",void 0),o([F.property({types:p.rendererTypes,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}}},write:{target:"layerDefinition.drawingInfo.renderer"}}})],t.prototype,"renderer",null),o([F.reader("service","renderer",["drawingInfo.renderer","defaultSymbol","type"]),F.reader("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol","layerDefinition.type"])],t.prototype,"readRenderer",null),o([F.writer("renderer")],t.prototype,"writeRenderer",null),o([F.writer("web-scene","renderer",{"layerDefinition.drawingInfo.renderer":{types:p.webSceneRendererTypes}})],t.prototype,"writeWebSceneRenderer",null),o([F.property()],t.prototype,"resourceInfo",void 0),o([F.property({type:Boolean})],t.prototype,"returnM",void 0),o([F.property({type:Boolean})],t.prototype,"returnZ",void 0),o([F.property(B.screenSizePerspectiveEnabled)],t.prototype,"screenSizePerspectiveEnabled",void 0),o([F.property()],t.prototype,"source",null),o([F.cast("source")],t.prototype,"castSource",null),o([F.reader("portal-item","source",["featureSet"]),F.reader("web-map","source",["featureSet"])],t.prototype,"readSource",null),o([F.property({readOnly:!0,json:{origins:{service:{read:{source:"definitionExpression"}}}}})],t.prototype,"serviceDefinitionExpression",void 0),o([F.property({type:T,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],t.prototype,"spatialReference",void 0),o([F.property({type:[G]})],t.prototype,"templates",void 0),o([F.reader("templates",["editFieldsInfo","creatorField","editorField","templates"])],t.prototype,"readTemplates",null),o([F.property()],t.prototype,"timeInfo",void 0),o([F.property()],t.prototype,"title",void 0),o([F.reader("service","title",["name"]),F.reader("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],t.prototype,"readTitle",null),o([F.reader("web-map","title",["layerDefinition.name","title"])],t.prototype,"readTitleFromWebMap",null),o([F.property({type:String})],t.prototype,"sublayerTitleMode",void 0),o([F.property({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],t.prototype,"trackIdField",void 0),o([F.property({json:{read:!1}})],t.prototype,"type",void 0),o([F.property({type:String,readOnly:!0})],t.prototype,"typeIdField",void 0),o([F.reader("service","typeIdField"),F.reader("typeIdField",["layerDefinition.typeIdField"])],t.prototype,"readTypeIdField",null),o([F.property({type:[U]})],t.prototype,"types",void 0),o([F.reader("service","types",["types"]),F.reader("types",["layerDefinition.types"])],t.prototype,"readTypes",null),o([F.property({type:y.ofType(q.FeatureIndex),readOnly:!0})],t.prototype,"indexes",void 0),o([F.property(B.url)],t.prototype,"url",null),o([F.writer("url")],t.prototype,"writeUrl",null),o([F.property({readOnly:!0})],t.prototype,"userIsAdmin",void 0),o([F.property({json:{origins:{service:{read:!0}},read:!1}})],t.prototype,"version",void 0),o([F.reader("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],t.prototype,"readVersion",null),o([F.property({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],t.prototype,"visible",void 0),o([F.reader("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],t.prototype,"readVisible",null),o([F.subclass("esri.layers.FeatureLayer")],t)}(F.declared(O,C,P,k,R,E,_,D))}.apply(null,i))||(e.exports=n)}}]);