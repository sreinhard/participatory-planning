(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/layers/features/Pipeline":1623,"esri/core/libs/quickselect/quickselect":1662,"esri/core/libs/rbush/rbush":1674,"esri/views/2d/layers/features/support/Tile":1715,"esri/views/2d/layers/features/support/TileStore":1793,"esri/views/2d/layers/features/controllers":2441,"esri/views/2d/layers/features/processors":2442})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{1623:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(2),i(1),i(11),i(10),i(4),i(16),i(58),i(14),i(18),i(6),i(7),i(0),i(164),i(709),i(2441),i(2442),i(1793),i(646)],void 0===(r=function(t,e,i,n,r,o,s,a,l,h,u,c,f,d,p,m,v,g,x,y){Object.defineProperty(e,"__esModule",{value:!0});var b=c.getLogger("esri.views.2d.layers.features.Pipeline"),_=new Set;e.getInstances=function(){return _};var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.controller=null,e.processor=null,e.remoteClient=null,e.tileStore=null,e.service=null,e.viewState=null,e}return i(e,t),e.prototype.initialize=function(){var t=this;this.watch("updating",function(e){t.remoteClient.invoke("setUpdating",e)}),u("esri-performance-tests")&&!u("esri-workers")&&_.add(this)},e.prototype.destroy=function(){u("esri-performance-tests")&&!u("esri-workers")&&_.delete(this),this.controller&&this.controller.destroy(),this.processor&&this.processor.destroy()},Object.defineProperty(e.prototype,"updating",{get:function(){var t=this.controller,e=this.processor;return!t||!e||t.updating||e.updating||!1},enumerable:!0,configurable:!0}),e.prototype.startup=function(t){var e=t.service,i=t.config,n=t.tileInfo;return r(this,void 0,void 0,function(){var t;return o(this,function(r){return t=new y(p.fromJSON(n)),this.service=e,this.tileStore=new x.default(t),[2,this._configure(i)]})})},e.prototype.update=function(t){var e=t.config,i=t.options;return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.processor&&this.controller?i.layerFilterChanged||i.invalidateFeatureData||i.invalidateMesh?[4,this.controller.update(e,i.layerFilterChanged)]:[3,2]:(b.error(new h("mapview-pipeline","Tried to update an unconfigured pipeline.")),[2]);case 1:t.sent(),t.label=2;case 2:return i.invalidateMesh?[4,this.processor.update(e)]:[3,4];case 3:t.sent(),this.controller.invalidate(),t.label=4;case 4:return[4,this.remoteClient.invoke("setUpdating",this.updating)];case 5:return t.sent(),[2]}})})},e.prototype.setViewState=function(t){var e=m.fromJSON(t);this._set("viewState",e),this.tileStore&&this.tileStore.setViewState(e),this.controller&&this.controller.setViewState(e)},e.prototype._configure=function(t){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,f.all([l.safeCast(this._handleControllerConfig(t)),l.safeCast(this._handleProcessorConfig(t))])];case 1:return e.sent(),this.controller.processor=this.processor,this.viewState&&this.controller.setViewState(this.viewState),[2]}})})},e.prototype._handleControllerConfig=function(t){return r(this,void 0,void 0,function(){var e;return o(this,function(i){switch(i.label){case 0:return[4,this._createController(this.service,t)];case 1:return[4,(e=i.sent()).startup()];case 2:return i.sent(),[2,e]}})})},e.prototype._handleProcessorConfig=function(t){return r(this,void 0,void 0,function(){return o(this,function(e){return[2,this._createProcessor(this.service,t)]})})},e.prototype._createController=function(t,e){return r(this,void 0,void 0,function(){var i,n,r,s,a;return o(this,function(o){switch(o.label){case 0:return[4,v.loadControllerModule(t.type)];case 1:return i=o.sent().default,r=(n=this).tileStore,s=n.remoteClient,a=new i({service:t,config:e,tileStore:r,remoteClient:s}),this.controller&&this.controller.destroy(),this.controller=a,[2,a]}})})},e.prototype._createProcessor=function(t,e){return r(this,void 0,void 0,function(){var i,n,r,s,a;return o(this,function(o){switch(o.label){case 0:return[4,g.loadProcessorModule(e.renderer.type)];case 1:return i=o.sent().default,r=(n=this).remoteClient,s=n.tileStore,a=new i({service:t,config:e,tileStore:s,remoteClient:r}),this.processor&&this.processor.destroy(),this.processor=a,[2,a]}})})},n([d.property()],e.prototype,"controller",void 0),n([d.property()],e.prototype,"processor",void 0),n([d.property({dependsOn:["controller.updating","processor.updating"]})],e.prototype,"updating",null),n([d.property()],e.prototype,"viewState",void 0),n([d.subclass("esri.views.2d.layers.features.Pipeline")],e)}(d.declared(a));e.default=w}.apply(null,n))||(t.exports=r)},1662:function(t,e,i){var n;void 0===(n=function(){"use strict";function t(i,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,l=n-r+1,h=Math.log(a),u=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*u*(a-u)/a)*(l-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-l*u/a+c)),Math.min(o,Math.floor(n+(a-l)*u/a+c)),s)}var f=i[n],d=r,p=o;for(e(i,r,n),s(i[o],f)>0&&e(i,r,o);d<p;){for(e(i,d,p),d++,p--;s(i[d],f)<0;)d++;for(;s(i[p],f)>0;)p--}0===s(i[r],f)?e(i,r,p):e(i,++p,o),p<=n&&(r=p+1),n<=p&&(o=p-1)}}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}return function(e,n,r,o,s){t(e,n,r||0,o||e.length-1,s||i)}}.apply(null,[]))||(t.exports=n)},1674:function(t,e,i){var n,r;n=[i(1662)],void 0===(r=function(t){"use strict";function e(t,i){if(!(this instanceof e))return new e(t,i);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this.toBBox=i:this._initFormat(i)),this.clear()}function i(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function n(t,e){r(t,0,t.children.length,e,t)}function r(t,e,i,n,r){r||(r=p(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s,a=e;a<i;a++)s=t.children[a],o(r,t.leaf?n(s):s);return r}function o(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function s(t,e){return t.minX-e.minX}function a(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function u(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function c(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-i)*Math.max(0,o-n)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,i,n,r,o){for(var s,a=[i,n];a.length;)(n=a.pop())-(i=a.pop())<=r||(s=i+Math.ceil((n-i)/r/2)*r,t(e,s,i,n,o),a.push(i,s,s,n))}return e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!d(t,e))return i;for(var r,o,s,a,l=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],d(t,a=e.leaf?n(s):s)&&(e.leaf?i.push(s):f(t,a)?this._all(s,i):l.push(s));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!d(t,e))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],d(t,s=e.leaf?i(o):o)){if(e.leaf||f(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(t,e){if(!t)return this;for(var n,r,o,s,a=this.data,l=this.toBBox(t),h=[],u=[];a||h.length;){if(a||(a=h.pop(),r=h[h.length-1],n=u.pop(),s=!0),a.leaf&&-1!==(o=i(t,a.children,e)))return a.children.splice(o,1),h.push(a),this._condense(h),this;s||a.leaf||!f(a,l)?r?(n++,a=r.children[n],s=!1):a=null:(h.push(a),u.push(n),n=0,r=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:s,compareMinY:a,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,r){var o,s=i-e+1,a=this._maxEntries;if(s<=a)return n(o=p(t.slice(e,i+1)),this.toBBox),o;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),(o=p([])).leaf=!1,o.height=r;var l,h,u,c,f=Math.ceil(s/a),d=f*Math.ceil(Math.sqrt(a));for(m(t,e,i,d,this.compareMinX),l=e;l<=i;l+=d)for(m(t,l,u=Math.min(l+d-1,i),f,this.compareMinY),h=l;h<=u;h+=f)c=Math.min(h+f-1,u),o.children.push(this._build(t,h,c,r-1));return n(o,this.toBBox),o},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,h,c,f,d;n.push(e),!e.leaf&&n.length-1!==i;){for(f=d=1/0,r=0,o=e.children.length;r<o;r++)h=l(s=e.children[r]),(c=u(t,s)-h)<d?(d=c,f=h<f?h:f,a=s):c===d&&h<f&&(f=h,a=s);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),s=[],a=this._chooseSubtree(r,this.data,e,s);for(a.children.push(t),o(a,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)},_split:function(t,e){var i=t[e],r=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,r);var s=this._chooseSplitIndex(i,o,r),a=p(i.children.splice(s,i.children.length-s));a.height=i.height,a.leaf=i.leaf,n(i,this.toBBox),n(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,n(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,o,s,a,h,u,f,d;for(u=f=1/0,n=e;n<=i-e;n++)a=c(o=r(t,0,n,this.toBBox),s=r(t,n,i,this.toBBox)),h=l(o)+l(s),a<u?(u=a,d=n,f=h<f?h:f):a===u&&h<f&&(f=h,d=n);return d},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:s,r=t.leaf?this.compareMinY:a;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var s,a,l=this.toBBox,u=r(t,0,e,l),c=r(t,i-e,i,l),f=h(u)+h(c);for(s=e;s<i-e;s++)a=t.children[s],o(u,t.leaf?l(a):a),f+=h(u);for(s=i-e-1;s>=e;s--)a=t.children[s],o(c,t.leaf?l(a):a),f+=h(c);return f},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)o(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():n(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}},e}.apply(null,n))||(t.exports=r)},1715:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(232),i(37),i(33),i(654),i(165)],void 0===(r=function(t,e,i,n,r,o,s){function a(t,e){var i=t.bounds,n=e.bounds;return t.key.id!==e.key.id&&t.key.world===e.key.world&&i[0]<=n[0]&&i[1]<=n[1]&&i[2]>=n[2]&&i[3]>=n[3]}Object.defineProperty(e,"__esModule",{value:!0}),e.isParentOf=a,e.isChildOf=function(t,e){return a(e,t)};var l=function(){function t(t,e){this.bounds=r.create(),this.key=new s(0,0,0,0),this.objectIds=new Set,this.key.set(e);var i=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.scale=i.scale,this.level=i.level,this.needsClear=!0}return Object.defineProperty(t.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extent",{get:function(){return n.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.tileInfoView,this.id)},t.prototype.createChildTiles=function(){for(var e=this.key.getChildKeys(),n=i.acquire(),r=0;r<e.length;r++)n[r]=new t(this.tileInfoView,e[r]);return n},t.prototype.getQuantizationParameters=function(){return o.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},t}();e.Tile=l,e.default=l}.apply(null,n))||(t.exports=r)},1793:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(3),i(1),i(49),i(18),i(1674),i(1715),i(427),i(165)],void 0===(r=function(t,e,i,n,r,o,s,a,l,h){Object.defineProperty(e,"__esModule",{value:!0});var u={added:[],removed:[]},c=new Set,f=new h(0,0,0,0),d=function(t){function e(e){var i=t.call(this)||this;return i._tiles=new Map,i._index=s(9,o("csp-restrictions")?function(t){return{minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),i.tiles=[],i.tileScheme=e,i}return i(e,t),e.prototype.destroy=function(){this._tiles.clear()},e.prototype.has=function(t){return this._tiles.has(t)},e.prototype.get=function(t){return this._tiles.get(t)},e.prototype.findByKey=function(t){return this._tiles.get(t.id)},e.prototype.intersections=function(t,e){var i="string"==typeof t?this.get(t):t;if(!i)return[];for(var n=e*i.resolution,r=i.bounds[0]-n,o=i.bounds[1]-n,s=i.bounds[2]+n,a=i.bounds[3]+n,l=[],h=0,u=this._index.search({minX:r,minY:o,maxX:s,maxY:a});h<u.length;h++){var c=u[h],f=c.bounds.slice();f[0]=Math.max(f[0],r),f[1]=Math.max(f[1],o),f[2]=Math.min(f[2],s),f[3]=Math.min(f[3],a),f[2]-f[0]>0&&f[3]-f[1]>0&&l.push({bounds:f,tile:c})}return l},e.prototype.boundsIntersections=function(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})},e.prototype.setViewState=function(t){var e=this.tileScheme.getTileCoverage(t,0);if(e){var i=e.spans,n=e.lodInfo,r=n.level;if(i.length>0)for(var o=0,s=i;o<s.length;o++)for(var h=s[o],d=h.row,p=h.colFrom,m=h.colTo,v=p;v<=m;v++){var g=f.set(r,d,n.normalizeCol(v),n.getWorldForColumn(v)).id;if(c.add(g),!this.has(g)){var x=new a.default(this.tileScheme,g);this._tiles.set(g,x),this._index.insert(x),this.tiles.push(x),u.added.push(x)}}for(var y=this.tiles.length-1;y>=0;y--){x=this.tiles[y];c.has(x.id)||(this._tiles.delete(x.id),this.tiles.splice(y,1),this._index.remove(x),u.removed.push(x))}(u.added.length||u.removed.length)&&this.emit("update",u),l.pool.release(e),c.clear(),u.added.length=0,u.removed.length=0}},e}(r);e.default=d}.apply(null,n))||(t.exports=r)},2441:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(4),i(10),i(11),i(14),i(7)],void 0===(r=function(t,e,n,r,o,s,a){Object.defineProperty(e,"__esModule",{value:!0}),e.loadControllerModule=function(t){switch(t){case"on-demand":return a.create(function(t){return Promise.all([i.e(0),i.e(2),i.e(11),i.e(51)]).then(function(){var e=[i(2534)];t.apply(null,e)}.bind(this)).catch(i.oe)});case"memory":return a.create(function(t){return Promise.all([i.e(0),i.e(2),i.e(11),i.e(76)]).then(function(){var e=[i(2540)];t.apply(null,e)}.bind(this)).catch(i.oe)});case"stream":return a.create(function(t){return Promise.all([i.e(0),i.e(2),i.e(1),i.e(11),i.e(54)]).then(function(){var e=[i(2541)];t.apply(null,e)}.bind(this)).catch(i.oe)});default:return a.reject(new s("mapview-controller:bad-type","Unable to create controller for unknown type: "+t))}}}.apply(null,n))||(t.exports=r)},2442:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(4),i(7)],void 0===(r=function(t,e,n,r){Object.defineProperty(e,"__esModule",{value:!0}),e.loadProcessorModule=function(t){return"heatmap"===t?r.create(function(t){return i.e(95).then(function(){var e=[i(2546)];t.apply(null,e)}.bind(this)).catch(i.oe)}):r.create(function(t){return i.e(90).then(function(){var e=[i(2547)];t.apply(null,e)}.bind(this)).catch(i.oe)})}}.apply(null,n))||(t.exports=r)}}]);