(function(){(this||window).webpackJsonp.registerAbsMids({"esri/renderers/support/heatmapUtils":1650,"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":1729,"esri/views/2d/layers/features/tileRenderers/HeatmapTileRenderer":2463,"esri/views/2d/layers/features/tileRenderers/support/HeatmapSource":2464})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{1650:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(99),r(24)],void 0===(i=function(e,t,r,n){function i(e,t,r,i,a){for(var o=new Uint32Array(e*e),l=("buffer"in t?t:new Float64Array(t)),s=("buffer"in r?new Uint32Array(r.buffer):new Uint32Array(new Uint8Array(r).buffer)),u=s.length/(a-i),p=0;p<l.length;p++){var c=l[p],d=Math.floor((c-i)*u);o[p]=s[n.clamp(d,0,s.length-1)]}return o.buffer}function a(e){for(var t=Math.round(3*e),r=2*e*e,n=new Float64Array(2*t+1),i=0;i<=n.length;i++)n[i]=Math.exp(-Math.pow(i-t,2)/r)/Math.sqrt(2*Math.PI)*(e/2);return n}function o(e,t){return"function"==typeof e?e:e?"string"==typeof t?function(t){return-1*+t[e]}:function(r){return+r[e]+t}:function(e){return 1}}Object.defineProperty(t,"__esModule",{value:!0}),t.generateGradient=function(){if(!("document"in r))return function(e){return null};var e=document.createElement("canvas"),t=e.getContext("2d");return e.height=512,e.width=1,function(r){t.clearRect(0,0,1,e.height);for(var n=t.createLinearGradient(0,0,0,e.height),i=0,a=r.colorStops;i<a.length;i++){var o=a[i],l=o.ratio,s=o.color;n.addColorStop(Math.max(l,.001),"rgba("+s[0]+", "+s[1]+", "+s[2]+", "+s[3]+")")}return t.fillStyle=n,t.fillRect(0,0,1,e.height),t.getImageData(0,0,1,e.height).data}}(),t.calculateHeatmapIntensityInfo=function(e,t,r,n){for(var i,l=t.blurRadius,s=t.fieldOffset,u=t.field,p=new Float64Array(r*n),c=a(l),d=Math.round(3*l),f=Number.NEGATIVE_INFINITY,h=o(u,s),y=0,v=e;y<v.length;y++)for(var g=v[y],m=g.geometry,w=g.attributes,b=m.x-d,x=m.y-d,I=Math.max(0,b),T=Math.max(0,x),R=Math.min(n,m.y+d),M=Math.min(r,m.x+d),P=+h(w),U=T;U<R;U++)for(var C=c[U-x],j=I;j<M;j++){var A=c[j-b];(i=p[U*r+j]+=C*A*P)>f&&(f=i)}return{matrix:p.buffer,max:f}},t.drawHeatmap=function(e,t,r,n,a,o){e.canvas.width=e.canvas.height=t,e.clearRect(0,0,t,t);var l=e.getImageData(0,0,t,t);r&&n&&l.data.set(new Uint8ClampedArray(i(t,r,n,a,o))),e.putImageData(l,0,0)},t.createHeatmapImageData=i,t.createKernel=a,t.createValueFunction=o}.apply(null,n))||(e.exports=i)},1729:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(6),r(345),r(0)],void 0===(i=function(e,t,r,n,i,a,o){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var r=e.call(this)||this;return r.tiles=new Map,r.layer=null,r}return r(t,e),t.prototype.destroy=function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null},Object.defineProperty(t.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0}),t.prototype.acquireTile=function(e){var t=this,r=this.createTile(e);return r.once("isReady",function(){return t.notifyChange("updating")}),this.tiles.set(e.id,r),r},t.prototype.forEachTile=function(e){this.tiles.forEach(e)},t.prototype.releaseTile=function(e){this.tiles.delete(e.key.id),this.disposeTile(e)},t.prototype.isUpdating=function(){var e=!0;return this.tiles.forEach(function(t){e=e&&t.isReady}),!e},t.prototype.invalidateLabels=function(){},t.prototype.requestUpdate=function(){this.layerView.requestUpdate()},n([o.property()],t.prototype,"layer",void 0),n([o.property()],t.prototype,"layerView",void 0),n([o.property()],t.prototype,"tileInfoView",void 0),n([o.property()],t.prototype,"updating",null),n([o.subclass("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],t)}(o.declared(i,a));t.default=l}.apply(null,n))||(e.exports=i)},2463:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(6),r(15),r(11),r(8),r(0),r(1650),r(1462),r(1729),r(2464)],void 0===(i=function(e,t,r,n,i,a,o,l,s,u,p,c,d){Object.defineProperty(t,"__esModule",{value:!0});var f=o.getLogger("esri.2d.layers.features.tileRenderers.HeatmapTileRenderer"),h=function(e){function t(t){var r=e.call(this,t)||this;return r.container=new p.BitmapContainer,r.featuresView={attributeView:{initialize:function(){},requestUpdate:function(){}}},r}return r(t,e),Object.defineProperty(t.prototype,"gradient",{get:function(){return u.generateGradient(this.renderer.toJSON())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){var e=this.layer.renderer.type;return"heatmap"!==this.layer.renderer.type?(f.error(new a("mapview-bad-type","Found invalid type "+e+" for renderer")),null):this.layer.renderer},enumerable:!0,configurable:!0}),t.prototype.createTile=function(e){var t=p.BitmapTile.pool.acquire();return t.key.set(e),this.tileInfoView.getTileCoords(t,e),t.resolution=this.tileInfoView.getTileResolution(e),t},t.prototype.onConfigUpdate=function(){var e=this.renderer,t=e.minPixelIntensity,r=e.maxPixelIntensity,n=this.gradient;this.tiles.forEach(function(e){var i=e.source;i&&(i.minPixelIntensity=t,i.maxPixelIntensity=r,i.gradient=n,e.invalidateTexture())})},t.prototype.clear=function(){this.tiles.forEach(function(e){var t=e.source;t&&(t.intensities=null)})},t.prototype.hitTest=function(e,t){return l.resolve([])},t.prototype.highlight=function(e){return{remove:function(){},pause:function(){},resume:function(){}}},t.prototype.install=function(e){e.addChild(this.container)},t.prototype.uninstall=function(e){this.container.removeAllChildren(),e.removeChild(this.container)},t.prototype.disposeTile=function(e){this.container.removeChild(e),p.BitmapTile.pool.release(e)},t.prototype.supportsRenderer=function(e){return e&&"heatmap"===e.type},t.prototype.onTileData=function(e){var t=this.tiles.get(e.tileKey);if(t){var r=e.intensityInfo,n=this.renderer,i=n.minPixelIntensity,a=n.maxPixelIntensity,o=t.source||new d.HeatmapSource;o.intensities=r&&r.matrix||null,o.minPixelIntensity=i,o.maxPixelIntensity=a,o.gradient=this.gradient,t.source=o,this.container.addChild(t),this.requestUpdate()}},t.prototype.onTileError=function(e){console.error(e)},n([s.property({readOnly:!0,dependsOn:["layer.renderer"]})],t.prototype,"gradient",null),n([s.subclass("esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer")],t)}(s.declared(i,c.default));t.default=h}.apply(null,n))||(e.exports=i)},2464:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1650)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.gradient=null,this.height=512,this.width=512}return e.prototype.render=function(e){r.drawHeatmap(e,512,this.intensities,this.gradient,this.minPixelIntensity,this.maxPixelIntensity)},e}();t.HeatmapSource=n}.apply(null,n))||(e.exports=i)}}]);